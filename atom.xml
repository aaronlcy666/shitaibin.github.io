<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Goè¯­è¨€å……ç”µç«™</title>
  
  <subtitle>å¤§å½¬ less is better</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://lessisbetter.site/"/>
  <updated>2020-08-30T03:12:31.027Z</updated>
  <id>http://lessisbetter.site/</id>
  
  <author>
    <name>å¤§å½¬</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Dockerå®¹å™¨åŸºç¡€ï¼šCgroup - memoryå­ç³»ç»Ÿ</title>
    <link href="http://lessisbetter.site/2020/08/30/cgroup-2-memory/"/>
    <id>http://lessisbetter.site/2020/08/30/cgroup-2-memory/</id>
    <published>2020-08-30T02:45:08.000Z</published>
    <updated>2020-08-30T03:12:31.027Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
      <category term="Docker" scheme="http://lessisbetter.site/tags/Docker/"/>
    
      <category term="Kubernetes" scheme="http://lessisbetter.site/tags/Kubernetes/"/>
    
      <category term="Cgroup" scheme="http://lessisbetter.site/tags/Cgroup/"/>
    
  </entry>
  
  <entry>
    <title>Dockerå®¹å™¨åŸºç¡€ï¼šCgroup - èµ„æºæ§åˆ¶ç®€ä»‹</title>
    <link href="http://lessisbetter.site/2020/08/27/cgroup-1/"/>
    <id>http://lessisbetter.site/2020/08/27/cgroup-1/</id>
    <published>2020-08-27T13:43:52.000Z</published>
    <updated>2020-08-30T02:44:39.991Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯Cgroup"><a href="#ä»€ä¹ˆæ˜¯Cgroup" class="headerlink" title="ä»€ä¹ˆæ˜¯Cgroup"></a>ä»€ä¹ˆæ˜¯Cgroup</h2><p>Cgroup æ˜¯ Control Group çš„ç¼©å†™ï¼Œæä¾›å¯¹ä¸€ç»„è¿›ç¨‹ï¼ŒåŠæœªæ¥å­è¿›ç¨‹çš„èµ„æº<strong>é™åˆ¶ã€æ§åˆ¶ã€ç»Ÿè®¡</strong>èƒ½åŠ›ï¼ŒåŒ…æ‹¬CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œã€‚</p><ul><li>é™åˆ¶ï¼šé™åˆ¶çš„èµ„æºæœ€å¤§ä½¿ç”¨é‡é˜ˆå€¼ã€‚æ¯”å¦‚ä¸èƒ½è¶…è¿‡128MBå†…å­˜ï¼ŒCPUä½¿ç”¨ç‡ä¸å¾—è¶…è¿‡50%ï¼Œæˆ–è€…åªèƒ½æ˜¯å¦CPUçš„æŸå“ªå‡ ä¸ªæ ¸ã€‚</li><li>æ§åˆ¶ï¼šè¶…è¿‡èµ„æºä½¿ç”¨æœ€å¤§é˜ˆå€¼æ—¶ï¼Œè¿›ç¨‹ä¼šè¢«æ§åˆ¶ï¼Œä¸ä»»ç”±å®ƒå‘å±•ã€‚æ¯”å¦‚cgroupå†…æ‰€æœ‰tasksçš„å†…å­˜ä½¿ç”¨é‡è¶…è¿‡é˜ˆå€¼çš„ç»“æœå°±æ˜¯è¢«KILLï¼ŒCPUä½¿ç”¨ç‡ä¸å¾—è¶…è¿‡è®¾å®šå€¼ã€‚</li><li>ç»Ÿè®¡ï¼šç»Ÿè®¡èµ„æºçš„ä½¿ç”¨æƒ…å†µç­‰æŒ‡æ ‡ã€‚æ¯”å¦‚cgroupå†…tasksçš„å†…å­˜ä½¿ç”¨é‡ï¼Œå ç”¨CPUçš„æ—¶é—´ã€‚</li></ul><p>Cgroup åŒ…å«3ä¸ªç»„ä»¶ï¼š</p><ul><li>cgroup ï¼šä¸€ç»„è¿›ç¨‹ï¼Œå¯ä»¥åŠ ä¸Šsubsystem</li><li>subsystem ï¼šä¸€ç»„èµ„æºæ§åˆ¶æ¨¡å—ï¼ŒCPUã€å†…å­˜â€¦</li><li>hierarchy ï¼š æŠŠä¸€ç»„cgroupä¸²æˆæ ‘çŠ¶ç»“æ„ï¼Œè¿™æ ·å°±èƒ½å®ç°cgroupçš„ç»§æ‰¿ã€‚ä¸ºä»€ä¹ˆè¦ç»§æ‰¿å‘¢ï¼Ÿå°±å¦‚åŒdockeré•œåƒçš„ç»§æ‰¿ï¼Œç«™åœ¨å‰äººçš„åŸºç¡€ä¹‹ä¸Šï¼Œå…å»é‡å¤çš„é…ç½®</li></ul><h2 id="ä¸ºä»€ä¹ˆéœ€è¦Cgroup"><a href="#ä¸ºä»€ä¹ˆéœ€è¦Cgroup" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦Cgroup"></a>ä¸ºä»€ä¹ˆéœ€è¦Cgroup</h2><p>ä¸ºä»€ä¹ˆéœ€è¦Cgroupçš„é—®é¢˜ç­‰ä»·äºï¼šä¸ºä»€ä¹ˆéœ€è¦é™åˆ¶ä¸€ç»„è¿›ç¨‹çš„èµ„æºï¼Ÿ</p><p>æœ‰å¤šç§åŸå› ï¼Œæ¯”å¦‚ï¼š</p><ol><li>Linuxæ˜¯ä¸€ä¸ªå¯ä»¥å¤šç”¨æˆ·ç™»å½•çš„ç³»ç»Ÿï¼Œå¦‚ä½•é™åˆ¶ä¸åŒçš„ç”¨æˆ·ä½¿ç”¨ä¸åŒé‡çš„ç³»ç»Ÿèµ„æºå‘¢ï¼Ÿ</li><li>æŸä¸ªç³»ç»Ÿæœ‰64æ ¸ï¼Œç”±äºå±€éƒ¨æ€§åŸç†ï¼Œå¦‚æœä¸€ç»„è¿›ç¨‹åœ¨64ä¸ªæ ¸ä¸Šè°ƒåº¦ï¼Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œä½†æŠŠè¿™äº›è¿›ç¨‹åªå…è®¸åœ¨æŸå‡ ä¸ªæ ¸ä¸Šè°ƒåº¦ï¼Œå°±æœ‰è¾ƒå¥½çš„å±€éƒ¨æ€§ï¼Œæé«˜æ•ˆç‡ã€‚è¿™ç±»ä¼¼ä¸åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒæŸä¸ªæœ‰çŠ¶æ€çš„è¯·æ±‚ï¼Œæœ€å¥½èƒ½åˆ†é…åˆ°ä¸Šä¸€æ¬¡å¤„ç†è¯¥è¯·æ±‚çš„æœºå™¨ä¸Šä¸€æ ·çš„é“ç†ã€‚</li></ol><p>cgroupçš„æ–‡æ¡£ä¸­è¿˜æåˆ°ä¸€ä¸ªæ€è·¯ï¼šå®ç°èµ„æºé™åˆ¶çš„æŠ€æœ¯æœ‰å¤šç§ï¼Œä¸ºä»€ä¹ˆä½¿ç”¨cgroupï¼Ÿ</p><p>cgroupæ˜¯å†…æ ¸å®ç°çš„ï¼Œå®ƒæ›´è½»é‡ã€æ›´é«˜æ•ˆã€å¯¹å†…æ ¸çš„çƒ­ç‚¹è·¯å¾„å½±å“æœ€å°ã€‚</p><h2 id="ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup-subsystem"><a href="#ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup-subsystem" class="headerlink" title="ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup subsystem"></a>ä½ çš„Linuxæ”¯æŒå“ªäº›Cgroup subsystem</h2><p>æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ”¯æŒçš„subsystemï¼Œå…±12ä¸ªå­ç³»ç»Ÿã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ cat &#x2F;proc&#x2F;cgroups</span><br><span class="line">#subsys_namehierarchynum_cgroupsenabled</span><br><span class="line">cpuset841</span><br><span class="line">cpu2741</span><br><span class="line">cpuacct2741</span><br><span class="line">memory11741</span><br><span class="line">devices6691</span><br><span class="line">freezer1041</span><br><span class="line">net_cls441</span><br><span class="line">blkio9691</span><br><span class="line">perf_event541</span><br><span class="line">hugetlb741</span><br><span class="line">pids3691</span><br><span class="line">net_prio441</span><br></pre></td></tr></table></figure><p>ä»å·¦åˆ°å³å­—æ®µçš„å«ä¹‰åˆ†åˆ«æ˜¯ï¼š</p><ol><li>subsys_name: subsystemçš„åå­—</li><li>hierarchy: subsystemæ‰€å…³è”åˆ°çš„cgroupæ ‘çš„IDï¼Œå¦‚æœå¤šä¸ªsubsystemå…³è”åˆ°åŒä¸€é¢—cgroupæ ‘ï¼Œé‚£ä¹ˆä»–ä»¬çš„è¿™ä¸ªå­—æ®µå°†ä¸€æ ·ï¼Œæ¯”å¦‚è¿™é‡Œçš„cpuå’Œcpuacctå°±ä¸€æ ·ï¼Œè¡¨ç¤ºä»–ä»¬ç»‘å®šåˆ°äº†åŒä¸€é¢—æ ‘ã€‚å¦‚æœå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼Œè¿™ä¸ªå­—æ®µå°†ä¸º0ï¼š<ul><li>å½“å‰subsystemæ²¡æœ‰å’Œä»»ä½•cgroupæ ‘ç»‘å®š</li><li>å½“å‰subsystemå·²ç»å’Œcgroup v2çš„æ ‘ç»‘å®š</li><li>å½“å‰subsystemæ²¡æœ‰è¢«å†…æ ¸å¼€å¯</li></ul></li><li>num_cgroups: subsystemæ‰€å…³è”çš„cgroupæ ‘ä¸­è¿›ç¨‹ç»„çš„ä¸ªæ•°ï¼Œä¹Ÿå³æ ‘ä¸ŠèŠ‚ç‚¹çš„ä¸ªæ•°</li><li>enabled: 1è¡¨ç¤ºå¼€å¯ï¼Œ0è¡¨ç¤ºæ²¡æœ‰è¢«å¼€å¯(å¯ä»¥é€šè¿‡è®¾ç½®å†…æ ¸çš„å¯åŠ¨å‚æ•°â€œcgroup_disableâ€æ¥æ§åˆ¶subsystemçš„å¼€å¯).</li></ol><p><a href="https://www.kernel.org/doc/Documentation/cgroup-v1/" target="_blank" rel="noopener">Cgroupçš„å†…æ ¸æ–‡æ¡£</a>å¯¹å„ cgroup å’Œ subsystem æœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œä»¥ä¸‹æ˜¯æ¯ä¸ª subsystem åŠŸèƒ½ç®€è®°ï¼š</p><ol><li>cpu ï¼šç”¨æ¥<strong>é™åˆ¶</strong>cgroupçš„CPUä½¿ç”¨ç‡</li><li>cpuacct ï¼šç”¨æ¥<strong>ç»Ÿè®¡</strong>cgroupçš„CPUçš„ä½¿ç”¨ç‡</li><li>cpuset ï¼š ç”¨æ¥ç»‘å®šcgroupåˆ°æŒ‡å®šCPUå“ªä¸ªæ ¸ä¸Šå’ŒNUMAèŠ‚ç‚¹</li><li>memory ï¼šé™åˆ¶å’Œç»Ÿè®¡cgroupçš„å†…å­˜çš„ä½¿ç”¨ç‡ï¼ŒåŒ…æ‹¬process memory, kernel memory, å’Œswap</li><li>devices ï¼š é™åˆ¶cgroupåˆ›å»º(mknod)å’Œè®¿é—®è®¾å¤‡çš„æƒé™</li><li>freezer ï¼š suspendå’Œrestoreä¸€ä¸ªcgroupä¸­çš„æ‰€æœ‰è¿›ç¨‹</li><li>net_cls ï¼š å°†ä¸€ä¸ªcgroupä¸­è¿›ç¨‹åˆ›å»ºçš„æ‰€æœ‰ç½‘ç»œåŒ…åŠ ä¸Šä¸€ä¸ªclassidæ ‡è®°ï¼Œç”¨äºtcå’Œiptablesã€‚ åªå¯¹å‘å‡ºå»çš„ç½‘ç»œåŒ…ç”Ÿæ•ˆï¼Œå¯¹æ”¶åˆ°çš„ç½‘ç»œåŒ…ä¸èµ·ä½œç”¨</li><li>blkio ï¼š é™åˆ¶cgroupè®¿é—®å—è®¾å¤‡çš„IOé€Ÿåº¦</li><li>perf_event ï¼š å¯¹cgroupè¿›è¡Œæ€§èƒ½ç›‘æ§</li><li>net_prio ï¼š é’ˆå¯¹æ¯ä¸ªç½‘ç»œæ¥å£è®¾ç½®cgroupçš„è®¿é—®ä¼˜å…ˆçº§</li><li>hugetlb ï¼š é™åˆ¶cgroupçš„huge pagesçš„ä½¿ç”¨é‡</li><li>pids ï¼šé™åˆ¶ä¸€ä¸ªcgroupåŠå…¶å­å­™cgroupä¸­çš„æ€»è¿›ç¨‹æ•°</li></ol><p>è¿™äº›å­ç³»ç»Ÿçš„æ’åˆ—é¡ºåºï¼Œå°±æ˜¯å¼•å…¥Linuxå†…æ ¸é¡ºåºï¼Œæœ€æ—©çš„æ˜¯cpu subsystem ï¼Œå¼•å…¥è‡ªLinux 2.6.24ï¼Œæœ€æ™šçš„æ˜¯pid subsystem ï¼Œå¼•å…¥è‡ª Linux 4.3ã€‚</p><h2 id="æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½"><a href="#æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½" class="headerlink" title="æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½"></a>æŸ¥çœ‹å­ç³»ç»Ÿå’Œcgroupçš„æŒ‚è½½</h2><p>cgroupæ˜¯é€šè¿‡æ–‡ä»¶ç³»ç»Ÿå®ç°çš„ï¼Œæ¯ä¸ªç›®å½•éƒ½æ˜¯ä¸€ä¸ªcgroupèŠ‚ç‚¹ï¼Œç›®å½•ä¸­çš„å­ç›®å½•éƒ½æ˜¯å­cgroupèŠ‚ç‚¹ï¼Œè¿™æ ·å°±å½¢æˆäº† cgroupçš„ hierarchy ç‰¹æ€§ã€‚</p><p>cgroupä¼šæŒ‚è½½åˆ° <code>/sys/fs/cgroup/</code>ç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹çš„ç›®å½•åŸºæœ¬éƒ½æ˜¯subsystemï¼Œ<code>systemd</code>ç›®å½•é™¤å¤–ï¼ˆå®ƒæ˜¯ systemd è‡ªå»ºåœ¨cgroupä¸‹çš„ç›®å½•ï¼Œä½†ä¸æ˜¯å­ç³»ç»Ÿï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ ll</span><br><span class="line">total 0</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 blkio</span><br><span class="line">lrwxrwxrwx 1 root root 11 Aug 30 09:30 cpu -&gt; cpu,cpuacct</span><br><span class="line">lrwxrwxrwx 1 root root 11 Aug 30 09:30 cpuacct -&gt; cpu,cpuacct</span><br><span class="line">dr-xr-xr-x 7 root root  0 Aug 30 09:30 cpu,cpuacct</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 cpuset</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 devices</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 freezer</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 hugetlb</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 memory</span><br><span class="line">lrwxrwxrwx 1 root root 16 Aug 30 09:30 net_cls -&gt; net_cls,net_prio</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 net_cls,net_prio</span><br><span class="line">lrwxrwxrwx 1 root root 16 Aug 30 09:30 net_prio -&gt; net_cls,net_prio</span><br><span class="line">dr-xr-xr-x 3 root root  0 Aug 30 09:30 perf_event</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 pids</span><br><span class="line">dr-xr-xr-x 6 root root  0 Aug 30 09:30 systemd</span><br></pre></td></tr></table></figure><p>å‘ç°cpuã€cpuacctéƒ½æŒ‡å‘äº† <code>cpu,cpuacct</code> ç›®å½•ï¼ŒæŠŠå®ƒä»¬åˆæˆäº†1ä¸ªcgroupèŠ‚ç‚¹ã€‚å¦å¤– net_cls å’Œ net_prio ä¹Ÿéƒ½åˆåˆ°äº† <code>net_cls,net_prio</code> èŠ‚ç‚¹ï¼Œä¹Ÿå°±å½¢æˆäº†ä¸‹é¢è¿™å¹…å›¾çš„æ ·å­ï¼Œå¹¶æŠŠèµ„æºæ§åˆ¶åˆ†æˆäº†5ä¸ªç±»åˆ«ï¼šCPUã€å†…å­˜ã€ç½‘ç»œã€è¿›ç¨‹æ§åˆ¶ã€è®¾å¤‡ï¼Œå¦å¤–çš„<code>perf_event</code>æ˜¯cgroupå¯¹è‡ªèº«çš„ç›‘æ§ï¼Œä¸å½’äºèµ„æºæ§åˆ¶ã€‚</p><p><img src="http://img.lessisbetter.site/2020-08-30-cgroup-subsystem.png" alt=""></p><p>å­ç³»ç»ŸæŒ‚è½½åˆ°cgroupçš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ˜¯é€šè¿‡mountå‘½ä»¤å®ç°çš„ï¼Œç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½subsystemåˆ°cgroupï¼ŒæŸ¥çœ‹å·²ç»æŒ‚è½½çš„Cgroupï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[~]$ mount -t cgroup</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent&#x3D;&#x2F;lib&#x2F;systemd&#x2F;systemd-cgroups-agent,name&#x3D;systemd)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)</span><br><span class="line">cgroup on &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æŸä¸ªè¿›ç¨‹æ‰€å±çš„cgroupï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ # $$ä»£è¡¨å½“å‰è¿›ç¨‹</span><br><span class="line">[&#x2F;sys&#x2F;fs&#x2F;cgroup]$ cat &#x2F;proc&#x2F;$$&#x2F;cgroup</span><br><span class="line">11:memory:&#x2F;user.slice&#x2F;user-1000.slice&#x2F;session-269.scope</span><br><span class="line">10:freezer:&#x2F;</span><br><span class="line">9:blkio:&#x2F;user.slice</span><br><span class="line">8:cpuset:&#x2F;</span><br><span class="line">7:hugetlb:&#x2F;</span><br><span class="line">6:devices:&#x2F;user.slice</span><br><span class="line">5:perf_event:&#x2F;</span><br><span class="line">4:net_prio,net_cls:&#x2F;</span><br><span class="line">3:pids:&#x2F;user.slice</span><br><span class="line">2:cpuacct,cpu:&#x2F;user.slice&#x2F;user-1000.slice&#x2F;session-269.scope</span><br><span class="line">1:name&#x3D;systemd:&#x2F;user.slice&#x2F;user-1000.slice&#x2F;session-269.scope</span><br></pre></td></tr></table></figure><p>æ¯ä¸€è¡Œä»å·¦åˆ°å³ï¼Œç”¨<code>:</code>åˆ†å‰²ä¾æ¬¡æ˜¯ï¼š</p><ul><li><code>11</code>ï¼š cgroupç»§æ‰¿æ ‘çš„èŠ‚ç‚¹çš„ID</li><li><code>memory</code>: å½“å‰èŠ‚ç‚¹ä¸ŠæŒ‚è½½çš„å­ç³»ç»Ÿ</li><li><code>/user.slice/user-1000.slice/session-269.scope</code>: cgroupèŠ‚ç‚¹ç›¸å¯¹äºcgroupæ ¹ç›®å½•ä¸‹å­ç³»ç»Ÿçš„ç›¸å¯¹è·¯å¾„ï¼Œè½¬æ¢æˆç»å¯¹è·¯å¾„å°±æ˜¯ï¼š<code>/sys/fs/cgroup/memory/user.slice/user-1000.slice/session-269.scope</code></li></ul><h2 id="å†èŠcgroup-hierarchy"><a href="#å†èŠcgroup-hierarchy" class="headerlink" title="å†èŠcgroup hierarchy"></a>å†èŠcgroup hierarchy</h2><p>åœ¨ cpu,cpuacct å­ç³»ç»Ÿä¸‹åˆ›å»ºä¸€ä¸ªæµ‹è¯•cgroupèŠ‚ç‚¹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[/sys/fs/cgroup/cpu,cpuacct]$ sudo mkdir dabin_test_cpu_cgroup</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct]$ <span class="built_in">cd</span> dabin_test_cpu_cgroup</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ ls</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ ls cgroup.*</span><br><span class="line">cgroup.clone_children  cgroup.event_control  cgroup.procs</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat cgroup.clone_children</span><br><span class="line">0</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat cgroup.procs</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ ls notify_on_release tasks</span><br><span class="line">notify_on_release  tasks</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat tasks</span><br><span class="line">[/sys/fs/cgroup/cpu,cpuacct/dabin_test_cpu_cgroup]$ cat notify_on_release</span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>cgroup hierarchy (ç»§æ‰¿æ ‘)ç»“æ„ï¼Œæ¯ä¸ªcgroupèŠ‚ç‚¹éƒ½åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼š</p><ul><li>cgroup.clone_children : è¢«cpusetæ§åˆ¶å™¨ä½¿ç”¨ï¼Œå€¼ä¸º1æ—¶å­cgroupåˆå§‹åŒ–æ—¶æ‹·è´çˆ¶cgroupçš„é…ç½®</li><li>cgroup.procs : cgroupä¸­çš„çº¿ç¨‹ç»„id</li><li>tasks : å½“å‰cgroupåŒ…å«çš„è¿›ç¨‹åˆ—è¡¨</li><li>notify_on_release : å€¼ä¸º0æˆ–1ï¼Œ1ä»£è¡¨å½“cgroupä¸­çš„æœ€å1ä¸ªtaské€€å‡ºï¼Œå¹¶ä¸”å­cgroupç§»é™¤æ—¶ï¼Œå†…æ ¸ä¼šåœ¨ç»§æ‰¿æ ‘æ ¹ç›®å½•è¿è¡Œ<code>release_agent</code>æ–‡ä»¶</li></ul><p>å‚è€ƒèµ„æ–™ï¼š</p><ol><li><a href="https://kernel.googlesource.com/pub/scm/linux/kernel/git/glommer/memcg/+/cpu_stat/Documentation/cgroups" target="_blank" rel="noopener">Linux Kernel Cgroupçš„æ–‡æ¡£</a></li><li><a href="https://union-click.jd.com/jdc?e=&amp;p=AyIGZRtSFwsWB1EcXhUyFQ5WEloVCxMBURxrUV1KWQorAlBHU0VeBUVNR0ZbSkdETlcNVQtHRVNSUVNLXANBRA1XB14DS10cQQVYD21XHgBcGFIUAhsGUx9cJQEbBTJbEmFdcHkRSANGBhBDCnkmEVQeC2UaaxUDEwVWEl8RBhM3ZRtcJUN8B1QaUxMCFAFlGmsVBhoOUx9fFwESB1IfaxICGzeDtdnBl4nT2YZrJTIRN2UrWyUBIkU7HQxBABEGBhILHVdGAgcaXB0DQARWHQ4QVhFVVhkLEVciBVQaXxw%3D" target="_blank" rel="noopener">é˜¿é‡ŒåŒå­¦çš„ä¹¦ã€Šè‡ªå·±åŠ¨æ‰‹å†™Dockerã€‹</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯Cgroup&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯Cgroup&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯Cgroup&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯Cgroup&lt;/h2&gt;&lt;p&gt;Cgroup æ˜¯ Control Group çš„ç¼©å†™ï¼Œæä¾›å¯¹ä¸€ç»„è¿›ç¨‹ï¼ŒåŠæœªæ¥å­è¿›ç¨‹çš„
      
    
    </summary>
    
    
    
      <category term="Docker" scheme="http://lessisbetter.site/tags/Docker/"/>
    
      <category term="Kubernetes" scheme="http://lessisbetter.site/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>ç©è½¬minikube</title>
    <link href="http://lessisbetter.site/2020/08/27/play-minikube/"/>
    <id>http://lessisbetter.site/2020/08/27/play-minikube/</id>
    <published>2020-08-27T13:30:41.000Z</published>
    <updated>2020-08-27T13:51:40.441Z</updated>
    
    <content type="html"><![CDATA[<p>minikubeå¾ˆå¥½ï¼Œä½†æŸäº›åŸå› é€ æˆå›½å†…ç”¨èµ·æ¥æ¯”è¾ƒæ…¢ï¼Œè¦å„ç§æŒ‚ä»£ç†ã€é•œåƒåŠ é€Ÿã€‚</p><h2 id="minikubeåŸç†"><a href="#minikubeåŸç†" class="headerlink" title="minikubeåŸç†"></a>minikubeåŸç†</h2><p><img src="http://img.lessisbetter.site/2020-08-minikube.jpeg" alt=""></p><h2 id="å®‰è£…è½¯ä»¶"><a href="#å®‰è£…è½¯ä»¶" class="headerlink" title="å®‰è£…è½¯ä»¶"></a>å®‰è£…è½¯ä»¶</h2><ol><li><p>å®‰è£…minikubeï¼Œ1åˆ†é’Ÿï¼Œå¦‚æœæä¾›çš„å‘½ä»¤è¡Œä¸‹è½½ä¸ä¸‹æ¥ï¼Œå°±æµè§ˆå™¨ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾åˆ°å¢åŠ å¯æ‰§è¡Œï¼Œç„¶åæ”¾åˆ°binç›®å½•å³å¯ï¼š<br><a href="https://yq.aliyun.com/articles/691500" target="_blank" rel="noopener">https://yq.aliyun.com/articles/691500</a></p></li><li><p>centoså®‰è£…virtualboxï¼Œ2åˆ†é’Ÿå®‰è£…å®Œæˆ:<br><a href="https://wiki.centos.org/zh/HowTos/Virtualization/VirtualBox" target="_blank" rel="noopener">https://wiki.centos.org/zh/HowTos/Virtualization/VirtualBox</a></p></li><li><p>å®‰è£…kubectlï¼š<br><a href="https://blog.csdn.net/yuanjunlai141/article/details/79469071" target="_blank" rel="noopener">https://blog.csdn.net/yuanjunlai141/article/details/79469071</a></p></li></ol><h2 id="é¦–æ¬¡å¯åŠ¨"><a href="#é¦–æ¬¡å¯åŠ¨" class="headerlink" title="é¦–æ¬¡å¯åŠ¨"></a>é¦–æ¬¡å¯åŠ¨</h2><p>å¯åŠ¨å‘½ä»¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">minikube start --image-mirror-country cn \</span><br><span class="line">    --iso-url&#x3D;https:&#x2F;&#x2F;kubernetes.oss-cn-hangzhou.aliyuncs.com&#x2F;minikube&#x2F;iso&#x2F;minikube-v1.7.3.iso \</span><br><span class="line">    --docker-env http_proxy&#x3D;http:&#x2F;&#x2F;192.168.0.104:1087 \</span><br><span class="line">    --docker-env https_proxy&#x3D;http:&#x2F;&#x2F;192.168.0.104:1087 \</span><br><span class="line">    --docker-env no_proxy&#x3D;localhost,127.0.0.1,10.96.0.0&#x2F;12,192.168.99.0&#x2F;24,192.168.39.0&#x2F;24 \</span><br><span class="line">    --registry-mirror&#x3D;&quot;https:&#x2F;&#x2F;a90tkz28.mirror.aliyuncs.com&quot; \</span><br><span class="line">    --image-repository&#x3D;&quot;registry.cn-hangzhou.aliyuncs.com&#x2F;google_containers&quot; \</span><br><span class="line">    --insecure-registry&#x3D;192.168.9.8 \</span><br><span class="line">    --kubernetes-version&#x3D;v1.18.3</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨minikubeå¯ä»¥æŸ¥çœ‹å¸®åŠ©flagå¸®åŠ©ä¿¡æ¯ï¼š</p><ul><li><code>--image-mirror-country</code>: éœ€è¦ä½¿ç”¨çš„é•œåƒé•œåƒçš„å›½å®¶/åœ°åŒºä»£ç ã€‚ç•™ç©ºä»¥ä½¿ç”¨å…¨çƒä»£ç ã€‚å¯¹äºä¸­å›½å¤§é™†ç”¨æˆ·ï¼Œè¯·å°†å…¶è®¾ç½®ä¸º<br>cn</li><li><code>--docker-env</code>: æ˜¯é€šè¿‡ç¯å¢ƒå˜é‡å‘dockeræŒ‚httpä»£ç†ï¼Œå¦åˆ™å›½å†…å¯èƒ½å‡ºç°æ‹‰ä¸åˆ°é•œåƒçš„é—®é¢˜ã€‚æŒ‚ä»£ç†è¿˜éœ€è¦ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œåœ¨ä¸»æœºä¸Šä½¿ç”¨SSå¼€å¯ä»£ç†ã€‚æŒ‚äº†ä»£ç†å¯èƒ½ä¹Ÿå¾ˆéš¾æ‹‰åˆ°ï¼Œä½†ä¸æŒ‚ä»£ç†ï¼Œå‡ ä¹æ‹‰ä¸ä¸‹æ¥é•œåƒã€‚</li><li><code>--registry-mirror</code>: ä¼ é€’ç»™ Docker å®ˆæŠ¤è¿›ç¨‹çš„æ³¨å†Œè¡¨é•œåƒã€‚æ•ˆæœæœ€å¥½çš„é•œåƒåŠ é€Ÿå™¨ï¼š<code>--registry-mirror=&quot;https://a90tkz28.mirror.aliyuncs.com&quot;</code></li><li><code>--image-repository</code> : å¦‚æœä¸èƒ½ä»gcr.ioæ‹‰é•œåƒï¼Œé…ç½®minikubeä¸­dockeræ‹‰é•œåƒçš„åœ°æ–¹</li><li><code>--kubernetes-version</code>ï¼š æŒ‡å®šè¦éƒ¨ç½²çš„k8sç‰ˆæœ¬</li></ul><p>minikubeå†…æ‹‰ä¸åˆ°é•œåƒçš„æŠ¥é”™:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl describe pod</span><br><span class="line">  Type     Reason     Age                    From               Message</span><br><span class="line">  ----     ------     ----                   ----               -------</span><br><span class="line">  Warning  Failed     2m59s (x4 over 4m36s)  kubelet, minikube  Failed to pull image &quot;kubeguide&#x2F;redis-master&quot;: rpc error: code &#x3D; Unknown desc &#x3D; Error response from daemon: Get https:&#x2F;&#x2F;registry-1.docker.io&#x2F;v2&#x2F;: proxyconnect tcp: dial tcp 192.168.0.104:1087: connect: connection refused</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æ—¥å¿—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ minikube start --image-mirror-country cn \</span><br><span class="line">    --iso-url&#x3D;https:&#x2F;&#x2F;kubernetes.oss-cn-hangzhou.aliyuncs.com&#x2F;minikube&#x2F;iso&#x2F;minikube-v1.7.3.iso \</span><br><span class="line">    --docker-env http_proxy&#x3D;http:&#x2F;&#x2F;192.168.0.104:1087 \</span><br><span class="line">    --docker-env https_proxy&#x3D;http:&#x2F;&#x2F;192.168.0.104:1087 \</span><br><span class="line">    --docker-env no_proxy&#x3D;localhost,127.0.0.1,10.96.0.0&#x2F;12,192.168.99.0&#x2F;24,192.168.39.0&#x2F;24 \</span><br><span class="line">    --registry-mirror&#x3D;&quot;https:&#x2F;&#x2F;a90tkz28.mirror.aliyuncs.com&quot; \</span><br><span class="line">    --image-repository&#x3D;&quot;registry.cn-hangzhou.aliyuncs.com&#x2F;google_containers&quot; \</span><br><span class="line">    --insecure-registry&#x3D;192.168.9.8</span><br><span class="line">ğŸ˜„  Darwin 10.15.3 ä¸Šçš„ minikube v1.12.3</span><br><span class="line">âœ¨  æ ¹æ®ç°æœ‰çš„é…ç½®æ–‡ä»¶ä½¿ç”¨ virtualbox é©±åŠ¨ç¨‹åº</span><br><span class="line">ğŸ‘  Starting control plane node minikube in cluster minikube</span><br><span class="line">ğŸƒ  Updating the running virtualbox &quot;minikube&quot; VM ...</span><br><span class="line">ğŸ³  æ­£åœ¨ Docker 19.03.6 ä¸­å‡†å¤‡ Kubernetes v1.18.3â€¦</span><br><span class="line">    â–ª env http_proxy&#x3D;http:&#x2F;&#x2F;192.168.0.104:1087</span><br><span class="line">    â–ª env https_proxy&#x3D;http:&#x2F;&#x2F;192.168.0.104:1087</span><br><span class="line">    â–ª env no_proxy&#x3D;localhost,127.0.0.1,10.96.0.0&#x2F;12,192.168.99.0&#x2F;24,192.168.39.0&#x2F;24</span><br><span class="line">    &gt; kubeadm.sha256: 65 B &#x2F; 65 B [--------------------------] 100.00% ? p&#x2F;s 0s</span><br><span class="line">    &gt; kubelet.sha256: 65 B &#x2F; 65 B [--------------------------] 100.00% ? p&#x2F;s 0s</span><br><span class="line">    &gt; kubeadm: 37.97 MiB &#x2F; 37.97 MiB [--------------] 100.00% 320.45 MiB p&#x2F;s 0s</span><br><span class="line">    &gt; kubelet: 108.04 MiB &#x2F; 108.04 MiB [---------] 100.00% 514.43 KiB p&#x2F;s 3m36s</span><br><span class="line">ğŸ”  Verifying Kubernetes components...</span><br><span class="line">ğŸŒŸ  Enabled addons: default-storageclass, storage-provisioner</span><br><span class="line">ğŸ„  å®Œæˆï¼kubectl å·²ç»é…ç½®è‡³ &quot;minikube&quot;</span><br></pre></td></tr></table></figure><p>åšå“ªäº›äº‹ï¼Ÿ</p><ol><li>åˆ›å»ºè™šæ‹Ÿæœºâ€minikubeâ€</li><li>ç”Ÿæˆkubectlä½¿ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨è¯¥é…ç½®è¿æ¥é›†ç¾¤ï¼š~/.kube/config</li><li>åœ¨è™šæ‹Ÿæœºé‡Œçš„å®¹å™¨ä¸Šå¯åŠ¨k8s</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">$ minikube ssh</span><br><span class="line">                         _             _</span><br><span class="line">            _         _ ( )           ( )</span><br><span class="line">  ___ ___  (_)  ___  (_)| |&#x2F;&#39;)  _   _ | |_      __</span><br><span class="line">&#x2F;&#39; _ &#96; _ &#96;\| |&#x2F;&#39; _ &#96;\| || , &lt;  ( ) ( )| &#39;_&#96;\  &#x2F;&#39;__&#96;\</span><br><span class="line">| ( ) ( ) || || ( ) || || |\&#96;\ | (_) || |_) )(  ___&#x2F;</span><br><span class="line">(_) (_) (_)(_)(_) (_)(_)(_) (_)&#96;\___&#x2F;&#39;(_,__&#x2F;&#39;&#96;\____)</span><br><span class="line"></span><br><span class="line">$</span><br><span class="line">$ docker info</span><br><span class="line">Client:</span><br><span class="line"> Debug Mode: false</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Containers: 14</span><br><span class="line">  Running: 14</span><br><span class="line">  Paused: 0</span><br><span class="line">  Stopped: 0</span><br><span class="line"> Images: 10</span><br><span class="line"> Server Version: 19.03.6</span><br><span class="line"> Storage Driver: overlay2</span><br><span class="line">  Backing Filesystem: extfs</span><br><span class="line">  Supports d_type: true</span><br><span class="line">  Native Overlay Diff: true</span><br><span class="line"> Logging Driver: json-file</span><br><span class="line"> Cgroup Driver: cgroupfs</span><br><span class="line"> Plugins:</span><br><span class="line">  Volume: local</span><br><span class="line">  Network: bridge host ipvlan macvlan null overlay</span><br><span class="line">  Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog</span><br><span class="line"> Swarm: inactive</span><br><span class="line"> Runtimes: runc</span><br><span class="line"> Default Runtime: runc</span><br><span class="line"> Init Binary: docker-init</span><br><span class="line"> containerd version: 35bd7a5f69c13e1563af8a93431411cd9ecf5021</span><br><span class="line"> runc version: dc9208a3303feef5b3839f4323d9beb36df0a9dd</span><br><span class="line"> init version: fec3683</span><br><span class="line"> Security Options:</span><br><span class="line">  seccomp</span><br><span class="line">   Profile: default</span><br><span class="line"> Kernel Version: 4.19.94</span><br><span class="line"> Operating System: Buildroot 2019.02.9</span><br><span class="line"> OSType: linux</span><br><span class="line"> Architecture: x86_64</span><br><span class="line"> CPUs: 2</span><br><span class="line"> Total Memory: 3.754GiB</span><br><span class="line"> Name: minikube</span><br><span class="line"> ID: DSF4:HEQB:HTUU:OXRS:ZBWC:ESX4:WEST:UFDC:WAW5:5CDV:PITM:BEXZ</span><br><span class="line"> Docker Root Dir: &#x2F;var&#x2F;lib&#x2F;docker</span><br><span class="line"> Debug Mode: false</span><br><span class="line"> HTTP Proxy: http:&#x2F;&#x2F;192.168.0.104:1087</span><br><span class="line"> HTTPS Proxy: http:&#x2F;&#x2F;192.168.0.104:1087</span><br><span class="line"> No Proxy: localhost,127.0.0.1,10.96.0.0&#x2F;12,192.168.99.0&#x2F;24,192.168.39.0&#x2F;24</span><br><span class="line"> Registry: https:&#x2F;&#x2F;index.docker.io&#x2F;v1&#x2F;</span><br><span class="line"> Labels:</span><br><span class="line">  provider&#x3D;virtualbox</span><br><span class="line"> Experimental: false</span><br><span class="line"> Insecure Registries:</span><br><span class="line">  192.168.9.8</span><br><span class="line">  10.96.0.0&#x2F;12</span><br><span class="line">  127.0.0.0&#x2F;8</span><br><span class="line"> Registry Mirrors:</span><br><span class="line">  https:&#x2F;&#x2F;a90tkz28.mirror.aliyuncs.com&#x2F;</span><br><span class="line"> Live Restore Enabled: false</span><br><span class="line"> Product License: Community Engine</span><br><span class="line"></span><br><span class="line">$ exit</span><br><span class="line">logout</span><br></pre></td></tr></table></figure><p>Registry Mirrorså¯¹åº”çš„æ˜¯é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿï¼ŒHTTP proxyä¹Ÿé…ç½®ä¸Šäº†ï¼Œå¦‚æœå¯åŠ¨åï¼Œå‘ç°æ²¡æœ‰æ”¹å˜ï¼Œéœ€è¦åˆ é™¤è¿‡å»åˆ›å»ºçš„minikubeï¼Œå…¨éƒ¨æ¸…ç†ä¸€éã€‚</p><h2 id="minikubeå¸¸ç”¨å‘½ä»¤"><a href="#minikubeå¸¸ç”¨å‘½ä»¤" class="headerlink" title="minikubeå¸¸ç”¨å‘½ä»¤"></a>minikubeå¸¸ç”¨å‘½ä»¤</h2><ul><li>é›†ç¾¤çŠ¶æ€ï¼š minikube status</li><li>æš‚åœå’Œæ¢å¤é›†ç¾¤ï¼Œä¸ç”¨çš„æ—¶å€™æŠŠå®ƒæš‚åœæ‰ï¼ŒèŠ‚çº¦ä¸»æœºçš„CPUå’Œå†…å­˜ï¼š minikube pauseï¼Œ minikube unpause</li><li>åœæ­¢é›†ç¾¤ï¼š minikube stop</li><li>åˆ é™¤é›†ç¾¤ï¼Œé‡åˆ°é—®é¢˜æ—¶ï¼Œæ¸…ç†ä¸€æ³¢æ•°æ®ï¼š minikube delete</li><li>æŸ¥çœ‹é›†ç¾¤IPï¼Œkubectlå°±æ˜¯è¿è¿™ä¸ªIPï¼š minikube ip</li><li>è¿›å…¥minikubeè™šæ‹Ÿæœºï¼Œæ•´ä¸ªk8sé›†ç¾¤è·‘åœ¨è¿™é‡Œé¢ï¼š minikube ssh</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;minikubeå¾ˆå¥½ï¼Œä½†æŸäº›åŸå› é€ æˆå›½å†…ç”¨èµ·æ¥æ¯”è¾ƒæ…¢ï¼Œè¦å„ç§æŒ‚ä»£ç†ã€é•œåƒåŠ é€Ÿã€‚&lt;/p&gt;
&lt;h2 id=&quot;minikubeåŸç†&quot;&gt;&lt;a href=&quot;#minikubeåŸç†&quot; class=&quot;headerlink&quot; title=&quot;minikubeåŸç†&quot;&gt;&lt;/a&gt;minikubeåŸ
      
    
    </summary>
    
    
    
      <category term="Docker" scheme="http://lessisbetter.site/tags/Docker/"/>
    
      <category term="Kubernetes" scheme="http://lessisbetter.site/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>VSCodeåˆ©ç”¨SFTPä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨</title>
    <link href="http://lessisbetter.site/2020/08/27/sync-code-to-server-with-sftp-in-vscode/"/>
    <id>http://lessisbetter.site/2020/08/27/sync-code-to-server-with-sftp-in-vscode/</id>
    <published>2020-08-27T12:24:00.000Z</published>
    <updated>2020-08-27T12:37:00.984Z</updated>
    
    <content type="html"><![CDATA[<p>VSCodeå·²ç»æ”¯æŒè¿œç¨‹å¼€å‘ï¼Œå¯ä»¥æŠŠä»£ç è‡ªåŠ¨ä»æœ¬åœ°å’ŒæœåŠ¡å™¨è¿›è¡ŒåŒæ­¥ã€‚</p><p>ä¸ºäº†æŸäº›å®éªŒæäº†ä¸€æ¡Ubuntu 14.04çš„æœåŠ¡å™¨ï¼Œç»“æœVSCodeè¯´è¿œç¨‹æœåŠ¡å™¨ä¸æ”¯æŒï¼Œå°±åªèƒ½å¦è°‹å®ƒè·¯äº†ï¼Œåˆ©ç”¨SFTPå®ç°æœ¬åœ°å’ŒæœåŠ¡å™¨ç«¯çš„ä»£ç åŒæ­¥ã€‚</p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li>VSCodeåº”ç”¨å¸‚åœºå®‰è£…SFTPæ’ä»¶</li><li>åœ¨é¡¹ç›®ç›®å½•ä¸‹å»ºç«‹SFTPçš„é…ç½®æ–‡ä»¶ï¼š<code>.vscode/sftp.json</code>ï¼Œå†…å®¹å¦‚ä¸‹</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"root"</span>,</span><br><span class="line">    <span class="attr">"host"</span>: <span class="string">"192.168.9.xxx"</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"sftp"</span>,</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">22</span>,</span><br><span class="line">    <span class="attr">"username"</span>: <span class="string">"centos"</span>,</span><br><span class="line">    <span class="attr">"privateKeyPath"</span>: <span class="string">"/Users/shitaibin/.ssh/id_xxx"</span>,</span><br><span class="line">    <span class="attr">"remotePath"</span>: <span class="string">"/home/centos/workspace/docker/notes"</span>,</span><br><span class="line">    <span class="attr">"uploadOnSave"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"ignore"</span>: [<span class="string">".vscode"</span>, <span class="string">".git"</span>, <span class="string">".DS_Store"</span>, <span class="string">"node_modules"</span>, <span class="string">"vendor"</span>],</span><br><span class="line">    <span class="attr">"localPath"</span>:<span class="string">"."</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç™»å½•æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨å¯†ç æˆ–è€…ç§é’¥ï¼Œä¸Šé¢æ–‡ä»¶çš„ç¤ºä¾‹ä½¿ç”¨ç§é’¥ï¼Œå¦‚æœä½¿ç”¨å¯†ç ï¼Œå¢åŠ ä¸€é¡¹<code>password</code>å³å¯ã€‚</p><p><code>uploadOnSave</code>é…ç½®é¡¹è®¾ç½®ä¸ºtrueï¼Œèƒ½å¤Ÿç¡®ä¿æ–‡ä»¶ä¿å­˜æ—¶ï¼Œè‡ªåŠ¨ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæ— éœ€æ‰‹åŠ¨ä¸Šä¼ ã€‚</p><ol start="3"><li><p>åˆæ¬¡ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><p> a. Ctrl + Shift + Pï¼Œè¾“å…¥<code>SFTP</code>ï¼Œé€‰æ‹©<code>Sync Local -&gt; Remote</code>å³å¯<br> b. VSCodeåº•éƒ¨çŠ¶æ€æ ï¼Œä¼šæ˜¾ç¤ºSFTPï¼Œå¦‚æœåœ¨åŠ¨æ€å˜åŒ–ï¼Œè¯´æ˜åœ¨ä¸Šä¼ æ–‡ä»¶</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;VSCodeå·²ç»æ”¯æŒè¿œç¨‹å¼€å‘ï¼Œå¯ä»¥æŠŠä»£ç è‡ªåŠ¨ä»æœ¬åœ°å’ŒæœåŠ¡å™¨è¿›è¡ŒåŒæ­¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æŸäº›å®éªŒæäº†ä¸€æ¡Ubuntu 14.04çš„æœåŠ¡å™¨ï¼Œç»“æœVSCodeè¯´è¿œç¨‹æœåŠ¡å™¨ä¸æ”¯æŒï¼Œå°±åªèƒ½å¦è°‹å®ƒè·¯äº†ï¼Œåˆ©ç”¨SFTPå®ç°æœ¬åœ°å’ŒæœåŠ¡å™¨ç«¯çš„ä»£ç åŒæ­¥ã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ­¥éª¤&quot;&gt;&lt;a 
      
    
    </summary>
    
    
    
      <category term="VSCode" scheme="http://lessisbetter.site/tags/VSCode/"/>
    
      <category term="SFTP" scheme="http://lessisbetter.site/tags/SFTP/"/>
    
  </entry>
  
  <entry>
    <title>os</title>
    <link href="http://lessisbetter.site/2020/08/18/os/"/>
    <id>http://lessisbetter.site/2020/08/18/os/</id>
    <published>2020-08-18T00:11:30.000Z</published>
    <updated>2020-08-18T00:11:30.041Z</updated>
    
    <content type="html"><![CDATA[<hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;hr&gt;

      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Goè¯­è¨€æ—¥æœŸå’Œæ—¶é—´æˆ³è½¬æ¢</title>
    <link href="http://lessisbetter.site/2020/07/29/go-time-date-timestamp/"/>
    <id>http://lessisbetter.site/2020/07/29/go-time-date-timestamp/</id>
    <published>2020-07-29T11:48:59.000Z</published>
    <updated>2020-07-29T11:49:32.733Z</updated>
    
    <content type="html"><![CDATA[<p>å­—ç¬¦ä¸²æ ¼å¼æ—¥æœŸã€time.Timeç±»å‹ã€æ•´å½¢æ—¶é—´æˆ³ä¸‰è€…ä¹‹é—´çš„è½¬æ¢å¦‚ä¸‹å›¾ï¼š</p><p><img src="http://img.lessisbetter.site/2020-07-go-time-date-transform.png" alt=""></p><p>æœ‰2ç‚¹è¦æ³¨æ„ï¼š</p><ol><li>å­—ç¬¦ä¸²æ—¥æœŸå’Œæ—¶é—´æˆ³ä¹‹é—´ä¸èƒ½ç›´æ¥è½¬æ¢ï¼Œéœ€è¦é€šè¿‡time.Timeå®Œæˆã€‚</li><li>æ¶‰åŠå­—ç¬¦ä¸²æ—¥æœŸçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²æ—¥æœŸæ ¼å¼ä¸€å®šè¦ä»¥Goè¯ç”Ÿçš„æ—¶é—´ä¸ºåŸºå‡†ï¼Œè€Œä¸æ˜¯éšæ„çš„æ—¶é—´ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ—¶é—´è½¬æ¢ä¸æ­£ç¡®ã€‚æ‰€ä»¥ï¼Œä»¥ä¸‹Demoä¸­çš„æ—¥æœŸæ ¼å¼æ˜¯é€šç”¨çš„ã€‚</li><li>å­—ç¬¦ä¸²æ—¥æœŸæ ¼å¼è¦ä¸çœŸå®çš„æ—¥æœŸæ ¼å¼å®Œå…¨åŒ¹é…ï¼Œå¦åˆ™ä¼šè§£ææ—¶é—´ä¸æ­£ç¡®ã€‚æ¯”å¦‚è®¾ç½®çš„æ ¼å¼ä¸º<code>2006-01-02</code>ï¼Œå®é™…æ—¥æœŸæ ¼å¼ä¸º<code>2006-1-2</code>æ—¶ä¼šè§£æé”™è¯¯ã€‚</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Date2Time</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"&gt;&gt; Date2Time"</span>)</span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">"&lt;&lt; Date2Time"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€å®šè¦ä»¥Goè¯ç”Ÿçš„æ—¶é—´ä¸ºåŸºå‡†</span></span><br><span class="line"><span class="comment">// 2006å¹´1æœˆ2å·ï¼ŒMSTæ—¶åŒºï¼Œä¸‹åˆ3:04åˆ†ä¸ºåŸºå‡†</span></span><br><span class="line"><span class="keyword">const</span> dateFormat = <span class="string">"Jan 2, 2006 at 3:04pm (MST)"</span></span><br><span class="line">t, _ := time.Parse(dateFormat, <span class="string">"May 20, 2020 at 0:00am (UTC)"</span>)</span><br><span class="line">fmt.Println(t)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> shortForm = <span class="string">"2006-Jan-02"</span></span><br><span class="line">t, _ = time.Parse(shortForm, <span class="string">"2020-May-20"</span>)</span><br><span class="line">fmt.Println(t)</span><br><span class="line"></span><br><span class="line">t, _ = time.Parse(<span class="string">"01/02/2006"</span>, <span class="string">"05/20/2020"</span>)</span><br><span class="line">fmt.Println(t)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Time2Date</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"&gt;&gt; Time2Date"</span>)</span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">"&lt;&lt; Time2Date"</span>)</span><br><span class="line"></span><br><span class="line">tm := time.Now()</span><br><span class="line">fmt.Println(tm.Format(<span class="string">"2006-01-02 03:04:05 PM"</span>))</span><br><span class="line">fmt.Println(tm.Format(<span class="string">"2006-1-2 03:04:05 PM"</span>))</span><br><span class="line">fmt.Println(tm.Format(<span class="string">"2006-Jan-02 03:04:05 PM"</span>))</span><br><span class="line">fmt.Println(tm.Format(<span class="string">"02/01/2006 03:04:05 PM"</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Timestamp2Time</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"&gt;&gt; Timestamp2Time"</span>)</span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">"&lt;&lt; Timestamp2Time"</span>)</span><br><span class="line"></span><br><span class="line">ts := <span class="keyword">int64</span>(<span class="number">1595900001</span>)</span><br><span class="line">tm := time.Unix(ts, <span class="number">0</span>)</span><br><span class="line">fmt.Println(tm)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Time2Timestamp</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"&gt;&gt; Time2Timestamp"</span>)</span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">"&lt;&lt; Time2Timestamp"</span>)</span><br><span class="line"></span><br><span class="line">tm := time.Now()</span><br><span class="line">ts := tm.Unix()</span><br><span class="line">fmt.Println(ts)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">Date2Time()</span><br><span class="line">Time2Date()</span><br><span class="line">Timestamp2Time()</span><br><span class="line">Time2Timestamp()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; Date2Time</span><br><span class="line">2020-05-20 00:00:00 +0000 UTC</span><br><span class="line">2020-05-20 00:00:00 +0000 UTC</span><br><span class="line">2020-05-20 00:00:00 +0000 UTC</span><br><span class="line">&lt;&lt; Date2Time</span><br><span class="line">&gt;&gt; Time2Date</span><br><span class="line">2020-07-28 09:35:46 AM</span><br><span class="line">2020-7-28 09:35:46 AM</span><br><span class="line">2020-Jul-28 09:35:46 AM</span><br><span class="line">28&#x2F;07&#x2F;2020 09:35:46 AM</span><br><span class="line">&lt;&lt; Time2Date</span><br><span class="line">&gt;&gt; Timestamp2Time</span><br><span class="line">2020-07-28 09:33:21 +0800 CST</span><br><span class="line">&lt;&lt; Timestamp2Time</span><br><span class="line">&gt;&gt; Time2Timestamp</span><br><span class="line">1595900146</span><br><span class="line">&lt;&lt; Time2Timestamp</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å­—ç¬¦ä¸²æ ¼å¼æ—¥æœŸã€time.Timeç±»å‹ã€æ•´å½¢æ—¶é—´æˆ³ä¸‰è€…ä¹‹é—´çš„è½¬æ¢å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.lessisbetter.site/2020-07-go-time-date-transform.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ‰2ç‚¹
      
    
    </summary>
    
    
    
      <category term="Go" scheme="http://lessisbetter.site/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>SSHå¸¸ç”¨å‘½ä»¤å’Œé…ç½®</title>
    <link href="http://lessisbetter.site/2020/07/28/about-ssh/"/>
    <id>http://lessisbetter.site/2020/07/28/about-ssh/</id>
    <published>2020-07-28T13:11:15.000Z</published>
    <updated>2020-07-28T13:12:11.547Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç”ŸæˆSSHå¯†é’¥"><a href="#ç”ŸæˆSSHå¯†é’¥" class="headerlink" title="ç”ŸæˆSSHå¯†é’¥"></a>ç”ŸæˆSSHå¯†é’¥</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -f ~/.ssh/id_rsa -C <span class="string">"temp user"</span> -N <span class="string">""</span></span><br></pre></td></tr></table></figure><p>-tï¼šæŒ‡å®šåŠ å¯†ç®—æ³•<br>-fï¼šæŒ‡å®šè·¯å¾„<br>-Cï¼šæ³¨é‡Šï¼Œå¯ä»¥å¡«å†™ç”¨æˆ·åæˆ–é‚®ç®±<br>-Nï¼šå¯†ç </p><p>æŒ‡å®šä»¥ä¸Š<code>fã€Cã€N</code>è¿™3ä¸ªå‚æ•°ï¼Œå¯ä»¥é¿å…äº¤äº’å¼é—®ç­”ï¼Œå¿«é€Ÿç”Ÿæˆå¯†é’¥ï¼Œåœ¨è„šæœ¬ä¸­ä½¿ç”¨å¾ˆæ–¹ä¾¿ã€‚</p><h2 id="SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶"><a href="#SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶" class="headerlink" title="SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶"></a>SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</h2><p><code>~/.ssh/config</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Read more about SSH config files: https:&#x2F;&#x2F;linux.die.net&#x2F;man&#x2F;5&#x2F;ssh_config</span><br><span class="line">Host ä¸ªäººVM</span><br><span class="line">    HostName 192.168.9.137</span><br><span class="line">    User centos</span><br><span class="line"></span><br><span class="line">Host é˜¿é‡Œäº‘</span><br><span class="line">    HostName 139.224.105.10</span><br><span class="line">    User root</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">Host è…¾è®¯äº‘</span><br><span class="line">    HostName 140.143.6.185</span><br><span class="line">    User root</span><br><span class="line">    Port 22</span><br><span class="line">    IdentityFile ~&#x2F;.ssh&#x2F;id_rsa_tencent</span><br></pre></td></tr></table></figure><ul><li>Hostï¼šè‡ªå®šä¹‰å‘½å</li><li>HostNameï¼šæœºå™¨IPæˆ–è€…åŸŸå</li><li>Userï¼šç™»å½•æœºå™¨çš„ç”¨æˆ·å</li><li>Portï¼šç™»å½•æœºå™¨çš„ç«¯å£ï¼Œé»˜è®¤ä¸º22ï¼Œå¯çœç•¥</li><li>IdentityFileï¼šç™»å½•æœºå™¨æ—¶ä½¿ç”¨çš„ç§é’¥ï¼Œé»˜è®¤ä¸º<code>~/.ssh/id_rsa</code>ï¼Œå¯çœç•¥ï¼›å½“æŸå°æœºå™¨ä½¿ç”¨å•ç‹¬å¯†é’¥æ—¶ï¼Œå¾ˆæœ‰ç”¨</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç”ŸæˆSSHå¯†é’¥&quot;&gt;&lt;a href=&quot;#ç”ŸæˆSSHå¯†é’¥&quot; class=&quot;headerlink&quot; title=&quot;ç”ŸæˆSSHå¯†é’¥&quot;&gt;&lt;/a&gt;ç”ŸæˆSSHå¯†é’¥&lt;/h2&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu
      
    
    </summary>
    
    
    
      <category term="Linux" scheme="http://lessisbetter.site/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•é€‰æ‹©å¼€æºåè®®</title>
    <link href="http://lessisbetter.site/2020/05/05/open-source-license/"/>
    <id>http://lessisbetter.site/2020/05/05/open-source-license/</id>
    <published>2020-05-05T06:37:26.000Z</published>
    <updated>2020-05-05T06:58:26.497Z</updated>
    
    <content type="html"><![CDATA[<p>å½“åŸºäºå¼€æºé¡¹ç›®å‘å¸ƒæ–°çš„å¼€æºé¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¯´æ˜é¡¹ç›®æ‰€ä½¿ç”¨çš„Licenseï¼ŒåŒæ ·ä¹Ÿéœ€è¦è€ƒè™‘ä½ åŸºäºå¼€æºé¡¹ç›®æ‰€åšçš„äº‹æƒ…ï¼Œæ˜¯å¦æ»¡è¶³è¯¥é¡¹ç›®çš„Licenseã€‚</p><p>ä¸‹é¢è¿™2å¹…å›¾æ‘˜è‡ª <a href="https://www.zhihu.com/question/28292322" target="_blank" rel="noopener">å¼€æºè®¸å¯è¯éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«,ä¸€èˆ¬å¼€æºé¡¹ç›®ç”¨ä»€ä¹ˆè®¸å¯è¯? - çŸ¥ä¹</a>ï¼Œè¶³ä»¥å¸®åŠ©æˆ‘ä»¬åˆ¤æ–­ï¼š</p><ol><li>è¦åšçš„äº‹æƒ…ï¼Œæ˜¯å¦æ»¡è¶³å¼€æºé¡¹ç›®çš„Licenseã€‚</li><li>å¼€æºä¸€ä¸ªé¡¹ç›®ï¼Œè¯¥å¦‚ä½•é€‰æ‹©Licenseã€‚</li></ol><p><img src="http://img.lessisbetter.site/2020-05-license-choose.jpg" alt=""><br>æ¥æºï¼š<a href="https://www.zhihu.com/question/28292322/answer/656121132" target="_blank" rel="noopener">https://www.zhihu.com/question/28292322/answer/656121132</a></p><p><img src="http://img.lessisbetter.site/2020-05-license-2.jpg" alt=""><br>æ¥æºï¼š<a href="https://www.zhihu.com/question/28292322/answer/840556759" target="_blank" rel="noopener">https://www.zhihu.com/question/28292322/answer/840556759</a><br>ä»å·¦åˆ°å³ï¼Œæ˜¯ä»å®½æ¾åˆ°ä¸¥æ ¼ã€‚</p><p>ä¸¾ä¾‹ï¼š</p><ol><li>ä»¥å¤ªåŠé‡‡Licenseç”¨çš„æ˜¯LGPLv3ï¼Œä¿®æ”¹æºç åå¦‚æœæä¾›ç»™å¤–éƒ¨ä½¿ç”¨å¿…é¡»å¼€æºï¼Œä¸è¦æ±‚æ–°å¢ä»£ç é‡‡ç”¨ç›¸åŒçš„Licenseï¼Œä¹Ÿä¸è¦æ±‚å¯¹æ–°å¢ä»£ç è¿›è¡Œæ–‡æ¡£è¯´æ˜ï¼Œåæ¥æˆ‘ä»¬é¡¹ç›®åŒæ ·é‡‡ç”¨äº†LGPLv3ã€‚</li><li>Fabricé‡‡ç”¨Apache 2.0ï¼ŒåŸºäºFabricé¡¹ç›®åŸæœ‰ä»£ç éƒ½å¿…é¡»æ”¾ç½®FabricåŸæœ‰ç‰ˆæƒå£°æ˜ï¼Œä½†å¯ä»¥é€‰æ‹©ä¸å¼€æºã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å½“åŸºäºå¼€æºé¡¹ç›®å‘å¸ƒæ–°çš„å¼€æºé¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¯´æ˜é¡¹ç›®æ‰€ä½¿ç”¨çš„Licenseï¼ŒåŒæ ·ä¹Ÿéœ€è¦è€ƒè™‘ä½ åŸºäºå¼€æºé¡¹ç›®æ‰€åšçš„äº‹æƒ…ï¼Œæ˜¯å¦æ»¡è¶³è¯¥é¡¹ç›®çš„Licenseã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™2å¹…å›¾æ‘˜è‡ª &lt;a href=&quot;https://www.zhihu.com/question/2829232
      
    
    </summary>
    
    
    
      <category term="å¼€æº" scheme="http://lessisbetter.site/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>Fabric 1.4æºç è§£è¯» 10ï¼šå¯æ‰©å±•å¯†ç æœåŠ¡æä¾›è€…BCCSPï¼Œä»¥åŠå¯æ‰©å±•å›½å¯†</title>
    <link href="http://lessisbetter.site/2020/04/12/fabric-bccsp/"/>
    <id>http://lessisbetter.site/2020/04/12/fabric-bccsp/</id>
    <published>2020-04-12T06:32:33.000Z</published>
    <updated>2020-04-12T08:14:56.193Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h2><p>å¯†ç å­¦æ˜¯å½“ä»£æ•°å­—ä¿¡æ¯åŒ–æ—¶ä»£çš„åŸºç¡€æŠ€æœ¯ï¼Œæ²¡æœ‰å¯†ç å­¦ï¼Œç½‘ç»œä¸Šçš„ä¼ è¾“ä¿¡æ¯çš„å¯é æ€§å°±æ— æ³•ä¿è¯ï¼Œæ¯”å¦‚ä½ è¾“å…¥çš„å¯†ç ä¼šè¢«çªƒå–ï¼Œä½ å­˜åœ¨ç½‘ç»œä¸Šçš„ç…§ç‰‡ã€æ–‡æ¡£å¦‚æœæ²¡æœ‰åŠ å¯†ï¼Œå°±æœ‰å¯èƒ½æ³„éœ²ã€‚</p><p>å¯†ç å­¦ä¹Ÿæ˜¯åŒºå—é“¾çš„ä¸€é¡¹åŸºç¡€æŠ€æœ¯ï¼Œä½¿ç”¨å¯†ç å­¦å®ç°åŒºå—é“¾ä¸­çš„ï¼šèº«ä»½éªŒè¯ã€æ•°æ®å¯ä¿¡ã€æƒé™ç®¡ç†ã€é›¶çŸ¥è¯†è¯æ˜ã€å¯ä¿¡è®¡ç®—ç­‰ç­‰ã€‚</p><p>Fabricæä¾›äº†æ¨¡å—åŒ–çš„ã€å¯æ’æ‹”çš„å¯†ç æœåŠ¡ï¼Œè¯¥æœåŠ¡ç”±<code>bccsp</code>æ¨¡å—æä¾›ï¼Œæœ¬æ–‡å°±è°ˆä¸€ä¸‹BCCSPæ’ä»¶åŒ–è®¾è®¡ï¼Œå¦å¤–Fabricå›½å¯†åŒ–ä¹Ÿæ˜¯æœ€è¿‘2å¹´å¿…åšçš„äº‹æƒ…ï¼Œæ‰€ä»¥åŒæ—¶ä»‹ç»å®ç°å¯æ‰©å±•å›½å¯†çš„æ€è·¯ï¼Œæœ€åä»‹ç»ä¸€ä¸‹Hyperledgerç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„å¼€å‘ã€‚</p><h2 id="BCCSPä»‹ç»"><a href="#BCCSPä»‹ç»" class="headerlink" title="BCCSPä»‹ç»"></a>BCCSPä»‹ç»</h2><p>BCCSPæ˜¯Block Chain Crypto Service Providerçš„ç¼©å†™ã€‚</p><p><code>bccsp</code>æ¨¡å—å®ƒä¸ºFabricçš„ä¸Šå±‚æ¨¡å—æä¾›å¯†ç å­¦æœåŠ¡ï¼Œå®ƒåŒ…å«çš„å…·ä½“åŠŸèƒ½æœ‰ï¼šå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†çš„å¯†é’¥ç”Ÿæˆã€å¯¼å¦‚ã€å¯¼å‡ºï¼Œæ•°å­—ç­¾åå’ŒéªŒè¯ï¼Œå¯¹ç§°åŠ å¯†å’Œè§£å¯†ã€æ‘˜è¦è®¡ç®—ã€‚</p><p><code>bccsp</code>æ¨¡å—ä¸ºäº†å¯†ç æœåŠ¡çš„æ‰©å±•æ€§ï¼Œå®šä¹‰äº†<code>BCCSP</code>æ¥å£ï¼Œä¸Šå±‚æ¨¡å—è°ƒç”¨<code>BCCSP</code>æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œè€Œä¸ç›´æ¥è°ƒç”¨å…·ä½“çš„å®ç°å‡½æ•°ï¼Œå®ç°å’Œå…·ä½“å¯†ç å­¦å®ç°çš„è§£è€¦ï¼Œå½“<code>bccsp</code>ä½¿ç”¨ä¸åŒå¯†ç å­¦å®ç°æ—¶ï¼Œä¸Šå±‚æ¨¡å—æ— éœ€ä¿®æ”¹ï¼Œè¿™ç§è§£è€¦æ˜¯é€šè¿‡<strong>ä¾èµ–åè½¬</strong>å®ç°çš„ã€‚</p><p>bccspæ¨¡å—ä¸­å½“å‰æœ‰2ç§å¯†ç å®ç°ï¼Œå®ƒä»¬éƒ½æ˜¯bccspä¸­çš„å¯†ç å­¦æ’ä»¶ï¼šSWå’ŒPKCS11ï¼ŒSWä»£è¡¨çš„æ˜¯å›½é™…æ ‡å‡†åŠ å¯†çš„è½¯å®ç°ï¼ŒSWæ˜¯softwareçš„ç¼©å†™ï¼ŒPKCS11ä»£æŒ‡ç¡¬å®ç°ã€‚</p><p><img src="http://img.lessisbetter.site/2020-04-fabric-bccsp.png" alt=""></p><blockquote><p>æ‰©å±•é˜…è¯»ï¼šPKCS11æ˜¯PKCSç³»åˆ—æ ‡å‡†ä¸­çš„ç¬¬11ä¸ªï¼Œå®ƒå®šä¹‰äº†åº”ç”¨å±‚å’Œåº•å±‚åŠ å¯†è®¾å¤‡çš„äº¤äº’æ ‡å‡†ï¼Œæ¯”å¦‚è¿‡å»åœ¨ç”µè„‘ä¸Šï¼Œæ’å…¥USBKeyç”¨ç½‘é“¶è½¬è´¦æ—¶ï¼Œå°±éœ€è¦èµ°USBKeyä¸­çš„ç¡¬ä»¶è¿›è¡Œæ•°å­—ç­¾åï¼Œè¿™ä¸ªè¿‡ç¨‹å°±éœ€è¦ä½¿ç”¨PCKS11ã€‚</p></blockquote><p>å¯†ç å­¦é€šå¸¸æœ‰è½¯å®ç°å’Œç¡¬å®ç°ï¼Œè½¯å®ç°å°±æ˜¯å¸¸ç”¨çš„å„ç§åŠ å¯†åº“ï¼Œæ¯”å¦‚Goä¸­<code>crypto</code>åŒ…ï¼Œç¡¬å®ç°æ˜¯ä½¿ç”¨åŠ å¯†æœºæä¾›çš„ä¸€å¥—åŠ å¯†æœåŠ¡ã€‚è½¯å®ç°å’Œç¡¬å®ç°çš„é‡è¦åŒºåˆ«æ˜¯ï¼Œå¯†ç ç®—æ³•çš„å®‰å…¨æ€§å¼ºä¾èµ–éšæœºæ•°ï¼Œè½¯å®ç°åˆ©ç”¨çš„æ˜¯OSçš„ä¼ªéšæœºæ•°ï¼Œè€Œç¡¬å®ç°åˆ©ç”¨çš„æ˜¯åŠ å¯†æœºç”Ÿæˆçš„éšæœºæ•°ï¼Œæ‰€ä»¥ç¡¬å®ç°çš„å®‰å…¨å¼ºåº¦è¦é«˜äºè½¯å®ç°ã€‚</p><p>è®©Fabricæ”¯æŒå›½å¯†æ—¶ï¼Œå°±éœ€è¦åœ¨bccspä¸­æ–°å¢ä¸€ä¸ªå›½å¯†æ’ä»¶<code>GM</code>ï¼Œåªåœ¨bccspä¸­å¢åŠ GMå¹¶ä¸æ˜¯å®Œæˆçš„Fabricå›½å¯†æ”¹é€ ï¼Œä¸‹æ–‡å†è¯¦ç»†ä»‹ç»ã€‚</p><h2 id="SWä»‹ç»"><a href="#SWä»‹ç»" class="headerlink" title="SWä»‹ç»"></a>SWä»‹ç»</h2><p>SWæ˜¯å›½é™…æ ‡å‡†åŠ å¯†çš„è½¯å®ç°æ’ä»¶ï¼Œå®ƒåŒ…å«äº†ECDSAç®—æ³•ã€RSAç®—æ³•ã€AESç®—æ³•ï¼Œä»¥åŠSHAç³»åˆ—çš„æ‘˜è¦ç®—æ³•ã€‚</p><p><code>BCCSP</code>æ¥å£å®šä¹‰äº†ä»¥ä¸‹æ–¹æ³•ï¼Œå…¶å®å¯¹å¯†ç å­¦ä¸­çš„å‡½æ•°è¿›è¡Œäº†ä¸€ä¸ªåŠŸèƒ½åˆ†ç±»ï¼š</p><ul><li><code>KeyGen</code>ï¼šå¯†é’¥ç”Ÿæˆï¼ŒåŒ…å«å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†</li><li><code>KeyDeriv</code>ï¼šå¯†é’¥æ´¾ç”Ÿ</li><li><code>KeyImport</code>ï¼šå¯†é’¥å¯¼å…¥ï¼Œä»æ–‡ä»¶ã€å†…å­˜ã€æ•°å­—è¯ä¹¦ä¸­å¯¼å…¥</li><li><code>GetKey</code>ï¼šè·å–å¯†é’¥</li><li><code>Hash</code>ï¼šè®¡ç®—æ‘˜è¦</li><li><code>GetHash</code>ï¼šè·å–æ‘˜è¦è®¡ç®—å®ä¾‹</li><li><code>Sign</code>ï¼šæ•°å­—ç­¾å</li><li><code>Verify</code>ï¼šç­¾åéªŒè¯</li><li><code>Encrypt</code>ï¼šæ•°æ®åŠ å¯†ï¼ŒåŒ…å«å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†</li><li><code>Decrypt</code>ï¼šæ•°æ®è§£å¯†ï¼ŒåŒ…å«å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†</li></ul><p>SWè¦åšçš„æ˜¯ï¼ŒæŠŠECDSAã€RSAã€AESã€SHAä¸­çš„å„ç§å‡½æ•°ï¼Œå¯¹åº”åˆ°ä»¥ä¸Šå„ç§åˆ†ç±»ä¸­ï¼Œä¸»è¦çš„åˆ†ç±»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="http://img.lessisbetter.site/2020-04-12-bccsp-sw.png" alt=""></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå¯†é’¥ç”Ÿæˆã€æ´¾ç”Ÿã€å¯¼å…¥éƒ½åŒ…å«äº†ECDSAã€RSAã€AESï¼Œç­¾åå’Œå»¶ç­¾åŒ…å«äº†ECDSAå’ŒRSAï¼Œæ‘˜è¦è®¡ç®—åŒ…å«äº†SHAç³»åˆ—ï¼ŒåŠ å¯†è§£å¯†åŒ…å«äº†AESï¼Œä½†æ²¡æœ‰åŒ…å«RSAï¼Œæ˜¯å› ä¸ºéå¯¹ç§°åŠ å¯†è€—æ—¶ï¼Œå¹¶ä¸å¸¸ç”¨ã€‚</p><h2 id="å¯æ’æ‹”å›½å¯†"><a href="#å¯æ’æ‹”å›½å¯†" class="headerlink" title="å¯æ’æ‹”å›½å¯†"></a>å¯æ’æ‹”å›½å¯†</h2><p>Fabricæ”¯æŒå›½å¯†å¹¶éä»…ä»…åœ¨bccspä¸­å¢åŠ 1ä¸ªå›½å¯†å®ç°è¿™ä¹ˆç®€å•ï¼Œè¿˜éœ€è¦è®©æ•°å­—è¯ä¹¦æ”¯æŒå›½å¯†ï¼Œè®©æ•°å­—è¯ä¹¦çš„æ“ä½œç¬¦åˆX.509ã€‚å„è¯­è¨€çš„æ ‡å‡†åº“<code>x509</code>éƒ½æ˜¯é€‚é…æ ‡å‡†åŠ å¯†çš„ï¼Œå¹¶ä¸èƒ½ç›´æ¥ç”¨æ¥æ“ä½œå›½å¯†è¯ä¹¦ã€‚</p><p>åœ¨æ•°å­—è¯ä¹¦æ”¯æŒå›½å¯†åï¼Œè¿˜å¯èƒ½éœ€è¦è¿›ä¸€æ­¥è€ƒè™‘ï¼Œæ˜¯å¦éœ€è¦TLSè¯ä¹¦ä½¿ç”¨å›½å¯†æ•°å­—è¯ä¹¦ï¼Œè®©é€šä¿¡è¿‡ç¨‹ä½¿ç”¨å›½å¯†ç®—æ³•ã€‚</p><p>å¦å¤–ï¼Œå›½å¯†çš„å®ç°æœ‰å¾ˆå¤šç‰ˆæœ¬ï¼Œå¦‚æœéœ€è¦é€‚é…ä¸åŒçš„å›½å¯†å®ç°ï¼Œå°±éœ€è¦ä¿è¯å›½å¯†çš„å¯æ’æ‹”å’Œå¯æ‰©å±•ã€‚</p><p>ç»¼ä¸Šæƒ…å†µï¼Œä½ éœ€è¦ä¸€ä¸ªä¸­é—´ä»¶ï¼Œä¸­é—´ä»¶ä¸­åŒ…å«å®šä¹‰å¥½å›½å¯†æ¥å£ã€å›½å¯†æ•°å­—è¯ä¹¦æ¥å£ç­‰ï¼Œç”¨è¿™äº›æ¥å£å»é€‚é…Fabricï¼Œç„¶åå½“é‡‡ç”¨ä¸åŒå›½å¯†å®ç°æ—¶ï¼Œåªéœ€è¦å¯¹å…·ä½“å®ç°è¿›è¡Œå°è£…ï¼Œå»é€‚é…ä¸­é—´ä»¶ä¸­å®šä¹‰å¥½çš„æ¥å£ã€‚</p><p><img src="http://img.lessisbetter.site/2020-04-fabric-gm.png" alt=""></p><h2 id="ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦"><a href="#ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦" class="headerlink" title="ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦"></a>ç¤¾åŒºå¯¹Fabricæ”¯æŒå›½å¯†çš„æ€åº¦</h2><p>å›½å¯†æœ‰å¾ˆå¤šåŸºäºFabricçš„é¡¹ç›®ï¼Œé‡‘èä¸šæ˜¯åŒºå—é“¾åœºæ™¯æœ€å¤šçš„è¡Œä¸šï¼Œé‡‘èè¡Œä¸šåˆå¿…é¡»ä½¿ç”¨å›½å¯†ï¼Œæ‰€ä»¥å›½å†…å¯¹Fabricå›½å¯†çš„æ”¹é€ æ˜¯å¿…é¡»çš„ï¼Œåœ¨ã€Šé‡‘èåˆ†å¸ƒå¼è´¦æœ¬å®‰å…¨è§„èŒƒã€‹å‘å¸ƒä¹‹åï¼Œç¤¾åŒºä¹Ÿè®¡åˆ’è®©Fabricæ”¯æŒå›½å¯†ï¼Œä½†æ–¹å¼æ˜¯ä¸æä¾›å…·ä½“å›½å¯†å®ç°ï¼Œè€Œæ˜¯å®šä¹‰å¥½æ¥å£ï¼Œé¡¹ç›®æ–¹ä½¿ç”¨å“ªç§å›½å¯†å®ç°ï¼Œå»é€‚é…å®šä¹‰å¥½çš„æ¥å£å³å¯ï¼Œè¿™æ ·ä¿ç•™äº†å¥½çš„æ‰©å±•æ€§ï¼Œä¸<a href="#å¯æ’æ‹”å›½å¯†">å¯æ’æ‹”å›½å¯†</a>çš„ç›®çš„æ˜¯ä¸€è‡´çš„ï¼Œé€‰æ‹©æƒäº¤ç»™ä¼ä¸šã€‚</p><p>ç¤¾åŒºæ”¯æŒFabricå›½å¯†çš„ç‰ˆæœ¬ï¼Œé¢„è®¡åœ¨2.xç‰ˆæœ¬å‘å¸ƒã€‚</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å¯†ç å­¦åœ¨åŒºå—é“¾ä¸­çš„åœ°ä½æ˜¯ç›¸å½“é«˜çš„ï¼Œä»åŒºå—é“¾ä½¿ç”¨æœ€åŸºç¡€çš„å¯†ç å­¦ï¼Œåˆ°ç°åœ¨è¿˜åœ¨ä¸æ–­èå…¥åŒæ€åŠ å¯†ã€é›¶çŸ¥è¯†è¯æ˜ç­‰å‰è¨€çš„åŠ å¯†æŠ€æœ¯ï¼Œæœªæ¥å¯ä»¥åœ¨åŒºå—é“¾ä¸Šä¿æŠ¤æ•°æ®éšç§çš„æƒ…å†µï¼Œæä¾›æ›´å¥½çš„æœåŠ¡ï¼ŒåŒºå—é“¾ä¹Ÿå¯ä»¥æœ‰æ›´å¤šçš„åº”ç”¨åœºæ™¯ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;åºè¨€&quot;&gt;&lt;a href=&quot;#åºè¨€&quot; class=&quot;headerlink&quot; title=&quot;åºè¨€&quot;&gt;&lt;/a&gt;åºè¨€&lt;/h2&gt;&lt;p&gt;å¯†ç å­¦æ˜¯å½“ä»£æ•°å­—ä¿¡æ¯åŒ–æ—¶ä»£çš„åŸºç¡€æŠ€æœ¯ï¼Œæ²¡æœ‰å¯†ç å­¦ï¼Œç½‘ç»œä¸Šçš„ä¼ è¾“ä¿¡æ¯çš„å¯é æ€§å°±æ— æ³•ä¿è¯ï¼Œæ¯”å¦‚ä½ è¾“å…¥çš„å¯†ç ä¼šè¢«çªƒå–ï¼Œä½ å­˜åœ¨ç½‘ç»œä¸Šçš„ç…§ç‰‡ã€æ–‡æ¡£å¦‚æœ
      
    
    </summary>
    
    
    
      <category term="åŒºå—é“¾" scheme="http://lessisbetter.site/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="Fabric" scheme="http://lessisbetter.site/tags/Fabric/"/>
    
      <category term="å¯†ç å­¦" scheme="http://lessisbetter.site/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>æé«˜ç”»æ—¶åºå›¾çš„æ•ˆç‡</title>
    <link href="http://lessisbetter.site/2020/03/23/markdown-mermaid/"/>
    <id>http://lessisbetter.site/2020/03/23/markdown-mermaid/</id>
    <published>2020-03-23T07:28:40.000Z</published>
    <updated>2020-03-23T07:30:04.354Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://mermaid-js.github.io/mermaid/#/README" target="_blank" rel="noopener">mermaid</a>æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå¯ä»¥åœ¨Markdownä¸­ï¼Œä½¿ç”¨ç±»ä¼¼ç¼–å†™ä»£ç çš„æ–¹å¼ï¼Œåˆ¶ä½œæµç¨‹å›¾ã€æ—¶åºå›¾ã€ç”˜ç‰¹å›¾ã€é¥¼å›¾ç­‰ã€‚ä½¿ç”¨ä¸‹æ¥ï¼Œæ„Ÿè§‰å¯ä»¥æ˜æ˜¾æå‡æ—¶åºå›¾çš„æ•ˆç‡ã€‚</p><h3 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h3><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    %% æ³¨é‡Š</span><br><span class="line">    Client -&gt;&gt; Gateway: å‘é€JSON RPCè¯·æ±‚</span><br><span class="line">    Gateway -&gt;&gt; Gateway: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚</span><br><span class="line">    Gateway -&gt;&gt; Server: å‘é€gRPCè¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†gRPCè¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Gateway: å‘é€gRPCå“åº”</span><br><span class="line">    Gateway -&gt;&gt; Gateway: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”</span><br><span class="line">    Gateway -&gt;&gt; Client: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    %% æ³¨é‡Š    Client ->> Gateway: å‘é€JSON RPCè¯·æ±‚    Gateway ->> Gateway: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚    Gateway ->> Server: å‘é€gRPCè¯·æ±‚    Server ->> Server: å¤„ç†gRPCè¯·æ±‚    Server ->> Gateway: å‘é€gRPCå“åº”    Gateway ->> Gateway: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”    Gateway ->> Client: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</pre><h4 id="æ˜µç§°"><a href="#æ˜µç§°" class="headerlink" title="æ˜µç§°"></a>æ˜µç§°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    participant C as Client</span><br><span class="line">    participant G as Gateway</span><br><span class="line">    participant S as Server</span><br><span class="line"></span><br><span class="line">    C -&gt;&gt; G: å‘é€JSON RPCè¯·æ±‚</span><br><span class="line">    G -&gt;&gt; G: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚</span><br><span class="line">    G -&gt;&gt; S: å‘é€gRPCè¯·æ±‚</span><br><span class="line">    S -&gt;&gt; S: å¤„ç†gRPCè¯·æ±‚</span><br><span class="line">    S -&gt;&gt; G: å‘é€gRPCå“åº”</span><br><span class="line">    G -&gt;&gt; G: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”</span><br><span class="line">    G -&gt;&gt; C: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    participant C as Client    participant G as Gateway    participant S as Server    C ->> G: å‘é€JSON RPCè¯·æ±‚    G ->> G: JSON RPCè¯·æ±‚è½¬æ¢ä¸ºgRPCè¯·æ±‚    G ->> S: å‘é€gRPCè¯·æ±‚    S ->> S: å¤„ç†gRPCè¯·æ±‚    S ->> G: å‘é€gRPCå“åº”    G ->> G: gRPCå“åº”è½¬æ¢ä¸ºJSON RPCå“åº”    G ->> C: æŠŠJSON RPCå“åº”å‘é€ç»™å®¢æˆ·ç«¯</pre><h4 id="çº¿æ¡å’Œç®­å¤´"><a href="#çº¿æ¡å’Œç®­å¤´" class="headerlink" title="çº¿æ¡å’Œç®­å¤´"></a>çº¿æ¡å’Œç®­å¤´</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt; Gateway: å®çº¿</span><br><span class="line">    Client --&gt; Gateway: è™šçº¿ --</span><br><span class="line">    Client -&gt;&gt; Gateway: å¸¦ç®­å¤´ &gt;&gt;</span><br><span class="line">    Client -x Gateway: å¸¦å‰ï¼Œä¸ä½¿ç”¨&gt;</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    Client -> Gateway: å®çº¿    Client --> Gateway: è™šçº¿ --    Client ->> Gateway: å¸¦ç®­å¤´ >>    Client -x Gateway: å¸¦å‰ï¼Œä¸ä½¿ç”¨></pre><h4 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Note left of Client: åˆ›å»ºè¯·æ±‚</span><br><span class="line">    Note right of Gateway: æ¥æ”¶è¯·æ±‚</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    Note left of Client: åˆ›å»ºè¯·æ±‚    Note right of Gateway: æ¥æ”¶è¯·æ±‚</pre><h4 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    loop Every Second</span><br><span class="line">        Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">        Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">        Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    end</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    loop Every Second        Client ->> Server: å‘é€è¯·æ±‚        Server ->> Server: å¤„ç†è¯·æ±‚        Server ->> Client: å‘é€å“åº”    end</pre><h4 id="Ifè¯­å¥"><a href="#Ifè¯­å¥" class="headerlink" title="Ifè¯­å¥"></a>Ifè¯­å¥</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: æŸ¥è¯¢ç”¨æˆ·</span><br><span class="line">    alt User not found</span><br><span class="line">        Server -&gt;&gt; Server: åˆ›å»ºé”™è¯¯å“åº”ï¼šç”¨æˆ·ä¸å­˜åœ¨</span><br><span class="line">    else </span><br><span class="line">        Server -&gt;&gt; Server: ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯åˆ›å»ºå“åº”</span><br><span class="line">    end</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    Client ->> Server: æŸ¥è¯¢ç”¨æˆ·    alt User not found        Server ->> Server: åˆ›å»ºé”™è¯¯å“åº”ï¼šç”¨æˆ·ä¸å­˜åœ¨    else         Server ->> Server: ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯åˆ›å»ºå“åº”    end    Server ->> Client: å‘é€å“åº”</pre><h4 id="èƒŒæ™¯é¢œè‰²"><a href="#èƒŒæ™¯é¢œè‰²" class="headerlink" title="èƒŒæ™¯é¢œè‰²"></a>èƒŒæ™¯é¢œè‰²</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">    rect rgb(191,223,255)</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    end</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    Client ->> Server: å‘é€è¯·æ±‚    rect rgb(191,223,255)    Server ->> Server: å¤„ç†è¯·æ±‚    Server ->> Client: å‘é€å“åº”    end</pre><h4 id="æ¿€æ´»"><a href="#æ¿€æ´»" class="headerlink" title="æ¿€æ´»"></a>æ¿€æ´»</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Client -&gt;&gt; Server: å‘é€è¯·æ±‚</span><br><span class="line">    activate Server</span><br><span class="line">    Server -&gt;&gt; Server: å¤„ç†è¯·æ±‚</span><br><span class="line">    Server -&gt;&gt; Client: å‘é€å“åº”</span><br><span class="line">    deactivate Server</span><br></pre></td></tr></table></figure><pre class="mermaid">sequenceDiagram    Client ->> Server: å‘é€è¯·æ±‚    activate Server    Server ->> Server: å¤„ç†è¯·æ±‚    Server ->> Client: å‘é€å“åº”    deactivate Server</pre><h3 id="é¥¼å›¾"><a href="#é¥¼å›¾" class="headerlink" title="é¥¼å›¾"></a>é¥¼å›¾</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pie</span><br><span class="line">    title ç¡¬å¸æ­£åé¢çš„æ¦‚ç‡</span><br><span class="line">    &quot;æ­£é¢&quot;: 0.5</span><br><span class="line">    &quot;åé¢&quot;: 0.5</span><br></pre></td></tr></table></figure><pre class="mermaid">pie    title ç¡¬å¸æ­£åé¢çš„æ¦‚ç‡    "æ­£é¢": 0.5    "åé¢": 0.5</pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://mermaid-js.github.io/mermaid/#/README&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;mermaid&lt;/a&gt;æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå¯ä»¥åœ¨Markdownä¸­ï¼Œä½¿ç”¨ç±»ä¼¼ç¼–å†™ä»£ç çš„æ–¹å¼ï¼Œåˆ¶ä½œæµç¨‹å›¾ã€
      
    
    </summary>
    
    
    
      <category term="å†™ä½œ" scheme="http://lessisbetter.site/tags/%E5%86%99%E4%BD%9C/"/>
    
      <category term="å·¥å…·" scheme="http://lessisbetter.site/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="Markdown" scheme="http://lessisbetter.site/tags/Markdown/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changes</title>
    <link href="http://lessisbetter.site/2020/03/22/why-pbft-needs-viewchange/"/>
    <id>http://lessisbetter.site/2020/03/22/why-pbft-needs-viewchange/</id>
    <published>2020-03-22T06:10:53.000Z</published>
    <updated>2020-04-11T09:33:20.052Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨å½“å‰çš„PBFTèµ„æ–™ä¸­ï¼Œå°¤å…¶æ˜¯ä¸­æ–‡èµ„æ–™ï¼Œå¤šæ•°éƒ½åœ¨ä»‹ç»PBFTçš„3é˜¶æ®µæ¶ˆæ¯è¿‡ç¨‹ï¼Œå¾ˆå°‘æåŠView Changesï¼ˆè§†å›¾åˆ‡æ¢ï¼‰ï¼ŒView Changeså¯¹PBFTçš„é‡è¦æ€§ï¼Œå¦‚åŒLeader Electionå¯¹Raftçš„é‡è¦æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸€è‡´æ€§ç®—æ³•ä¸­ï¼Œä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚</p><p>ä½œè€…ä¸ºå¤§å®¶ä»‹ç»ä¸‹ï¼Œä¸ºä»€ä¹ˆView Changeså¦‚æ­¤é‡è¦ï¼Œå³ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changesï¼Œä»¥åŠView Changesçš„åŸç†ã€‚</p><h2 id="ä¸ºä»€ä¹ˆPBFTéœ€è¦View-Changes"><a href="#ä¸ºä»€ä¹ˆPBFTéœ€è¦View-Changes" class="headerlink" title="ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changes"></a>ä¸ºä»€ä¹ˆPBFTéœ€è¦View Changes</h2><p>ä¸€è‡´æ€§ç®—æ³•éƒ½è¦æä¾›ï¼š</p><ul><li>safety ï¼šåŸæ„æŒ‡ä¸ä¼šå‡ºç°é”™è¯¯æƒ…å†µï¼Œä¸€è‡´æ€§ä¸­æŒ‡æ“ä½œæ˜¯æ­£ç¡®çš„ï¼Œå¾—åˆ°ç›¸åŒçš„ç»“æœã€‚</li><li>liveness ï¼šæ“ä½œè¿‡ç¨‹èƒ½åœ¨æœ‰é™æ—¶é—´å†…å®Œæˆã€‚</li></ul><p><img src="http://img.lessisbetter.site/2020-03-consistency-property.png" alt="ä¸€è‡´æ€§åè®®éœ€è¦æ»¡è¶³çš„ç‰¹æ€§"></p><p><strong>safetyé€šå¸¸ç§°ä¸ºä¸€è‡´æ€§ï¼Œlivenessé€šå¸¸ç§°ä¸ºå¯ç”¨æ€§</strong>ï¼Œæ²¡æœ‰livenessçš„ä¸€è‡´æ€§ç®—æ³•æ— æ³•é•¿æœŸæä¾›ä¸€è‡´æ€§æœåŠ¡ï¼Œæ²¡æœ‰safetyçš„ä¸€è‡´æ€§ç®—æ³•ç§°ä¸ä¸Šä¸€è‡´æ€§ç®—æ³•ï¼Œæ‰€ä»¥ï¼Œæ‰€æœ‰çš„ä¸€è‡´æ€§ç®—æ³•éƒ½åœ¨åšäºŒè€…ä¹‹é—´çš„æŠ˜ä¸­ã€‚</p><p>æ‰€ä»¥å¯¹ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¸åŒçš„è¦æ±‚ï¼Œå°±å‡ºç°äº†ä½ å¸¸å¬è§çš„ACIDåŸç†ã€CAPç†è®ºã€BASEç†è®ºã€‚</p><p>PBFTä½œä¸ºä¸€ä¸ªä¸€è‡´æ€§ç®—æ³•ï¼Œå®ƒä¹Ÿéœ€è¦æä¾›ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ã€‚åœ¨<a href="https://lessisbetter.site/2020/03/15/why-pbft-needs-3-phase-message/">ä¸ºä»€ä¹ˆPBFTéœ€è¦3ä¸ªé˜¶æ®µæ¶ˆæ¯</a>ä¸­ï¼Œä»‹ç»äº†PBFTç®—æ³•çš„å¦‚ä½•è¾¾æˆä¸€è‡´æ€§ï¼Œå¹¶ä¸”è¯·æ±‚å¯ä»¥åœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆä¸€è‡´ï¼Œå®¢æˆ·ç«¯å¾—åˆ°å“åº”ï¼Œä¹Ÿæ»¡è¶³å¯ç”¨æ€§ã€‚</p><p>ä½†æ²¡æœ‰ä»‹ç»ï¼Œå½“é‡åˆ°ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œæ˜¯å¦è¿˜èƒ½ä¿ä½ä¸€è‡´æ€§å’Œå¯ç”¨æ€§å‘¢ï¼Ÿ</p><ol><li>ä¸»èŠ‚ç‚¹æ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼ˆå®•æœºã€æ‹’ç»å“åº”â€¦ï¼‰</li><li>ä¸»èŠ‚ç‚¹ä¸æ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼Œä½†éæ‹œå åº­å‰¯æœ¬èŠ‚ç‚¹å‚ä¸åº¦ä¸è¶³ï¼Œä¸è¶³ä»¥å®Œæˆ3é˜¶æ®µæ¶ˆæ¯</li><li>ç½‘ç»œä¸ç•…ï¼Œä¸¢åŒ…ä¸¥é‡ï¼Œé€ æˆä¸è¶³ä»¥å®Œæˆ3é˜¶æ®µæ¶ˆæ¯</li><li>â€¦</li></ol><p>åœ¨ä»¥ä¸Šåœºæ™¯ä¸­ï¼Œ<strong>æ–°çš„è¯·æ±‚æ— æ³•åœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆä¸€è‡´ï¼Œè€çš„æ•°æ®å¯ä»¥ä¿æŒä¸€è‡´æ€§ï¼Œæ‰€ä»¥ä¸€è‡´æ€§æ˜¯å¯ä»¥æ»¡è¶³çš„ï¼Œä½†å¯ç”¨æ€§æ— æ³•æ»¡è¶³</strong>ã€‚å¿…é¡»å¯»æ‰¾ä¸€ä¸ªæ–¹æ¡ˆï¼Œæ¢å¤é›†ç¾¤çš„å¯ç”¨æ€§ã€‚</p><p><strong>PBFTç®—æ³•ä½¿ç”¨View Changesï¼Œè®©é›†ç¾¤é‡æ–°å…·æœ‰å¯ç”¨æ€§</strong>ã€‚é€šè¿‡View Changesï¼Œå¯ä»¥é€‰ä¸¾å‡ºæ–°çš„ã€è®©è¯·æ±‚åœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆä¸€è‡´çš„ä¸»èŠ‚ç‚¹ï¼Œå‘å®¢æˆ·ç«¯å“åº”ï¼Œä»è€Œæ»¡è¶³å¯ç”¨æ€§çš„è¦æ±‚ã€‚</p><p>è®©é›†ç¾¤é‡æ–°æ¢å¤å¯ç”¨ï¼Œéœ€è¦åšåˆ°ä»€ä¹ˆå‘¢ï¼Ÿ<strong>è®©è‡³å°‘f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹è¿ç§»åˆ°ï¼Œæ–°çš„ä¸€è‡´çš„çŠ¶æ€</strong>ã€‚ç„¶åè¿™äº›èŠ‚ç‚¹ï¼Œè¿è¡Œ3é˜¶æ®µæ¶ˆæ¯åè®®ï¼Œå¤„ç†æ–°çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶è¾¾æˆä¸€è‡´ã€‚</p><h2 id="ä¸åŒç‰ˆæœ¬çš„View-Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#ä¸åŒç‰ˆæœ¬çš„View-Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="ä¸åŒç‰ˆæœ¬çš„View Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>ä¸åŒç‰ˆæœ¬çš„View Changesåè®®æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h2><p>PBFTç®—æ³•æœ‰1999å¹´å’Œ2001å¹´2ä¸ªç‰ˆæœ¬ï¼š</p><ul><li>99å¹´ï¼š<a href="http://pmg.csail.mit.edu/papers/osdi99.pdf" target="_blank" rel="noopener">Practical Byzantine Fault Tolerance</a>ï¼ŒPBFTåˆæ¬¡å‘è¡¨ã€‚</li><li>01å¹´ï¼š<a href="http://www.pmg.csail.mit.edu/papers/bft-tocs.pdf" target="_blank" rel="noopener">Practical Byzantine Fault Tolerance and Proactive Recovery</a>ï¼Œåˆç§°PBFT-PRï¼Œè®©PBFTå—æ”»å‡»æ—¶ï¼Œå…·æœ‰ä¸»åŠ¨æ¢å¤èƒ½åŠ›ã€‚</li></ul><p>PBFT-PRå¹¶éåªæ˜¯åœ¨PBFTä¸Šå¢åŠ äº†PRï¼ŒåŒæ—¶ä¹Ÿå¯¹PBFTç®—æ³•åšäº†è¯¦ç»†çš„ä»‹ç»å’Œæ”¹è¿›ï¼ŒView Changesçš„æ”¹è¿›å°±æ˜¯å…¶ä¸­ä¸€é¡¹ã€‚</p><p>PBFTä¸­View Changesä»‹ç»æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰è¯´æ˜ä»¥ä¸‹åœºæ™¯ä¸‹ï¼ŒView Changesåè®®å¦‚ä½•å¤„ç†ï¼š</p><ul><li>å¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹å®•æœºäº†æ€ä¹ˆåŠ</li><li>å¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹æ˜¯æ¶æ„èŠ‚ç‚¹ï¼Œä½œæ¶æ€ä¹ˆåŠ</li><li>å¦‚æœéæ‹œå åº­æ¶æ„å‘èµ·View Changesï¼Œé€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢æ€ä¹ˆåŠï¼Ÿ</li><li>å¦‚æœå‚ä¸View Changesçš„èŠ‚ç‚¹æ•°é‡ä¸è¶³æ€ä¹ˆåŠ</li></ul><p>å¦‚æœï¼Œä»¥ä¸Šåœºæ™¯ä¸‹ï¼ŒèŠ‚ç‚¹å¤„åœ¨View Changesé˜¶æ®µï¼ŒæŒç»­çš„ç­‰å¾…ä¸‹å»ï¼Œå°±æ— æ³•æ¢å¤é›†ç¾¤çš„å¯ç”¨æ€§ã€‚</p><p>PBFT-PRä¸­çš„View Changesåè®®è¿›è¡Œäº†ç»†åŒ–ï¼Œå¯ä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚</p><h2 id="2001å¹´ç‰ˆæœ¬View-Changesåè®®åŸç†"><a href="#2001å¹´ç‰ˆæœ¬View-Changesåè®®åŸç†" class="headerlink" title="2001å¹´ç‰ˆæœ¬View Changesåè®®åŸç†"></a>2001å¹´ç‰ˆæœ¬View Changesåè®®åŸç†</h2><p>æ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ‹¥æœ‰ä¸€ä¸ªViewï¼Œå°±å¦‚åŒRaftä¸­æ¯ä¸ªleaderéƒ½æ‹¥æœ‰1ä¸ªtermã€‚ä¸åŒç‚¹æ˜¯termæ‰€å±çš„leaderæ˜¯é€‰ä¸¾å‡ºæ¥çš„ï¼Œè€ŒViewæ‰€å±çš„ä¸»èŠ‚ç‚¹æ˜¯è®¡ç®—å‡ºçš„ï¼š <code>primary = v % R</code>ï¼ŒRæ˜¯è¿è¡ŒPBFTåè®®çš„èŠ‚ç‚¹æ•°é‡ã€‚</p><p>View Changesçš„æˆ˜ç•¥æ˜¯ï¼šå½“å‰¯æœ¬èŠ‚ç‚¹æ€€ç–‘ä¸»èŠ‚ç‚¹æ— æ³•è®©è¯·æ±‚è¾¾æˆä¸€è‡´æ—¶ï¼Œå‘èµ·è§†å›¾åˆ‡æ¢ï¼Œæ–°çš„ä¸»èŠ‚ç‚¹æ”¶é›†å½“å‰è§†å›¾ä¸­å·²ç»Preparedï¼Œä½†æœªCommittedçš„è¯·æ±‚ï¼Œä¼ é€’åˆ°ä¸‹ä¸€ä¸ªè§†å›¾ä¸­ï¼Œæ‰€æœ‰éæ‹œå åº­èŠ‚ç‚¹åŸºäºä»¥ä¸Šè¯·æ±‚ï¼Œä¼šè¾¾åˆ°ä¸€ä¸ªæ–°çš„ã€ä¸€è‡´çš„çŠ¶æ€ã€‚ç„¶åï¼Œæ­£å¸¸è¿è¡Œ3é˜¶æ®µæ¶ˆæ¯åè®®ã€‚</p><p>ä¸ºä»€ä¹ˆè¦åŒ…å«å·²ç»Preparedï¼Œä½†æœªCommittedçš„è¯·æ±‚ï¼Ÿå¦‚æœä¸€ä¸ªè¯·æ±‚ï¼Œåœ¨å‰¯æœ¬èŠ‚ç‚¹iä¸Šï¼Œå·²ç»æ˜¯PreparedçŠ¶æ€ï¼Œè¯æ˜è‡³å°‘f+1çš„éæ‹œå åº­èŠ‚ç‚¹ï¼Œå·²ç»æ‹¥æœ‰æ­¤è¯·æ±‚å¹¶èµæˆè¯·æ±‚reqåœ¨è§†å›¾vä¸­ä½¿ç”¨åºå·nã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œä¸å‘ç”Ÿè§†å›¾åˆ‡æ¢ï¼Œè¿™äº›è¯·æ±‚å¯ä»¥åœ¨æœ‰é™çš„æ—¶é—´å†…è¾¾æˆä¸€è‡´ï¼Œæ–°çš„ä¸»èŠ‚ç‚¹æŠŠå·²ç»Preparedçš„è¯·æ±‚ï¼Œå¸¦åˆ°æ–°çš„viewï¼Œå¹¶è¯æ˜ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œè¯·æ±‚å·²ç»Preparedï¼Œé‚£åªéœ€1è½®Commitå°±å¯ä»¥è¾¾æˆä¸€è‡´ã€‚</p><h3 id="View-Changesä¸»è¦æµç¨‹ç®€ä»‹"><a href="#View-Changesä¸»è¦æµç¨‹ç®€ä»‹" class="headerlink" title="View Changesä¸»è¦æµç¨‹ç®€ä»‹"></a>View Changesä¸»è¦æµç¨‹ç®€ä»‹</h3><p>å¯¹View Changesçš„æµç¨‹å¯ä»¥åˆ†ä¸º2éƒ¨åˆ†ï¼š</p><ul><li>View Changesçš„å¼€ç«¯ï¼Œå³æ¯ä¸€æ¬¡Viewçš„å¼€å§‹</li><li>View Changesçš„ä¸­é—´è¿‡ç¨‹ï¼Œä»¥åŠView Changesçš„ç»“æŸï¼Œåˆ‡æ¢åˆ°æ­£å¸¸æµç¨‹</li></ul><p>è¿™2éƒ¨åˆ†åˆ†åˆ«å æ®äº†ä¸‹å›¾çš„å·¦å³ä¸¤éƒ¨åˆ†ã€‚å®çº¿ä»£è¡¨æµç¨‹çº¿ï¼Œè™šçº¿ä»£è¡¨ç½‘ç»œæ¶ˆæ¯ã€‚è“è‰²ä»£è¡¨æ­£å¸¸æ“ä½œæµç¨‹ï¼ˆä¸‰é˜¶æ®µæ¶ˆæ¯ï¼šPreprepareã€Prepareã€Commitï¼‰ï¼Œé’è‰²ä»£è¡¨View Changesæµç¨‹ï¼Œè“é’ç›¸æ¥å°±æ˜¯æ­£å¸¸æµç¨‹å’ŒView Changesæµç¨‹åˆ‡æ¢çš„åœ°æ–¹ã€‚</p><p><img src="http://img.lessisbetter.site/2020-04-09-blueprint-view-changes.png" alt=""></p><p>View Changesçš„å¼€ç«¯æµç¨‹æ˜¯é€šç”¨çš„ï¼Œä¸»èŠ‚ç‚¹å’Œå‰¯æœ¬èŠ‚ç‚¹éƒ½éµå®ˆè¿™ä¸€æµç¨‹ï¼š<code>æ–°è§†å›¾ï¼šv=v+1</code>ï¼Œä»£è¡¨ä¸€ä¸ªæ–°çš„Viewå¼€å§‹ï¼ŒæŒ‡å‘å®ƒçš„æ¯ä¸€ä¸ªç®­å¤´ï¼Œéƒ½æ˜¯è§†å›¾åˆ‡æ¢çš„ä¸€ç§åŸå› ã€‚æŸä¸ªå‰¯æœ¬èŠ‚ç‚¹ï¼Œæ–°è§†å›¾çš„å¼€å§‹ï¼Œè¿˜ä¼´éšç€å¹¿æ’­<code>view-change</code>æ¶ˆæ¯ï¼Œå‘Šè¯‰å…¶ä»–èŠ‚ç‚¹ï¼Œæœ¬èŠ‚ç‚¹å¼€å¯äº†ä¸€ä¸ªæ–°çš„è§†å›¾ã€‚</p><p>ä¸»èŠ‚ç‚¹æ˜¯é€šè¿‡å…¬å¼ç®—å‡ºæ¥çš„ï¼Œå…¶ä½™ä¸ºå‰¯æœ¬èŠ‚ç‚¹ï¼Œåœ¨View Changesæµç¨‹ä¸­ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šå’Œä¸»èŠ‚ç‚¹äº¤äº’ï¼Œå…±åŒå®ŒæˆView Changesè¿‡ç¨‹ã€‚å‰¯æœ¬èŠ‚ç‚¹ä¼šå¯¹æ”¶åˆ°çš„<code>view-change</code>æ¶ˆæ¯è¿›è¡Œæ£€æŸ¥ï¼Œç„¶åæŠŠä¸€æ¡å¯¹åº”çš„<code>view-change-ack</code>æ¶ˆæ¯å‘é€ç»™ä¸»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹ä¼šä¾èµ–æ”¶åˆ°çš„<code>view-change</code>æ¶ˆæ¯å’Œ<code>view-change-ack</code>æ¶ˆæ¯æ•°é‡å’Œå†…å®¹ï¼Œäº§ç”Ÿèƒ½è®©æ‰€æœ‰èŠ‚ç‚¹ç§»åŠ¨åˆ°ç»Ÿä¸€çŠ¶æ€çš„<code>new-view</code>æ¶ˆæ¯ï¼Œå¹¶ä¸”å¯¹<code>new-view</code>æ¶ˆæ¯è¿›è¡Œ3é˜¶æ®µå…±è¯†ï¼Œå³å¯¹<code>new-view</code>æ¶ˆæ¯è¾¾æˆä¸€è‡´ï¼Œä»è€Œè®©è‡³å°‘<code>f+1</code>ä¸ªéæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´ã€‚</p><h3 id="View-Changesçš„å¼€ç«¯"><a href="#View-Changesçš„å¼€ç«¯" class="headerlink" title="View Changesçš„å¼€ç«¯"></a>View Changesçš„å¼€ç«¯</h3><p>View Changeçš„æ ¸å¿ƒå› ç´ åªæœ‰ä¸€ä¸ªï¼šæ€€ç–‘å½“å‰çš„ä¸»èŠ‚ç‚¹åœ¨æœ‰é™çš„æ—¶é—´å†…ï¼Œæ— æ³•è¾¾æˆä¸€è‡´ã€‚</p><p>å…·ä½“æœ‰4ä¸ªè·¯å¾„ï¼š</p><ol><li>æ­£å¸¸é˜¶æ®µå®šæ—¶å™¨è¶…æ—¶ï¼Œä»£è¡¨ä¸€å®šæ—¶é—´å†…æ— æ³•å®ŒæˆPre-prepare -&gt; Prepare -&gt; Commit</li><li>View Changesé˜¶æ®µå®šæ—¶å™¨è¶…æ—¶ï¼Œä»£è¡¨ä¸€å®šæ—¶é—´å†…æ— æ³•å®Œæˆæ­£åœ¨è¿›è¡Œçš„View Change</li><li>å®šæ—¶å™¨æœªè¶…æ—¶ï¼Œä½†æœ‰æ•ˆçš„view-changeæ¶ˆæ¯æ•°é‡è¾¾åˆ°f+1ä¸ªï¼Œä»£è¡¨å½“å‰å·²ç»æœ‰f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹å‘èµ·äº†æ–°çš„è§†å›¾åˆ‡æ¢ï¼Œæœ¬èŠ‚ç‚¹ä¸ºäº†ä¸è½åï¼Œä¸ç­‰å¾…è¶…æ—¶è€Œè¿›å…¥è§†å›¾åˆ‡æ¢</li><li>new-viewæ¶ˆæ¯ä¸åˆæ³•ï¼Œä»£è¡¨å½“å‰View Changesé˜¶æ®µçš„ä¸»èŠ‚ç‚¹ä¸ºæ‹œå åº­èŠ‚ç‚¹</li></ol><p>å›¾ä¸­ã€æ­£å¸¸é˜¶æ®µå®šæ—¶å™¨è¶…æ—¶ã€‘è¢«æ ‡è®°ä¸ºè“è‰²ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯æ­£å¸¸é˜¶æ®µè¿›å…¥è§†å›¾åˆ‡æ¢é˜¶æ®µçš„å¼€ç«¯ï¼Œã€æœ‰æ•ˆçš„view-changeæ¶ˆæ¯æ•°é‡è¾¾åˆ°f+1ä¸ªã€‘å³æœ‰å¯èƒ½æ˜¯æ­£å¸¸é˜¶æ®µçš„å®šæ—¶å™¨ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è§†å›¾åˆ‡æ¢è¿‡ç¨‹ä¸­çš„å®šæ—¶å™¨ï¼Œæ‰€ä»¥é¢œè‰²æ²¡åšè°ƒæ•´ã€‚</p><h3 id="ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹"><a href="#ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹" class="headerlink" title="ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹"></a>ä¸»å‰¯èŠ‚ç‚¹ä¸»è¦äº¤äº’æµç¨‹</h3><p>è§†å›¾åˆ‡æ¢è¿‡ç¨‹ä¸­æœ‰3ä¸ªæ¶ˆæ¯ï¼šview-changeæ¶ˆæ¯ã€view-change-ackæ¶ˆæ¯å’Œnew-viewæ¶ˆæ¯ï¼Œä¸‹æ–‡å›´ç»•è¿™3ä¸ªæ¶ˆæ¯ï¼Œå¯¹ä¸»å‰¯èŠ‚ç‚¹çš„äº¤äº’æµç¨‹åšè¯¦ç»†ä»‹ç»ã€‚</p><h3 id="view-changeæ¶ˆæ¯é˜¶æ®µ"><a href="#view-changeæ¶ˆæ¯é˜¶æ®µ" class="headerlink" title="view-changeæ¶ˆæ¯é˜¶æ®µ"></a>view-changeæ¶ˆæ¯é˜¶æ®µ</h3><p>åœ¨view væ—¶ï¼Œå‰¯æœ¬èŠ‚ç‚¹æ€€ç–‘ä¸»èŠ‚ç‚¹faultæ—¶ï¼Œä¼šå‘é€view-changeæ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯åŒ…å«ï¼š</p><ol><li>hï¼šå‰¯æœ¬iæœ€æ–°çš„ç¨³å®šæ£€æŸ¥ç‚¹åºå·</li><li>Cï¼šå‰¯æœ¬iä¿å­˜çš„hä¹‹åçš„ï¼ˆéç¨³å®šï¼‰æ£€æŸ¥ç‚¹</li><li>På’ŒQ</li><li>iï¼šå‰¯æœ¬i</li><li>Î±ï¼šå‰¯æœ¬iå¯¹æœ¬æ¶ˆæ¯çš„æ•°å­—ç­¾å</li></ol><p>På’ŒQæ˜¯2ä¸ªé›†åˆã€‚</p><p>Pæ˜¯å·²ç»Preparedæ¶ˆæ¯çš„ä¿¡æ¯é›†åˆï¼šæ¶ˆæ¯æ—¢ç„¶å·²ç»Preparedï¼Œè¯´æ˜<strong>è‡³å°‘2f+1çš„èŠ‚ç‚¹æ‹¥æœ‰äº†æ¶ˆæ¯ï¼Œå¹¶ä¸”è®¤å¯<code>&lt;view, n, d&gt;</code></strong>ï¼Œå³ä¸ºæ¶ˆæ¯åˆ†é…çš„viewå’Œåºå·ï¼Œåªæ˜¯è¿˜å·®ä¸€æ­¥commité˜¶æ®µå°±å¯ä»¥å®Œæˆä¸€è‡´æ€§ç¡®è®¤ã€‚Pä¸­åŒ…å«çš„å°±æ˜¯å·²ç»è¾¾åˆ°Preparedçš„æ¶ˆæ¯çš„æ‘˜è¦dï¼Œæ— éœ€åŒ…å«å®Œæ•´çš„è¯·æ±‚æ¶ˆæ¯ã€‚æ–°çš„viewä¸­ï¼Œè¿™äº›è¯·æ±‚ä¼šä½¿ç”¨è€çš„åºå·nï¼Œè€Œæ— éœ€åˆ†é…æ–°çš„åºå·ã€‚</p><p>Qæ˜¯å·²ç»Pre-preparedæ¶ˆæ¯çš„ä¿¡æ¯é›†åˆï¼Œä¸»èŠ‚ç‚¹å·²ç»å‘é€Pre-prepareæˆ–å‰¯æœ¬èŠ‚ç‚¹iä¸ºè¯·æ±‚å·²ç»å‘é€Prepareæ¶ˆæ¯ï¼Œè¯æ˜<strong>è¯¥èŠ‚ç‚¹è®¤å¯<code>&lt;n, d, v&gt;</code></strong>ã€‚</p><p>Pã€Qä¸­çš„è¯·æ±‚éƒ½æ˜¯é«˜ä½æ°´ä½ä¹‹é—´çš„ï¼Œæ— View Changesæ—¶ï¼ŒPã€Qéƒ½æ˜¯ç©ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒ…å«å·²ç»committedçš„è¯·æ±‚ã€‚new-viewæ¶ˆæ¯ä¸­çš„æ•°æ®ï¼ˆView Changesçš„å†³ç­–ç»“æœï¼‰ï¼Œéƒ½æ˜¯åŸºäºPã€Qé›†åˆè®¡ç®—å‡ºçš„ã€‚</p><p>åœ¨å‘é€view-changeæ¶ˆæ¯å‰ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šåˆ©ç”¨æ—¥å¿—ä¸­çš„ä¸‰é˜¶æ®µæ¶ˆæ¯è®¡ç®—Pã€Qé›†åˆï¼Œå‘é€view-changeæ¶ˆæ¯åï¼Œå°±åˆ é™¤æ—¥å¿—ä¸­çš„ä¸‰é˜¶æ®µæ¶ˆæ¯ã€‚</p><h3 id="view-change-ackæ¶ˆæ¯é˜¶æ®µ"><a href="#view-change-ackæ¶ˆæ¯é˜¶æ®µ" class="headerlink" title="view-change-ackæ¶ˆæ¯é˜¶æ®µ"></a>view-change-ackæ¶ˆæ¯é˜¶æ®µ</h3><p>è§†å›¾<code>v+1</code>çš„ä¸»èŠ‚ç‚¹åœ¨æ”¶åˆ°å…¶ä»–èŠ‚ç‚¹å‘é€çš„view-changeæ¶ˆæ¯åï¼Œå¹¶ä¸ç¡®è®¤view-changeæ¶ˆæ¯æ˜¯æ˜¯å¦æ‹œå åº­èŠ‚ç‚¹å‘å‡ºçš„ï¼Œå³ä¸ç¡®å®šæ¶ˆæ¯æ˜¯å¦æ˜¯æ­£ç¡®æ— è¯¯çš„ï¼Œå¦‚æœåŸºäºé”™è¯¯çš„æ¶ˆæ¯åšå†³ç­–ï¼Œå°±ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœï¼Œè¿åä¸€è‡´æ€§ï¼šä¸€åˆ‡æ“ä½œéƒ½æ˜¯æ­£ç¡®çš„ã€‚</p><p>è®¾ç½®view-change-ackæ¶ˆæ¯çš„ç›®çš„æ˜¯ï¼Œè®©æ‰€æœ‰å‰¯æœ¬èŠ‚ç‚¹å¯¹æ‰€æœ‰å®ƒæ”¶åˆ°çš„view-changeæ¶ˆæ¯è¿›è¡Œæ£€æŸ¥å’Œç¡®è®¤ï¼Œåªä¸è¿‡ç¡®è®¤çš„ç»“æœéƒ½å‘é€ç»™æ–°çš„ä¸»èŠ‚ç‚¹ã€‚ä¸»èŠ‚ç‚¹ç»Ÿè®¡ackæ¶ˆæ¯ï¼Œå¯ä»¥è¾¨åˆ«å“ªäº›view-changeæ˜¯æ­£ç¡®çš„ï¼Œå“ªäº›æ˜¯æ‹œå åº­èŠ‚ç‚¹å‘å‡ºçš„ã€‚</p><p>å‰¯æœ¬èŠ‚ç‚¹ä¼šå¯¹view-changeæ¶ˆæ¯ä¸­çš„Pã€Qé›†åˆè¿›è¡Œæ£€æŸ¥ï¼Œè¦æ±‚é›†åˆä¸­çš„è¯·æ±‚æ¶ˆæ¯å°äºç­‰äºè§†å›¾<code>v</code>ï¼Œæ»¡è¶³åˆ™å‘é€view-change-ackæ¶ˆæ¯ï¼š</p><ol><li>vï¼šv+1</li><li>iï¼šå‘é€ackæ¶ˆæ¯çš„å‰¯æœ¬åºå·</li><li>jï¼šå‰¯æœ¬iè¦ç¡®è®¤çš„view-changeæ¶ˆæ¯çš„å‘é€æ–¹</li><li>dï¼šå‰¯æœ¬iè¦ç¡®è®¤çš„view-changeæ¶ˆæ¯çš„æ‘˜è¦</li><li>Î¼ipï¼šiå‘ä¸»èŠ‚ç‚¹på‘é€æ¶ˆæ¯çš„é€šä¿¡å¯†é’¥è®¡ç®—å‡ºçš„MACï¼Œè¿™é‡Œéœ€è¦ä¿è¯iå’Œpä¹‹é—´é€šä¿¡çš„ç§å¯†æ€§ï¼Œæ‰€ä»¥ä¸ä½¿ç”¨æ•°å­—ç­¾å</li></ol><h3 id="new-viewæ¶ˆæ¯é˜¶æ®µ"><a href="#new-viewæ¶ˆæ¯é˜¶æ®µ" class="headerlink" title="new-viewæ¶ˆæ¯é˜¶æ®µ"></a>new-viewæ¶ˆæ¯é˜¶æ®µ</h3><p>æ–°è§†å›¾ä¸»èŠ‚ç‚¹pè´Ÿè´£åŸºäºview-changeæ¶ˆæ¯åšå†³ç­–ï¼Œå†³ç­–æ”¾åˆ°new-viewæ¶ˆæ¯ä¸­ã€‚</p><p>ä¸»èŠ‚ç‚¹pç»´æŠ¤äº†ä¸€ä¸ªé›†åˆSï¼Œç”¨æ¥å­˜æ”¾æ­£ç¡®çš„view-changeæ¶ˆæ¯ã€‚åªæœ‰view-changeæ¶ˆæ¯ï¼Œä»¥åŠä¸ºè¯¥æ¶ˆæ¯èƒŒä¹¦çš„view-change-ackæ¶ˆæ¯è¾¾åˆ°<code>2f-1</code>ä¸ªæ—¶ï¼Œview-changeæ¶ˆæ¯æ‰èƒ½åŠ å…¥åˆ°é›†åˆSï¼Œä½†view-change-ackæ¶ˆæ¯ä¸åŠ å…¥é›†åˆSã€‚</p><p>å½“é›†åˆSçš„å¤§å°è¾¾åˆ°<code>2f+1</code>æ—¶ï¼Œè¯æ˜æœ‰è¶³å¤Ÿå¤šçš„éæ‹œå åº­èŠ‚ç‚¹è®¤ä¸ºéœ€è¦è¿›è¡Œè§†å›¾å˜æ›´ï¼Œå¹¶æä¾›äº†å˜æ›´çš„ä¾æ®ï¼š2f+1ä¸ªview-changeæ¶ˆæ¯ï¼Œä¸»èŠ‚ç‚¹pä½¿ç”¨Såšå†³ç­–ã€‚ä»¥ä¸‹ä¾¿æ˜¯<strong>å†³ç­–é€»è¾‘</strong>ã€‚</p><p>ä¸»èŠ‚ç‚¹på…ˆç¡®å®šhï¼šæ‰€æœ‰view-changeæ¶ˆæ¯ä¸­æœ€å¤§çš„ç¨³å®šæ£€æŸ¥ç‚¹ã€‚hå’Œh+Lå…¶å®å°±æ˜¯é«˜ä½æ°´ä½ã€‚</p><p>ç„¶åä¾æ¬¡æ£€æŸ¥håˆ°h+Lä¸­çš„æ¯ä¸€ä¸ªåºå·nï¼Œå¯¹åºå·nå¯¹äºçš„è¯·æ±‚è¿›è¡Œçš„å¤„ç†ä¸ºï¼šè¯·æ±‚må·²ç»Preparedå¹¶ä¸”Pre-preparedï¼Œåˆ™æ”¶é›†åºå·nå¯¹åº”çš„è¯·æ±‚ã€‚å¦åˆ™ï¼Œè¯´æ˜æ²¡æœ‰è¯·æ±‚åœ¨åºå·nèƒ½è¾¾åˆ°committedï¼Œä¸ºåºå·nåˆ†é…ä¸€ä¸ªç©ºè¯·æ±‚ï¼Œå¹¶æ”¶é›†èµ·æ¥ã€‚å®ƒä»¬æœ€åä¼šè¢«æ”¾åˆ°new-viewæ¶ˆæ¯çš„Xé›†åˆä¸­ã€‚</p><p>ä¸»èŠ‚ç‚¹ä¼šåˆ›å»ºnew-viewæ¶ˆæ¯ï¼š</p><ul><li>viewï¼šå½“å‰æ–°è§†å›¾çš„ç¼–å·</li><li>Vï¼šæ˜¯ä¸€ä¸ªé›†åˆï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€å¯¹<code>(i, d)</code>ï¼Œä»£è¡¨iå‘é€çš„view-changeæ¶ˆæ¯æ‘˜è¦æ˜¯dï¼Œæ¯ä¸€å¯¹éƒ½ä¸é›†åˆSä¸­æ¶ˆæ¯å¯¹åº”ï¼Œå¯ä»¥ä½¿ç”¨Vè¯æ˜ä¸»èŠ‚ç‚¹æ˜¯åœ¨æ»¡è¶³æ¡ä»¶ä¸‹ï¼Œåˆ›å»ºnew-viewæ¶ˆæ¯çš„ï¼Œå³Væ˜¯æ–°è§†å›¾çš„è¯æ˜ã€‚å› ä¸ºå…¶å®ƒå¤šæ•°å‰¯æœ¬èŠ‚ç‚¹å·²ç»æ¥æ”¶view-changeæ¶ˆæ¯ï¼Œæ‰€ä»¥æ­¤å¤„å‘é€æ¶ˆæ¯çš„æ‘˜è¦åšå¯¹æ¯”å³å¯ã€‚</li><li>Xï¼šæ˜¯ä¸€ä¸ªé›†åˆï¼ŒåŒ…å«æ£€æŸ¥ç‚¹ä»¥åŠé€‰å®šçš„è¯·æ±‚</li><li>Î±ï¼šä¸»èŠ‚ç‚¹på¯¹new-viewæ¶ˆæ¯çš„æ•°å­—ç­¾å</li></ul><p>ä¹‹åï¼Œä¸»èŠ‚ç‚¹ä¼šæŠŠnew-viewæ¶ˆæ¯å¹¿æ’­ç»™æ¯ä¸€ä¸ªå‰¯æœ¬èŠ‚ç‚¹ã€‚</p><h3 id="å¤„ç†new-viewæ¶ˆæ¯"><a href="#å¤„ç†new-viewæ¶ˆæ¯" class="headerlink" title="å¤„ç†new-viewæ¶ˆæ¯"></a>å¤„ç†new-viewæ¶ˆæ¯</h3><h4 id="ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"><a href="#ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯" class="headerlink" title="ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"></a>ä¸»èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯</h4><p>åœ¨å‘ç”ŸView Changesæ—¶ï¼Œä¸»èŠ‚ç‚¹çš„çŠ¶æ€å¯èƒ½ä¹Ÿä¸æ˜¯æœ€å…¨çš„ï¼Œå¦‚æœå®ƒæ²¡æœ‰Xç»“åˆä¸­çš„è¯·æ±‚æˆ–è€…æ£€æŸ¥ç‚¹ï¼Œå®ƒå¯ä»¥ä»å…¶ä»–èŠ‚ç‚¹å“ªæ‹‰å»ã€‚</p><p>ä¸»èŠ‚ç‚¹éœ€è¦ä½¿ç”¨new-viewæ¶ˆæ¯ï¼Œè¾¾åˆ°è§†å›¾åˆ‡æ¢çš„æœ€åä¸€æ­¥çŠ¶æ€ï¼šåœ¨æ–°è§†å›¾v+1ä¸­ï¼Œè®©é›†åˆXä¸­çš„è¯·æ±‚ï¼Œå…¨éƒ¨æ˜¯Pre-preparedçŠ¶æ€ã€‚ä¸ºä½•æ˜¯Pre-preparedçŠ¶æ€å‘¢ï¼Ÿå› ä¸ºnew-viewæ¶ˆæ¯ï¼Œå¯ä»¥çœ‹åšä¸€æ¬¡ç‰¹æ®Šçš„Pre-prepareæ¶ˆæ¯ã€‚</p><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥æ ‡è®°ä¸ºCommittedå‘¢ï¼Ÿå› ä¸ºä¸»èŠ‚ç‚¹ä¹Ÿå¯èƒ½æ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼Œå‰¯æœ¬èŠ‚ç‚¹éœ€è¦æ£€æŸ¥new-viewæ¶ˆæ¯ï¼Œå‘æ‰€æœ‰èŠ‚ç‚¹å¹¿æ’­è‡ªå·±æ£€æŸ¥çš„ç»“æœï¼Œæ»¡è¶³æ¡ä»¶åæ‰èƒ½è¾¾æˆä¸€è‡´æ€§ã€‚</p><h4 id="å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"><a href="#å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯" class="headerlink" title="å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯"></a>å‰¯æœ¬èŠ‚ç‚¹å¤„ç†new-viewæ¶ˆæ¯</h4><p>å‰¯æœ¬èŠ‚ç‚¹åœ¨è§†å›¾v+1ï¼Œä¼šæŒç»­æ¥æ”¶view-changeæ¶ˆæ¯å’Œnew-viewæ¶ˆæ¯ï¼Œå®ƒä¼šæŠŠnew-viewæ¶ˆæ¯Vé›†åˆä¸­çš„view-changeæ¶ˆæ¯ï¼Œè·Ÿå®ƒæ”¶åˆ°çš„æ¶ˆæ¯åšå¯¹æ¯”ï¼Œå¦‚æœå®ƒæœ¬åœ°ä¸å­˜åœ¨æŸæ¡view-changeæ¶ˆæ¯ï¼Œå®ƒå¯ä»¥è¦æ±‚ä¸»èŠ‚ç‚¹å‘ä»–æä¾›view-changeæ¶ˆæ¯å’Œview-change-ackæ¶ˆæ¯é›†åˆï¼Œè¯æ˜è‡³å°‘f+1ä¸ªéæ‹œå åº­å‰¯æœ¬èŠ‚ç‚¹æ”¶åˆ°è¿‡æ­¤view-changeæ¶ˆæ¯ã€‚</p><p>å‰¯æœ¬èŠ‚ç‚¹æ‹¥æœ‰æ‰€æœ‰çš„view-changeæ¶ˆæ¯ä¹‹åï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šå’Œä¸»èŠ‚ç‚¹è¿è¡Œç›¸åŒçš„å†³ç­–é€»è¾‘ï¼Œä»¥æ ¡éªŒnew-viewæ¶ˆæ¯çš„æ­£ç¡®æ€§ã€‚</p><p>å¦‚æœnew-viewæ¶ˆæ¯æ˜¯æ­£ç¡®çš„ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šå’Œä¸»èŠ‚ç‚¹ä¸€æ ·ç§»åŠ¨åˆ°ç›¸åŒçš„çŠ¶æ€ï¼Œç„¶åå¹¿æ’­ä¸€æ¡Prepareæ¶ˆæ¯ç»™æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¿™æ ·å°±æ¢å¤åˆ°äº†æ­£å¸¸æƒ…å†µä¸‹çš„ï¼š<code>Pre-prepare -&gt; Prepare -&gt; Commit</code> ä¸€è‡´æ€§é€»è¾‘ã€‚è¿™æ ·å°±å®Œæˆäº†ä»View Changesåˆ°æ­£å¸¸å¤„ç†æµç¨‹çš„è¿ç§»ã€‚</p><p>å¦‚æœnew-viewæ¶ˆæ¯æ˜¯é”™è¯¯çš„ï¼Œè¯´æ˜ä¸»èŠ‚ç‚¹pæ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šç›´æ¥è¿›å…¥v+2ï¼Œå‘é€view-changeæ¶ˆæ¯ï¼Œè¿›è¡Œæ–°çš„ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</p><h3 id="View-Changeså¦‚ä½•æä¾›liveness"><a href="#View-Changeså¦‚ä½•æä¾›liveness" class="headerlink" title="View Changeså¦‚ä½•æä¾›liveness"></a>View Changeså¦‚ä½•æä¾›liveness</h3><p>åœ¨ä¸€è½®è§†å›¾åˆ‡æ¢æ— æ³•å®Œæˆçš„æ—¶å€™ï¼Œä¼šå¼€å¯æ–°çš„ä¸€è½®è§†å›¾åˆ‡æ¢ï¼Œç”±äºæ‹œå åº­èŠ‚ç‚¹çš„æ•°é‡æœ€å¤šä¸ºfä¸ªï¼Œæœ€ç»ˆä¼šåœ¨æŸä¸€è½®è§†å›¾åˆ‡æ¢ä¸­ï¼Œèƒ½å¤Ÿå®Œæˆè§†å›¾åˆ‡æ¢ï¼Œæ‰€æœ‰éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´çš„çŠ¶æ€ï¼Œä¿è¯livenesså’Œsafetyã€‚</p><p>æœ¬æ–‡å‰é¢åˆ—å‡ºäº†å‡ ç§å¼‚å¸¸æƒ…å†µï¼Œä¸‹é¢å°±çœ‹ä¸€ä¸‹View Changesæ˜¯å¦‚ä½•åº”å¯¹è¿™äº›å¼‚å¸¸æƒ…å†µçš„ï¼Œä»¥åŠå¦‚ä½•æä¾›æ´»æ€§ã€‚</p><p>Q1ï¼šå¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹å®•æœºäº†æ€ä¹ˆåŠï¼Ÿ</p><p>A1ï¼šå‰¯æœ¬èŠ‚ç‚¹åœ¨æ”¶é›†åˆ°2f+1ä¸ªview-changeæ¶ˆæ¯åï¼Œä¼šå¯åŠ¨å®šæ—¶å™¨ï¼Œè¶…æ—¶æ—¶é—´ä¸ºTï¼Œæ–°viewçš„ä¸»èŠ‚ç‚¹å®•æœºï¼Œå¿…ç„¶ä¼šå¯¼è‡´å®šæ—¶å™¨è¶…æ—¶æ—¶ï¼Œæœªèƒ½å®ŒæˆView Changesæµç¨‹ï¼Œä¼šè¿›å…¥æ–°ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</p><p>Q2ï¼šå¦‚æœä¸‹ä¸€ä¸ªViewçš„ä¸»èŠ‚ç‚¹æ˜¯æ¶æ„èŠ‚ç‚¹ï¼Œä½œæ¶æ€ä¹ˆåŠï¼Ÿ</p><p>A2ï¼šæ–°viewçš„ä¸»èŠ‚ç‚¹æ˜¯æ¶æ„èŠ‚ç‚¹ï¼Œå¦‚æœå®ƒåšæ¶äº†ï¼Œç”Ÿæˆçš„new-viewæ¶ˆæ¯ä¸åˆæ³•ï¼Œå‰¯æœ¬èŠ‚ç‚¹å¯ä»¥æ£€æµ‹å‡ºæ¥ã€‚æˆ–è€…new-viewæ¶ˆæ¯æ˜¯åˆæ³•çš„ï¼Œä½†å®ƒåªå‘é€ç»™äº†å°‘æ•°å‰¯æœ¬èŠ‚ç‚¹ï¼Œå‰¯æœ¬èŠ‚ç‚¹åœ¨å¯¹new-viewæ¶ˆæ¯è¿›è¡Œæ­£å¸¸çš„3é˜¶æ®µæµç¨‹ï¼Œå‚ä¸çš„èŠ‚ç‚¹å¤ªå°‘ï¼Œåœ¨å®šæ—¶å™¨è¶…æ—¶å‰ï¼Œä¸è¶³ä»¥å®Œæˆ3é˜¶æ®µæµç¨‹ï¼Œå‰¯æœ¬èŠ‚ç‚¹ä¼šè¿›å…¥ä¸‹ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</p><p>Q3ï¼šå¦‚æœéæ‹œå åº­æ¶æ„å‘èµ·View Changesï¼Œé€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢æ€ä¹ˆåŠï¼Ÿ</p><p>A3ï¼šå®šæ—¶å™¨æœªè¶…æ—¶æƒ…å†µä¸‹ï¼Œåªæœ‰æœ‰æ•ˆçš„f+1ä¸ªview-changeæ¶ˆæ¯ï¼Œæ‰ä¼šå¼•å‘å…¶ä»–å‰¯æœ¬èŠ‚ç‚¹è¿›è¡Œä¸»èŠ‚ç‚¹åˆ‡æ¢ï¼Œå¦åˆ™æ— æ³•é€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢ã€‚ä½†PBFTçš„å‰ææ¡ä»¶æ˜¯æ¶æ„èŠ‚ç‚¹ä¸è¶³fä¸ªï¼Œæ‰€ä»¥åªæœ‰æ¶æ„èŠ‚ç‚¹å‘èµ·view-changeæ¶ˆæ¯æ—¶ï¼Œæ— æ³•é€ æˆä¸»èŠ‚ç‚¹åˆ‡æ¢ã€‚</p><p>Q4ï¼šå¦‚æœå‚ä¸View Changesçš„èŠ‚ç‚¹æ•°é‡ä¸è¶³æ€ä¹ˆåŠï¼Ÿ</p><p>A4ï¼šè¿™ä¸ªé—®é¢˜å¯ä»¥åˆ†å‡ ç§æƒ…å†µã€‚</p><ul><li>å‘èµ·view-changeçš„èŠ‚ç‚¹æ•°é‡ä¸è¶³f+1ä¸ªï¼Œè¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿæ•´ä¸ªé›†ç¾¤çš„è§†å›¾åˆ‡æ¢ã€‚</li><li>è§†å›¾åˆ‡æ¢è¿‡ç¨‹ä¸­ï¼Œä¸æ»¡è¶³å„èŠ‚ç‚¹çš„æ•°é‡è¦æ±‚ï¼Œæ— æ³•å®Œæˆæœ¬è½®è§†å›¾åˆ‡æ¢ï¼Œä¼šè¿›å…¥ä¸‹ä¸€è½®è§†å›¾åˆ‡æ¢ã€‚</li></ul><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>View Changesæ˜¯PBFTä¸­ä¸€ä¸ªé‡è¦çš„ç¯èŠ‚ï¼Œå®ƒèƒ½ä¿è¯æ•´ä¸ªåè®®çš„livenessï¼Œæ˜¯PBFTä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;åœ¨å½“å‰çš„PBFTèµ„æ–™ä¸­ï¼Œå°¤å…¶æ˜¯ä¸­æ–‡èµ„æ–™ï¼Œå¤šæ•°éƒ½åœ¨ä»‹ç»PBFTçš„3é˜¶æ®µæ¶ˆæ¯è¿‡ç¨‹ï¼Œå¾ˆå°‘æåŠView Changesï¼ˆè§†å›¾åˆ‡æ¢ï¼‰ï¼ŒView Cha
      
    
    </summary>
    
    
    
      <category term="ä¸€è‡´æ€§" scheme="http://lessisbetter.site/tags/%E4%B8%80%E8%87%B4%E6%80%A7/"/>
    
      <category term="åŒºå—é“¾" scheme="http://lessisbetter.site/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="PBFT" scheme="http://lessisbetter.site/tags/PBFT/"/>
    
      <category term="å…±è¯†ç®—æ³•" scheme="http://lessisbetter.site/tags/%E5%85%B1%E8%AF%86%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Goå®˜æ–¹è¿›ç¨‹è¯Šæ–­å·¥å…·gopsè¯¦è§£</title>
    <link href="http://lessisbetter.site/2020/03/15/gops-introduction/"/>
    <id>http://lessisbetter.site/2020/03/15/gops-introduction/</id>
    <published>2020-03-15T12:20:47.000Z</published>
    <updated>2020-03-17T09:50:48.528Z</updated>
    
    <content type="html"><![CDATA[<h2 id="gopsç®€ä»‹"><a href="#gopsç®€ä»‹" class="headerlink" title="gopsç®€ä»‹"></a>gopsç®€ä»‹</h2><p><a href="https://github.com/google/gops" target="_blank" rel="noopener">gops</a> æ˜¯Goå›¢é˜Ÿæä¾›çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥ç”¨æ¥è·å–goè¿›ç¨‹è¿è¡Œæ—¶ä¿¡æ¯ã€‚</p><p>å¯ä»¥æŸ¥çœ‹ï¼š</p><ul><li>å½“å‰æœ‰å“ªäº›goè¯­è¨€è¿›ç¨‹ï¼Œå“ªäº›ä½¿ç”¨gopsçš„goè¿›ç¨‹</li><li>è¿›ç¨‹çš„æ¦‚è¦ä¿¡æ¯</li><li>è¿›ç¨‹çš„è°ƒç”¨æ ˆ</li><li>è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µ</li><li>æ„å»ºç¨‹åºçš„Goç‰ˆæœ¬</li><li>è¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯</li></ul><p>å¯ä»¥è·å–ï¼š</p><ul><li>trace</li><li>cpu profileå’Œmemory profile</li></ul><p>è¿˜å¯ä»¥ï¼š</p><ul><li>è®©è¿›ç¨‹è¿›è¡Œ1æ¬¡GC</li><li>è®¾ç½®GCç™¾åˆ†æ¯”</li></ul><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><p>ä½¿ç”¨<code>Options</code>é…ç½®agentã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"log"</span></span><br><span class="line"><span class="string">"runtime"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"github.com/google/gops/agent"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> err := agent.Listen(agent.Options&#123;</span><br><span class="line">Addr:            <span class="string">"0.0.0.0:8848"</span>,</span><br><span class="line"><span class="comment">// ConfigDir:       "/home/centos/gopsconfig", // æœ€å¥½ä½¿ç”¨é»˜è®¤</span></span><br><span class="line">ShutdownCleanup: <span class="literal">true</span>&#125;); err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æµ‹è¯•ä»£ç </span></span><br><span class="line">_ = <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">1000</span>, <span class="number">1000</span>)</span><br><span class="line">runtime.GC()</span><br><span class="line"></span><br><span class="line">_ = <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">1000</span>, <span class="number">2000</span>)</span><br><span class="line">runtime.GC()</span><br><span class="line"></span><br><span class="line">time.Sleep(time.Hour)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="agent-Optioné€‰é¡¹"><a href="#agent-Optioné€‰é¡¹" class="headerlink" title="agent Optioné€‰é¡¹"></a>agent Optioné€‰é¡¹</h2><p>agentæœ‰3ä¸ªé…ç½®ï¼š</p><ul><li><code>Addr</code>ï¼šagentè¦ç›‘å¬çš„ipå’Œç«¯å£ï¼Œé»˜è®¤ipä¸ºç¯å›åœ°å€ï¼Œç«¯å£éšæœºåˆ†é…ã€‚</li><li><code>ConfigDir</code>ï¼šè¯¥ç›®å½•å­˜æ”¾çš„ä¸æ˜¯agentçš„é…ç½®ï¼Œè€Œæ˜¯æ¯ä¸€ä¸ªä½¿ç”¨äº†agentçš„goè¿›ç¨‹ä¿¡æ¯ï¼Œæ–‡ä»¶ä»¥pidå‘½åï¼Œå†…å®¹æ˜¯è¯¥pidè¿›ç¨‹æ‰€ç›‘å¬çš„ç«¯å£å·ï¼Œæ‰€ä»¥å…¶ä¸­æ–‡ä»¶çš„ç›®çš„æ˜¯å½¢æˆpidåˆ°ç«¯å£çš„æ˜ å°„ã€‚é»˜è®¤å€¼ä¸º<code>~/.config/gops</code></li><li><code>ShutdownCleanup</code>ï¼šè¿›ç¨‹é€€å‡ºæ—¶ï¼Œæ˜¯å¦æ¸…ç†ConfigDirä¸­çš„æ–‡ä»¶ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼Œä¸æ¸…ç†</li></ul><p>é€šå¸¸å¯ä»¥æŠŠ<code>Addr</code>è®¾ç½®ä¸ºè¦ç›‘å¬çš„IPï¼ŒæŠŠ<code>ShutdownCleanup</code>è®¾ç½®ä¸º<code>ture</code>ï¼Œè¿›ç¨‹é€€å‡ºåï¼Œæ®‹ç•™åœ¨ConfigDirç›®å½•çš„æ–‡ä»¶ä¸å†æœ‰ç”¨ï¼Œæœ€å¥½æ¸…é™¤æ‰ã€‚</p><p><code>ConfigDir</code>ç¤ºä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// gopsconfigä¸ºè®¾ç½®çš„ConfigDirç›®å½•ï¼Œ2051ä¸ºpidï¼Œ8848ä¸ºç«¯å£å·ã€‚</span><br><span class="line">âœ  ~ cat gopsconfig/2051</span><br><span class="line">8848%</span><br><span class="line">âœ  ~ netstat -nap | grep `pgrep gopsexample`</span><br><span class="line">tcp6       0      0 :::8848                 :::*                    LISTEN      2051/./gopsexample</span><br></pre></td></tr></table></figure><h2 id="gopsåŸç†"><a href="#gopsåŸç†" class="headerlink" title="gopsåŸç†"></a>gopsåŸç†</h2><p>gopsçš„åŸç†æ˜¯ï¼Œä»£ç ä¸­å¯¼å…¥<code>gops/agent</code>ï¼Œå»ºç«‹agentæœåŠ¡ï¼Œgopså‘½ä»¤è¿æ¥<code>agent</code>è¯»å–è¿›ç¨‹ä¿¡æ¯ã€‚</p><p><img src="http://img.lessisbetter.site/2020-03-gops.png" alt="gops"></p><p><code>agent</code>çš„å®ç°åŸç†å¯ä»¥æŸ¥çœ‹<code>agent/handle</code><a href="https://github.com/google/gops/blob/master/agent/agent.go#L182" target="_blank" rel="noopener">å‡½æ•°</a>ã€‚</p><p>ä½¿ç”¨goæ ‡å‡†åº“ä¸­åŸç”Ÿæ¥å£å®ç°ç›¸å…³åŠŸèƒ½ï¼Œå¦‚åŒä½ è¦åœ¨è‡ªå·±çš„ç¨‹åºä¸­å¼€å¯pprofç±»ä¼¼ï¼Œåªä¸è¿‡è¿™éƒ¨åˆ†åŠŸèƒ½ç”±<code>gops/agent</code>å®ç°äº†ï¼š</p><ul><li>ä½¿ç”¨<code>runtime.MemStats</code>è·å–å†…å­˜æƒ…å†µ</li><li>ä½¿ç”¨<code>runtime/pprof</code>è·å–è°ƒç”¨æ ˆã€cpu profileå’Œmemory profile</li><li>ä½¿ç”¨<code>runtime/trace</code>è·å–trace</li><li>ä½¿ç”¨<code>runtime</code>è·å–statsä¿¡æ¯</li><li>ä½¿ç”¨<code>runtime/debug</code>ã€<code>GC</code>è®¾ç½®å’Œå¯åŠ¨GC</li></ul><p>å†è°ˆ<code>ConfigDir</code>ã€‚ä»æºç ä¸Šçœ‹ï¼Œ<code>ConfigDir</code>å¯¹agentå¹¶æ²¡æœ‰ç”¨é€”ï¼Œå¯¹gopsæœ‰ç”¨ã€‚å½“gopså’ŒConfigDiråœ¨ä¸€å°æœºå™¨ä¸Šæ—¶ï¼Œå³gopsæŸ¥çœ‹æœ¬æœºçš„goè¿›ç¨‹ä¿¡æ¯ï¼Œgopså¯ä»¥é€šè¿‡å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿«é€Ÿæ‰¾åˆ°agentæœåŠ¡çš„ç«¯å£ã€‚èƒ½å¤Ÿå®ç°ï¼š<code>gops &lt;sub-cmd&gt; pid</code>åˆ°<code>gops &lt;sub-cmd&gt; 127.0.0.1:port</code>çš„è½¬æ¢ã€‚</p><p>å¦‚æœä»£ç ä¸­é€šè¿‡<code>ConfigDir</code>æŒ‡å®šäº†å…¶ä»–ç›®å½•ï¼Œä½¿ç”¨<code>gops</code>æ—¶ï¼Œéœ€è¦æ·»åŠ ç¯å¢ƒå˜é‡<code>GOPS_CONFIG_DIR</code>æŒ‡å‘<code>ConfigDir</code>ä½¿ç”¨çš„ç›®å½•ã€‚</p><h2 id="å­å‘½ä»¤ä»‹ç»"><a href="#å­å‘½ä»¤ä»‹ç»" class="headerlink" title="å­å‘½ä»¤ä»‹ç»"></a>å­å‘½ä»¤ä»‹ç»</h2><p>gopsåé¢å¯ä»¥è·Ÿå­å‘½ä»¤ï¼Œç„¶åæ˜¯pidæˆ–è€…è¿œç«¯åœ°å€ã€‚</p><p>ä¹Ÿå¯ä»¥ç›´æ¥è·Ÿpidï¼ŒæŸ¥çœ‹æœ¬æœºè¿›ç¨‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops help memstats</span><br><span class="line">gops is a tool to list and diagnose Go processes.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  gops &lt;cmd&gt; &lt;pid|addr&gt; ...</span><br><span class="line">  gops &lt;pid&gt; # displays process info</span><br><span class="line">  gops help  # displays this help message</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  stack      Prints the stack trace.</span><br><span class="line">  gc         Runs the garbage collector and blocks until successful.</span><br><span class="line">  setgc     Sets the garbage collection target percentage.</span><br><span class="line">  memstats   Prints the allocation and garbage collection stats.</span><br><span class="line">  version    Prints the Go version used to build the program.</span><br><span class="line">  stats      Prints runtime stats.</span><br><span class="line">  trace      Runs the runtime tracer for 5 secs and launches &quot;go tool trace&quot;.</span><br><span class="line">  pprof-heap Reads the heap profile and launches &quot;go tool pprof&quot;.</span><br><span class="line">  pprof-cpu  Reads the CPU profile and launches &quot;go tool pprof&quot;.</span><br><span class="line"></span><br><span class="line">All commands require the agent running on the Go process.</span><br><span class="line">&quot;*&quot; indicates the process is running the agent.</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯"><a href="#æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯"></a>æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šgoç¨‹åºè¿›ç¨‹ä¿¡æ¯</h3><p>æŸ¥çœ‹å½“å‰æœºå™¨ä¸Šçš„goè¿›ç¨‹ï¼Œå¯ä»¥åˆ—å‡ºpidã€ppidã€è¿›ç¨‹åã€å¯æ‰§è¡Œç¨‹åºæ‰€ä½¿ç”¨çš„goç‰ˆæœ¬ï¼Œä»¥åŠå¯æ‰§è¡Œç¨‹åºçš„è·¯å¾„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops</span><br><span class="line">67292 66333 gops                         * go1.13    &#x2F;Users&#x2F;shitaibin&#x2F;Workspace&#x2F;golang_step_by_step&#x2F;gops&#x2F;gops</span><br><span class="line">67434 65931 gops                           go1.13    &#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;bin&#x2F;gops</span><br><span class="line">66551 1     gocode                         go1.11.2  &#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;bin&#x2F;gocode</span><br><span class="line">137   1     com.docker.vmnetd              go1.12.7  &#x2F;Library&#x2F;PrivilegedHelperTools&#x2F;com.docker.vmnetd</span><br><span class="line">811   807   com.docker.backend             go1.12.13 &#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.backend</span><br><span class="line">807   746   com.docker.supervisor          go1.12.13 &#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.supervisor</span><br><span class="line">810   807   com.docker.driver.amd64-linux  go1.12.13 &#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.driver.amd64-linux</span><br></pre></td></tr></table></figure><p>å¸¦<code>*</code>çš„æ˜¯ç¨‹åºä¸­ä½¿ç”¨äº†gops/agentï¼Œä¸å¸¦<code>*</code>çš„æ˜¯æ™®é€šçš„goç¨‹åºã€‚</p><h3 id="goç¨‹åºè¿›ç¨‹æ ‘"><a href="#goç¨‹åºè¿›ç¨‹æ ‘" class="headerlink" title="goç¨‹åºè¿›ç¨‹æ ‘"></a>goç¨‹åºè¿›ç¨‹æ ‘</h3><p>æŸ¥çœ‹è¿›ç¨‹æ ‘ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops tree</span><br><span class="line">...</span><br><span class="line">â”œâ”€â”€ 66333</span><br><span class="line">â”‚Â Â  â””â”€â”€ [*]  67292 (gops) &#123;go1.13&#125;</span><br><span class="line">â”œâ”€â”€ 1</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ 66551 (gocode) &#123;go1.11.2&#125;</span><br><span class="line">â”‚Â Â  â””â”€â”€ 137 (com.docker.vmnetd) &#123;go1.12.7&#125;</span><br><span class="line">â”œâ”€â”€ 65931</span><br><span class="line">â”‚Â Â  â””â”€â”€ 67476 (gops) &#123;go1.13&#125;</span><br><span class="line">â””â”€â”€ 746</span><br><span class="line">    â””â”€â”€ 807 (com.docker.supervisor) &#123;go1.12.13&#125;</span><br><span class="line">        â”œâ”€â”€ 811 (com.docker.backend) &#123;go1.12.13&#125;</span><br><span class="line">        â””â”€â”€ 810 (com.docker.driver.amd64-linux) &#123;go1.12.13&#125;</span><br></pre></td></tr></table></figure><h3 id="pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯"><a href="#pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯" class="headerlink" title="pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯"></a>pidï¼šè¿›ç¨‹æ¦‚è¦ä¿¡æ¯</h3><p>æŸ¥çœ‹è¿›ç¨‹çš„æ¦‚è¦ä¿¡æ¯ï¼Œégopsè¿›ç¨‹ä¹Ÿå¯ä»¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops 67292</span><br><span class="line">parent PID:66333</span><br><span class="line">threads:7</span><br><span class="line">memory usage:0.018%</span><br><span class="line">cpu usage:0.000%</span><br><span class="line">username:shitaibin</span><br><span class="line">cmd+args:.&#x2F;gops</span><br><span class="line">elapsed time:11:28</span><br><span class="line">local&#x2F;remote:127.0.0.1:54753 &lt;-&gt; :0 (LISTEN)</span><br><span class="line">âœ  ~</span><br><span class="line">âœ  ~ gops 807</span><br><span class="line">parent PID:746</span><br><span class="line">threads:28</span><br><span class="line">memory usage:0.057%</span><br><span class="line">cpu usage:0.003%</span><br><span class="line">username:shitaibin</span><br><span class="line">cmd+args:&#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;MacOS&#x2F;com.docker.supervisor -watchdog fd:0</span><br><span class="line">elapsed time:27-23:36:35</span><br><span class="line">local&#x2F;remote:127.0.0.1:54832 &lt;-&gt; :0 ()</span><br><span class="line">local&#x2F;remote:*:53849 &lt;-&gt; :0 ()</span><br><span class="line">local&#x2F;remote:127.0.0.1:49473 &lt;-&gt; :0 (LISTEN)</span><br></pre></td></tr></table></figure><h3 id="stackï¼šå½“å‰è°ƒç”¨æ ˆ"><a href="#stackï¼šå½“å‰è°ƒç”¨æ ˆ" class="headerlink" title="stackï¼šå½“å‰è°ƒç”¨æ ˆ"></a>stackï¼šå½“å‰è°ƒç”¨æ ˆ</h3><p>æŸ¥çœ‹ä½¿ç”¨gopsçš„è¿›ç¨‹çš„è°ƒç”¨æ ˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops stack 67292</span><br><span class="line">goroutine 19 [running]:</span><br><span class="line">runtime&#x2F;pprof.writeGoroutineStacks(0x1197160, 0xc00009c028, 0x0, 0x0)</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;pprof&#x2F;pprof.go:679 +0x9d</span><br><span class="line">runtime&#x2F;pprof.writeGoroutine(0x1197160, 0xc00009c028, 0x2, 0x0, 0x0)</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;pprof&#x2F;pprof.go:668 +0x44</span><br><span class="line">runtime&#x2F;pprof.(*Profile).WriteTo(0x1275c60, 0x1197160, 0xc00009c028, 0x2, 0xc00009c028, 0x0)</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;pprof&#x2F;pprof.go:329 +0x3da</span><br><span class="line">github.com&#x2F;google&#x2F;gops&#x2F;agent.handle(0x1665008, 0xc00009c028, 0xc000014068, 0x1, 0x1, 0x0, 0x0)</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;src&#x2F;github.com&#x2F;google&#x2F;gops&#x2F;agent&#x2F;agent.go:185 +0x1ab</span><br><span class="line">github.com&#x2F;google&#x2F;gops&#x2F;agent.listen()</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;src&#x2F;github.com&#x2F;google&#x2F;gops&#x2F;agent&#x2F;agent.go:133 +0x2bf</span><br><span class="line">created by github.com&#x2F;google&#x2F;gops&#x2F;agent.Listen</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;go&#x2F;src&#x2F;github.com&#x2F;google&#x2F;gops&#x2F;agent&#x2F;agent.go:111 +0x364</span><br><span class="line"></span><br><span class="line">goroutine 1 [sleep]:</span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;proc.go:310</span><br><span class="line">time.Sleep(0x34630b8a000)</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;time.go:105 +0x157</span><br><span class="line">main.main()</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;Workspace&#x2F;golang_step_by_step&#x2F;gops&#x2F;example.go:15 +0xa3</span><br><span class="line"></span><br><span class="line">goroutine 18 [syscall]:</span><br><span class="line">os&#x2F;signal.signal_recv(0x0)</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;runtime&#x2F;sigqueue.go:144 +0x96</span><br><span class="line">os&#x2F;signal.loop()</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;os&#x2F;signal&#x2F;signal_unix.go:23 +0x22</span><br><span class="line">created by os&#x2F;signal.init.0</span><br><span class="line">&#x2F;Users&#x2F;shitaibin&#x2F;goroot&#x2F;src&#x2F;os&#x2F;signal&#x2F;signal_unix.go:29 +0x41</span><br></pre></td></tr></table></figure><h3 id="memstats-å†…å­˜ä½¿ç”¨æƒ…å†µ"><a href="#memstats-å†…å­˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="memstats: å†…å­˜ä½¿ç”¨æƒ…å†µ"></a>memstats: å†…å­˜ä½¿ç”¨æƒ…å†µ</h3><p>æŸ¥çœ‹gopsè¿›ç¨‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops memstats 67944</span><br><span class="line">alloc: 136.80KB (140088 bytes) &#x2F;&#x2F; å½“å‰åˆ†é…å‡ºå»æœªæ”¶å›çš„å†…å­˜æ€»é‡</span><br><span class="line">total-alloc: 152.08KB (155728 bytes) &#x2F;&#x2F; å·²åˆ†é…å‡ºå»çš„å†…å­˜æ€»é‡</span><br><span class="line">sys: 67.25MB (70518784 bytes) &#x2F;&#x2F; å½“å‰è¿›ç¨‹ä»OSè·å–çš„å†…å­˜æ€»é‡</span><br><span class="line">lookups: 0</span><br><span class="line">mallocs: 418 &#x2F;&#x2F; åˆ†é…çš„å¯¹è±¡æ•°é‡</span><br><span class="line">frees: 82 &#x2F;&#x2F; é‡Šæ”¾çš„å¯¹è±¡æ•°é‡</span><br><span class="line">heap-alloc: 136.80KB (140088 bytes) &#x2F;&#x2F; å½“å‰åˆ†é…å‡ºå»æœªæ”¶å›çš„å †å†…å­˜æ€»é‡</span><br><span class="line">heap-sys: 63.56MB (66650112 bytes) &#x2F;&#x2F; å½“å‰å †ä»OSè·å–çš„å†…å­˜</span><br><span class="line">heap-idle: 62.98MB (66035712 bytes) &#x2F;&#x2F; å½“å‰å †ä¸­ç©ºé—²çš„å†…å­˜é‡</span><br><span class="line">heap-in-use: 600.00KB (614400 bytes) &#x2F;&#x2F; å½“å‰å †ä½¿ç”¨ä¸­çš„å†…å­˜é‡</span><br><span class="line">heap-released: 62.89MB (65945600 bytes)</span><br><span class="line">heap-objects: 336 &#x2F;&#x2F; å †ä¸­å¯¹è±¡æ•°é‡</span><br><span class="line">stack-in-use: 448.00KB (458752 bytes) &#x2F;&#x2F; æ ˆä½¿ç”¨ä¸­çš„å†…å­˜é‡ </span><br><span class="line">stack-sys: 448.00KB (458752 bytes) &#x2F;&#x2F; æ ˆä»OSè·å–çš„å†…å­˜æ€»é‡ </span><br><span class="line">stack-mspan-inuse: 10.89KB (11152 bytes)</span><br><span class="line">stack-mspan-sys: 16.00KB (16384 bytes)</span><br><span class="line">stack-mcache-inuse: 13.56KB (13888 bytes)</span><br><span class="line">stack-mcache-sys: 16.00KB (16384 bytes)</span><br><span class="line">other-sys: 1.01MB (1062682 bytes)</span><br><span class="line">gc-sys: 2.21MB (2312192 bytes)</span><br><span class="line">next-gc: when heap-alloc &gt;&#x3D; 4.00MB (4194304 bytes) &#x2F;&#x2F; ä¸‹æ¬¡GCçš„æ¡ä»¶</span><br><span class="line">last-gc: 2020-03-16 10:06:26.743193 +0800 CST &#x2F;&#x2F; ä¸Šæ¬¡GCçš„ä¸–ç•Œ</span><br><span class="line">gc-pause-total: 83.84Âµs &#x2F;&#x2F; GCæ€»æš‚åœæ—¶é—´</span><br><span class="line">gc-pause: 44891 &#x2F;&#x2F; ä¸Šæ¬¡GCæš‚åœæ—¶é—´ï¼Œå•ä½çº³ç§’</span><br><span class="line">num-gc: 2 &#x2F;&#x2F; å·²è¿›è¡Œçš„GCæ¬¡æ•°</span><br><span class="line">enable-gc: true &#x2F;&#x2F; æ˜¯å¦å¼€å§‹GC</span><br><span class="line">debug-gc: false</span><br></pre></td></tr></table></figure><h3 id="stats-è¿è¡Œæ—¶ä¿¡æ¯"><a href="#stats-è¿è¡Œæ—¶ä¿¡æ¯" class="headerlink" title="stats: è¿è¡Œæ—¶ä¿¡æ¯"></a>stats: è¿è¡Œæ—¶ä¿¡æ¯</h3><p>æŸ¥çœ‹è¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops stats 68125</span><br><span class="line">goroutines: 3</span><br><span class="line">OS threads: 12</span><br><span class="line">GOMAXPROCS: 8</span><br><span class="line">num CPU: 8</span><br></pre></td></tr></table></figure><h3 id="trace"><a href="#trace" class="headerlink" title="trace"></a>trace</h3><p>è·å–å½“å‰è¿è¡Œ5sçš„traceä¿¡æ¯ï¼Œä¼šæ‰“å¼€ç½‘é¡µï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops trace 68125</span><br><span class="line">Tracing now, will take 5 secs...</span><br><span class="line">Trace dump saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;trace116447431</span><br><span class="line">2020&#x2F;03&#x2F;16 10:23:37 Parsing trace...</span><br><span class="line">2020&#x2F;03&#x2F;16 10:23:37 Splitting trace...</span><br><span class="line">2020&#x2F;03&#x2F;16 10:23:37 Opening browser. Trace viewer is listening on http:&#x2F;&#x2F;127.0.0.1:55480</span><br></pre></td></tr></table></figure><h3 id="cpu-profile"><a href="#cpu-profile" class="headerlink" title="cpu profile"></a>cpu profile</h3><p>è·å–cpu profileï¼Œå¹¶è¿›å…¥äº¤äº’æ¨¡å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops pprof-cpu 68125</span><br><span class="line">Profiling CPU now, will take 30 secs...</span><br><span class="line"></span><br><span class="line">Profile dump saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;profile431166544</span><br><span class="line">Binary file saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;binary765361519</span><br><span class="line">File: binary765361519</span><br><span class="line">Type: cpu</span><br><span class="line">Time: Mar 16, 2020 at 10:25am (CST)</span><br><span class="line">Duration: 30s, Total samples &#x3D; 0</span><br><span class="line">No samples were found with the default sample value type.</span><br><span class="line">Try &quot;sample_index&quot; command to analyze different sample values.</span><br><span class="line">Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)</span><br><span class="line">(pprof)</span><br><span class="line">(pprof) top</span><br><span class="line">Showing nodes accounting for 0, 0% of 0 total</span><br><span class="line">      flat  flat%   sum%        cum   cum%</span><br></pre></td></tr></table></figure><h3 id="memory-profile"><a href="#memory-profile" class="headerlink" title="memory profile"></a>memory profile</h3><p>è·å–memory profileï¼Œå¹¶è¿›å…¥äº¤äº’æ¨¡å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops pprof-heap 68125</span><br><span class="line">Profile dump saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;profile292136242</span><br><span class="line">Binary file saved to: &#x2F;var&#x2F;folders&#x2F;5g&#x2F;rz16gqtx3nsdfs7k8sb80jth0000gn&#x2F;T&#x2F;binary693335273</span><br><span class="line">File: binary693335273</span><br><span class="line">Type: inuse_space</span><br><span class="line">Time: Mar 16, 2020 at 10:27am (CST)</span><br><span class="line">No samples were found with the default sample value type.</span><br><span class="line">Try &quot;sample_index&quot; command to analyze different sample values.</span><br><span class="line">Entering interactive mode (type &quot;help&quot; for commands, &quot;o&quot; for options)</span><br><span class="line">(pprof)</span><br><span class="line">(pprof) traces</span><br><span class="line">File: binary693335273</span><br><span class="line">Type: inuse_space</span><br><span class="line">Time: Mar 16, 2020 at 10:27am (CST)</span><br><span class="line">-----------+-------------------------------------------------------</span><br><span class="line">     bytes:  256kB</span><br><span class="line">         0   compress&#x2F;flate.(*compressor).init</span><br><span class="line">             compress&#x2F;flate.NewWriter</span><br><span class="line">             compress&#x2F;gzip.(*Writer).Write</span><br><span class="line">             runtime&#x2F;pprof.(*profileBuilder).build</span><br><span class="line">             runtime&#x2F;pprof.profileWriter</span><br><span class="line">-----------+-------------------------------------------------------</span><br><span class="line">     bytes:  64kB</span><br><span class="line">         0   compress&#x2F;flate.newDeflateFast</span><br><span class="line">             compress&#x2F;flate.(*compressor).init</span><br><span class="line">             compress&#x2F;flate.NewWriter</span><br><span class="line">             compress&#x2F;gzip.(*Writer).Write</span><br><span class="line">             runtime&#x2F;pprof.(*profileBuilder).build</span><br><span class="line">             runtime&#x2F;pprof.profileWriter</span><br><span class="line">-----------+-------------------------------------------------------</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨è¿œç¨‹è¿æ¥"><a href="#ä½¿ç”¨è¿œç¨‹è¿æ¥" class="headerlink" title="ä½¿ç”¨è¿œç¨‹è¿æ¥"></a>ä½¿ç”¨è¿œç¨‹è¿æ¥</h2><p>agentçš„é»˜è®¤é…ç½®<code>Option{}</code>ï¼Œç›‘å¬çš„æ˜¯ç¯å›åœ°å€ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ sudo netstat -nap | grep 414</span><br><span class="line">âœ  ~ netstat -nap | grep `pgrep gopsexample`</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp        0      0 127.0.0.1:36812         0.0.0.0:*               LISTEN      414/./gopsexample</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ç¨‹åºï¼Œåœ¨<code>Option</code>ä¸­è®¾ç½®ç›‘å¬çš„åœ°å€å’Œç«¯å£ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">agent.Listen(agent.Options&#123;Addr:<span class="string">"0.0.0.0:8848"</span>&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨è¿œç¨‹ä¸»æœºä¸Šé‡æ–°ç¼–è¯‘ã€é‡å¯è¿›ç¨‹ï¼Œç¡®è®¤è¿›ç¨‹ç›‘å¬çš„ç«¯å£ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ netstat -nap | grep `pgrep gopsexample`</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp6       0      0 :::8848                 :::*                    LISTEN      887/./gopsexample</span><br></pre></td></tr></table></figure><p>åœ¨æœ¬åœ°ä¸»æœºä¸Šä½¿ç”¨gopsè¿æ¥è¿œç«¯goè¿›ç¨‹ï¼Œå¹¶æŸ¥çœ‹æ•°æ®ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops stats 192.168.9.137:8848</span><br><span class="line">goroutines: 3</span><br><span class="line">OS threads: 9</span><br><span class="line">GOMAXPROCS: 4</span><br><span class="line">num CPU: 4</span><br></pre></td></tr></table></figure><p><code>gops</code>åé¢åªèƒ½è·ŸpidæŸ¥çœ‹è¿›ç¨‹ç®€è¦ä¿¡æ¯ï¼Œä¸èƒ½è·Ÿipå’ŒportæŸ¥çœ‹è¿œç«¯goè¿›ç¨‹ç®€è¦ä¿¡æ¯ï¼Œè¿™äº›ç®€è¦ä¿¡æ¯å¯ä»¥é€šè¿‡å­å‘½ä»¤æ±‡é›†èµ·æ¥ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">âœ  ~ gops 192.168.9.137:8848</span><br><span class="line">gops: unknown subcommand</span><br><span class="line">âœ  ~ </span><br><span class="line">âœ  ~ gops version 192.168.9.137:8848</span><br><span class="line">go1.13</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;gopsç®€ä»‹&quot;&gt;&lt;a href=&quot;#gopsç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;gopsç®€ä»‹&quot;&gt;&lt;/a&gt;gopsç®€ä»‹&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/google/gops&quot; target=&quot;_blan
      
    
    </summary>
    
    
    
      <category term="Go" scheme="http://lessisbetter.site/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºä»€ä¹ˆPBFTéœ€è¦3ä¸ªé˜¶æ®µæ¶ˆæ¯ï¼Ÿ</title>
    <link href="http://lessisbetter.site/2020/03/15/why-pbft-needs-3-phase-message/"/>
    <id>http://lessisbetter.site/2020/03/15/why-pbft-needs-3-phase-message/</id>
    <published>2020-03-15T01:25:41.000Z</published>
    <updated>2020-03-25T00:49:54.116Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨é¢è¯•çš„æ—¶å€™ï¼Œå¾ˆå¤šåŒå­¦çš„ç®€å†ç†Ÿæ‚‰PBFTå…±è¯†ç®—æ³•ï¼Œåœ¨ç°åœºé¢è¯•çš„æ—¶å€™ï¼Œå´åªèƒ½è¯´ä¸ªä¸»è¦é€»è¾‘ï¼Œç¦»å®Œæ•´çš„ç®—æ³•ï¼Œè¿˜å·®åä¸‡å…«åƒé‡Œï¼Œç›¸ä¼¼ä»ç½‘ç»œä¸Šçœ‹äº†ä¸€äº›æ–‡ç« ï¼Œå°±ç®—æ˜¯ç†Ÿæ‚‰äº†ã€‚å½“æˆ‘é—®â€œä¸ºä»€ä¹ˆPBFTéœ€è¦3ä¸ªé˜¶æ®µæ¶ˆæ¯ï¼Ÿ2ä¸ªé˜¶æ®µè¡Œä¸è¡Œâ€æ—¶ï¼Œè¿˜æ²¡æœ‰äººèƒ½å›ç­”å‡ºæ¥ã€‚</p><p>å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œè¿˜è¦ä»PBFTè¦è§£å†³çš„æœ¬è´¨é—®é¢˜è¯´èµ·ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—ä»¥è¿™æ ·ä¸€ä¸ªæ€è·¯ï¼Œä¸ºå¤§å®¶å›ç­”é—®é¢˜ï¼š</p><ul><li>PBFTä¸æ‹œå åº­é—®é¢˜</li><li>æ‹œå åº­èŠ‚ç‚¹åœ¨ç½‘ç»œä¸­çš„è¡Œä¸º</li><li>ä»€ä¹ˆæ˜¯3é˜¶æ®µæ¶ˆæ¯</li><li>3é˜¶æ®µæ¶ˆæ¯è§£å†³ä»€ä¹ˆé—®é¢˜</li><li>ä¸ºä»€ä¹ˆä¸èƒ½åªæœ‰å‰2ä¸ªé˜¶æ®µ</li><li>è®ºæ–‡ä½¿ç”¨çš„2ä¸ªä¸å˜æ€§</li><li>ä¸ºä»€ä¹ˆ3ä¸ªé˜¶æ®µå¯ä»¥è¾¾æˆä¸€è‡´æ€§</li></ul><h2 id="PBFTä¸æ‹œå åº­é—®é¢˜"><a href="#PBFTä¸æ‹œå åº­é—®é¢˜" class="headerlink" title="PBFTä¸æ‹œå åº­é—®é¢˜"></a>PBFTä¸æ‹œå åº­é—®é¢˜</h2><blockquote><p>è±æ–¯åˆ©Â·å…°æ³¢ç‰¹åœ¨å…¶è®ºæ–‡[1]ä¸­æè¿°äº†å¦‚ä¸‹æ‹œå åº­é—®é¢˜ï¼š</p><p>ä¸€ç»„æ‹œå åº­å¸å›½çš„å°†å†›åˆ†åˆ«å„ç‡é¢†ä¸€æ”¯å†›é˜Ÿå…±åŒå›´å›°ä¸€åº§åŸå¸‚ã€‚ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œå°†å„æ”¯å†›é˜Ÿçš„è¡ŒåŠ¨ç­–ç•¥é™å®šä¸ºè¿›æ”»æˆ–æ’¤ç¦»ä¸¤ç§ã€‚å› ä¸ºéƒ¨åˆ†å†›é˜Ÿè¿›æ”»ï¼Œæˆ–éƒ¨åˆ†å†›é˜Ÿæ’¤ç¦»å¯èƒ½ä¼šé€ æˆç¾éš¾æ€§åæœï¼Œå› æ­¤å„ä½å°†å†›å¿…é¡»é€šè¿‡æŠ•ç¥¨æ¥è¾¾æˆä¸€è‡´ç­–ç•¥ï¼Œå³æ‰€æœ‰å†›é˜Ÿä¸€èµ·è¿›æ”»æˆ–æ‰€æœ‰å†›é˜Ÿä¸€èµ·æ’¤ç¦»ã€‚å› ä¸ºå„ä½å°†å†›åˆ†å¤„åŸå¸‚ä¸åŒæ–¹å‘ï¼Œä»–ä»¬åªèƒ½é€šè¿‡ä¿¡ä½¿äº’ç›¸è”ç³»ã€‚åœ¨æŠ•ç¥¨è¿‡ç¨‹ä¸­ï¼Œæ¯ä½å°†å†›éƒ½å°†è‡ªå·±æŠ•ç¥¨è¿›æ”»è¿˜æ˜¯æ’¤é€€çš„ä¿¡æ¯ï¼Œé€šè¿‡ä¿¡ä½¿åˆ†åˆ«é€šçŸ¥å…¶ä»–æ‰€æœ‰å°†å†›ï¼Œè¿™æ ·ä¸€æ¥æ¯ä½å°†å†›æ ¹æ®è‡ªå·±çš„æŠ•ç¥¨ï¼Œå’Œå…¶ä»–æ‰€æœ‰å°†å†›é€æ¥çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥çŸ¥é“å…±åŒçš„æŠ•ç¥¨ç»“æœï¼Œè€Œå†³å®šè¡ŒåŠ¨ç­–ç•¥ã€‚</p><p>é—®é¢˜åœ¨äºï¼Œå°†å†›ä¸­å¯èƒ½å‡ºç°å›å¾’(åå°†å†›)ï¼Œä»–ä»¬ä¸ä»…å¯èƒ½å‘è¾ƒä¸ºç³Ÿç³•çš„ç­–ç•¥æŠ•ç¥¨ï¼Œè¿˜å¯èƒ½é€‰æ‹©æ€§åœ°å‘é€æŠ•ç¥¨ä¿¡æ¯ã€‚é˜»æ­¢å¥½å°†å†›è¾¾æˆä¸€è‡´çš„å½¢æˆç­–ç•¥ã€‚</p><p>æ‘˜è‡ªï¼š<a href="https://zh.wikipedia.org/wiki/%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B%E9%97%AE%E9%A2%98" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘ï¼šæ‹œå åº­å°†å†›é—®é¢˜</a>ï¼Œæœ‰åˆ æ”¹ã€‚</p></blockquote><p><em>å¾ˆå¤šäººå–œæ¬¢ç©ç‹¼äººæ€ï¼Œæˆ‘ä¹Ÿå–œæ¬¢ï¼Œä½†æˆ‘ç©çš„å¾ˆèœ</em>ï¼Œæˆ‘ç”¨ç‹¼äººæ€è·Ÿæ‹œå åº­å°†å†›é—®é¢˜åšä¸ªç±»æ¯”ã€‚</p><p>åœ¨ç‹¼äººæ€å¼€å±€çš„æ—¶å€™ï¼Œä½ æ˜¯å¥½äººï¼Œå¹¶ä¸”ä¸çŸ¥é“è‡ªå·±çš„é˜Ÿå‹æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“ç‹¼äººæ˜¯è°ï¼Œä½†æ‰€æœ‰çš„å¥½äººéƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç›®çš„ï¼šå¹²æ­»ç‹¼äººï¼Œå¥½äººè·èƒœã€‚æ‰€ä»¥æ¸¸æˆä¸­éœ€è¦ä½¿ç”¨æŠ€å·§å’Œç­–ç•¥ï¼Œè¾¾æˆç›®çš„ã€‚</p><p>æ‹œå åº­å°†å†›é—®é¢˜æ˜¯ç±»ä¼¼çš„ï¼Œå¥½çš„å°†å†›ä¸çŸ¥é“å…¶ä»–å°†å†›æ˜¯å¥½çš„ï¼Œè¿˜æ˜¯åçš„ï¼Œä½†æ‰€æœ‰å¥½çš„å°†å†›çš„ç›®çš„æ˜¯ï¼šè¡ŒåŠ¨ä¸€è‡´ï¼Œå…±åŒè¿›é€€ã€‚æ‰€ä»¥ï¼Œå®ƒä»¬ä¹Ÿéœ€è¦ç­–ç•¥è¾¾æˆä¸€è‡´ã€‚</p><p>BFTæ˜¯ä¸€ç±»è§£å†³æ‹œå åº­å°†å†›é—®é¢˜çš„ç­–ç•¥/ç®—æ³•ï¼šè®©éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´çš„ç®—æ³•ã€‚åœ¨è¿™ç±»è®ºæ–‡ä¸­ï¼Œæ‹œå åº­èŠ‚ç‚¹æŒ‡â€œåâ€çš„å°†å†›ï¼Œéæ‹œå åº­èŠ‚ç‚¹æŒ‡â€œå¥½â€çš„å°†å†›ã€‚</p><p>PBFTæ˜¯å®ç”¨æ‹œå åº­ç®—æ³•ï¼ˆ<a href="http://pmg.csail.mit.edu/papers/osdi99.pdf" target="_blank" rel="noopener">Practical Byzantine Fault Tolerance</a>ï¼‰çš„ç¼©å†™ï¼Œè¯¥è®ºæ–‡ä¸1999å¹´å‘è¡¨ï¼Œå¦å¤–2001å¹´åˆå‘è¡¨äº†ä¸€ç¯‡<a href="http://www.pmg.csail.mit.edu/papers/bft-tocs.pdf" target="_blank" rel="noopener">Practical Byzantine Fault Tolerance and Proactive Recovery</a>ï¼Œè®©PBFTæ‹¥æœ‰æ¢å¤èƒ½åŠ›ã€‚</p><p>PBFTä½œä¸ºè§£å†³æ‹œå åº­é—®é¢˜çš„ç­–ç•¥ï¼š<strong>éæ‹œå åº­èŠ‚ç‚¹ä¸çŸ¥é“å“ªäº›æ˜¯æ‹œå åº­èŠ‚ç‚¹ï¼Œå“ªäº›æ˜¯éæ‹œå åº­èŠ‚ç‚¹ï¼ŒPBFTè¦è®©éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´</strong>ã€‚</p><h2 id="æ‹œå åº­èŠ‚ç‚¹åœ¨ç½‘ç»œä¸­çš„è¡Œä¸º"><a href="#æ‹œå åº­èŠ‚ç‚¹åœ¨ç½‘ç»œä¸­çš„è¡Œä¸º" class="headerlink" title="æ‹œå åº­èŠ‚ç‚¹åœ¨ç½‘ç»œä¸­çš„è¡Œä¸º"></a>æ‹œå åº­èŠ‚ç‚¹åœ¨ç½‘ç»œä¸­çš„è¡Œä¸º</h2><p>æ‹œå åº­é—®é¢˜æ˜¯åœ¨åˆ†å¸ƒå¼å¯¹ç­‰ç½‘ç»œï¼Œå¯¹é€šä¿¡å®¹é”™æ‰€æå‡ºæ¥çš„ã€‚åœ¨çœŸå®ä¸–ç•Œä¸­ï¼Œæ‹œå åº­é—®é¢˜æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</p><p>é€šå¸¸ä½¿ç”¨æ‹œå åº­è¡Œä¸ºï¼Œæè¿°æ‹œå åº­èŠ‚ç‚¹å¯èƒ½çš„è¡Œä¸ºï¼Œæ‹œå åº­è¡Œä¸ºæœ‰ï¼š</p><ul><li>ä»»ä½•ä¸éµå®ˆåè®®çš„åŠ¨ä½œ</li><li>æ¶æ„ä»£ç ã€èŠ‚ç‚¹</li><li>ä»£ç bug</li><li>ç½‘ç»œæ•…éšœã€æ•°æ®åŒ…æŸå</li><li>ç£ç›˜å´©æ‰ã€é‡å¤ä¸¢å¤±</li><li>æ— æƒé™æ—¶åŠ å…¥</li><li>â€¦</li></ul><h2 id="ä»€ä¹ˆæ˜¯3é˜¶æ®µæ¶ˆæ¯"><a href="#ä»€ä¹ˆæ˜¯3é˜¶æ®µæ¶ˆæ¯" class="headerlink" title="ä»€ä¹ˆæ˜¯3é˜¶æ®µæ¶ˆæ¯"></a>ä»€ä¹ˆæ˜¯3é˜¶æ®µæ¶ˆæ¯</h2><p><img src="http://img.lessisbetter.site/2020-03-pbft-3-phase-message.png" alt="3é˜¶æ®µæ¶ˆæ¯"></p><p>3é˜¶æ®µæ¶ˆæ¯æ˜¯ï¼šPre-prepareã€Prepareå’ŒCommitã€‚æ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šåŒ…å«æ•°å­—ç­¾åï¼Œè¯æ˜æ¶ˆæ¯çš„å‘é€è€…ï¼Œä»¥åŠæ¶ˆæ¯ç±»å‹ï¼Œä¸‹æ–‡ä¸­ä¼šçœç•¥ã€‚</p><p>Pre-prepareæ¶ˆæ¯ç”±ä¸»èŠ‚ç‚¹å‘å‡ºï¼ŒåŒ…å«ï¼š</p><ul><li>å½“å‰viewï¼šv</li><li>ä¸»èŠ‚ç‚¹åˆ†é…ç»™è¯·æ±‚çš„åºå·n</li><li>è¯·æ±‚çš„æ‘˜è¦d</li><li>è¯·æ±‚æœ¬èº«m</li></ul><p><strong>åŠ¡å¿…è®°ç‰¢ï¼Œmã€vã€nã€dï¼Œåé¢ä¼šä½¿ç”¨ç¼©å†™</strong>ã€‚</p><p>Prepareæ˜¯å‰¯æœ¬èŠ‚ç‚¹æ”¶åˆ°Pre-prepareæ¶ˆæ¯åï¼Œåšå‡ºçš„å“åº”ï¼Œå‘é€ç»™æ‰€æœ‰å‰¯æœ¬èŠ‚ç‚¹ï¼ŒåŒ…å«ï¼š</p><ul><li>v</li><li>n</li><li>d</li></ul><p>PreparedçŠ¶æ€ï¼šå‰¯æœ¬iæœ‰Pre-prepareæ¶ˆæ¯ï¼Œä¸”æ”¶åˆ°2fä¸ªæœ‰æ•ˆçš„Prepareæ¶ˆæ¯ã€‚</p><p>å‰¯æœ¬iè¾¾åˆ°PreparedçŠ¶æ€ï¼Œå¯ä»¥å‘é€Commitæ¶ˆæ¯ï¼ŒCommitæ¶ˆæ¯çš„å†…å®¹å’ŒPrepareæ¶ˆæ¯å†…å®¹ç›¸åŒï¼Œä½†æ¶ˆæ¯ç±»å‹å’Œæ•°å­—ç­¾åæ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥å¯ä»¥åŒºåˆ†ã€‚</p><p>må¯ä»¥ä½¿ç”¨dä»£æ›¿ï¼Œæ‰€ä»¥Prepareå’ŒCommitæ¶ˆæ¯ä½¿ç”¨dä»£æ›¿mï¼Œæ¥èŠ‚çœé€šä¿¡é‡ã€‚</p><h2 id="3é˜¶æ®µæ¶ˆæ¯è§£å†³ä»€ä¹ˆé—®é¢˜"><a href="#3é˜¶æ®µæ¶ˆæ¯è§£å†³ä»€ä¹ˆé—®é¢˜" class="headerlink" title="3é˜¶æ®µæ¶ˆæ¯è§£å†³ä»€ä¹ˆé—®é¢˜"></a>3é˜¶æ®µæ¶ˆæ¯è§£å†³ä»€ä¹ˆé—®é¢˜</h2><p>å‰é¢æåˆ°ï¼ŒPBFTè§£å†³çš„æ˜¯æ‹œå åº­é—®é¢˜çš„ä¸€è‡´æ€§ï¼Œå³è®©éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´ã€‚æ›´å…·ä½“çš„è¯´ï¼š<strong>è®©è¯·æ±‚mï¼Œåœ¨viewå†…ä½¿ç”¨åºå·nï¼Œå¹¶ä¸”å®Œæˆæ‰§è¡Œmï¼Œå‘å®¢æˆ·ç«¯å‘é€å“åº”</strong>ã€‚</p><h2 id="ä¸ºä»€ä¹ˆä¸èƒ½åªæœ‰å‰2ä¸ªé˜¶æ®µæ¶ˆæ¯"><a href="#ä¸ºä»€ä¹ˆä¸èƒ½åªæœ‰å‰2ä¸ªé˜¶æ®µæ¶ˆæ¯" class="headerlink" title="ä¸ºä»€ä¹ˆä¸èƒ½åªæœ‰å‰2ä¸ªé˜¶æ®µæ¶ˆæ¯"></a>ä¸ºä»€ä¹ˆä¸èƒ½åªæœ‰å‰2ä¸ªé˜¶æ®µæ¶ˆæ¯</h2><p>è¿™ä¸ªé—®é¢˜çš„ç­‰ä»·é—®é¢˜æ˜¯ï¼šä¸ºä»€ä¹ˆPre-prepareå’ŒPrepareæ¶ˆæ¯ï¼Œä¸èƒ½è®©éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´ï¼Ÿ</p><p>Pre-prepareæ¶ˆæ¯çš„ç›®çš„æ˜¯ï¼Œä¸»èŠ‚ç‚¹ä¸ºè¯·æ±‚mï¼Œåˆ†é…äº†è§†å›¾vå’Œåºå·nï¼Œè®©è‡³å°‘f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹å¯¹è¿™ä¸ªåˆ†é…ç»„åˆ<code>&lt;m, v, n&gt;</code>è¾¾æˆä¸€è‡´ï¼Œå¹¶ä¸”ä¸å­˜åœ¨<code>&lt;m&#39;, v, n&gt;</code>ï¼Œå³ä¸å­˜åœ¨æœ‰2ä¸ªæ¶ˆæ¯ä½¿ç”¨åŒä¸€ä¸ªvå’Œnçš„æƒ…å†µã€‚</p><p><strong>PreparedçŠ¶æ€å¯ä»¥è¯æ˜éæ‹œå åº­èŠ‚ç‚¹åœ¨åªæœ‰è¯·æ±‚mä½¿ç”¨<code>&lt;v, n&gt;</code>ä¸Šè¾¾æˆä¸€è‡´</strong>ã€‚ä¸»èŠ‚ç‚¹æœ¬èº«æ˜¯è®¤å¯<code>&lt;m, v, n&gt;</code>çš„ï¼Œæ‰€ä»¥å‰¯æœ¬åªéœ€è¦æ”¶é›†2fä¸ªPrepareæ¶ˆæ¯ï¼Œè€Œä¸æ˜¯2f+1ä¸ªPrepareæ¶ˆæ¯ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºè‡³å°‘fä¸ªå‰¯æœ¬èŠ‚ç‚¹æ˜¯éæ‹œå åº­èŠ‚ç‚¹ï¼Œå®ƒä»¬è®¤å¯mä½¿ç”¨<code>&lt;v, n&gt;</code>ï¼Œå¹¶ä¸”æ²¡æœ‰å¦å¤–1ä¸ªæ¶ˆæ¯å¯ä»¥ä½¿ç”¨<code>&lt;v, n&gt;</code>ã€‚</p><p>æ—¢ç„¶1ä¸ª<code>&lt;v, n&gt;</code>åªèƒ½å¯¹åº”1ä¸ªè¯·æ±‚mäº†ï¼Œè¾¾åˆ°PreparedçŠ¶æ€åï¼Œå‰¯æœ¬iæ‰§è¡Œè¯·æ±‚mï¼Œä¸å°±è¾¾æˆä¸€è‡´äº†ä¹ˆï¼Ÿ</p><p>å¹¶ä¸èƒ½ã€‚<strong>Preparedæ˜¯ä¸€ä¸ªå±€éƒ¨è§†è§’ï¼Œä¸æ˜¯å…¨å±€ä¸€è‡´</strong>ï¼Œå³å‰¯æœ¬içœ‹åˆ°äº†éæ‹œå åº­èŠ‚ç‚¹è®¤å¯äº†<code>&lt;m, v, n&gt;</code>ï¼Œä½†æ•´ä¸ªç³»ç»ŸåŒ…å«3f+1ä¸ªèŠ‚ç‚¹ï¼Œå¼‚æ­¥çš„ç³»ç»Ÿä¸­ï¼Œå­˜åœ¨ä¸¢åŒ…ã€å»¶æ—¶ã€æ‹œå åº­èŠ‚ç‚¹æ•…æ„å‘éƒ¨åˆ†èŠ‚ç‚¹å‘é€Prepareç­‰æ‹œå åº­è¡Œæ–‡ï¼Œ<strong>å‰¯æœ¬iæ— æ³•ç¡®å®šï¼Œå…¶ä»–å‰¯æœ¬ä¹Ÿè¾¾åˆ°PreparedçŠ¶æ€ã€‚å¦‚æœå°‘äºfä¸ªå‰¯æœ¬æˆä¸ºPreparedçŠ¶æ€ï¼Œç„¶åæ‰§è¡Œäº†è¯·æ±‚mï¼Œç³»ç»Ÿå°±å‡ºç°äº†ä¸ä¸€è‡´ã€‚</strong></p><p>æ‰€ä»¥ï¼Œå‰2ä¸ªé˜¶æ®µçš„æ¶ˆæ¯ï¼Œå¹¶ä¸èƒ½è®©éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´ã€‚</p><p>å¦‚æœä½ äº†è§£2PCæˆ–è€…Paxosï¼Œæˆ‘ç›¸ä¿¡å¯ä»¥æ›´å®¹æ˜“ç†è§£ä¸Šé¢çš„æè¿°ã€‚2PCæˆ–Paxosï¼Œç¬¬ä¸€æ­¥åªæ˜¯ç”¨æ¥é”å®šèµ„æºï¼Œç¬¬2æ­¥æ‰æ˜¯çœŸæ­£å»Do Actionã€‚æŠŠPre-prepareå’ŒPrepareç†è§£ä¸ºç¬¬ä¸€æ­¥ï¼Œèµ„æºæ˜¯<code>&lt;v, n&gt;</code>ï¼Œåªæœ‰ç¬¬ä¸€æ­¥æ˜¯è¾¾ä¸æˆä¸€è‡´æ€§çš„ã€‚</p><h2 id="2ä¸ªä¸å˜æ€§"><a href="#2ä¸ªä¸å˜æ€§" class="headerlink" title="2ä¸ªä¸å˜æ€§"></a>2ä¸ªä¸å˜æ€§</h2><p>PBFTçš„è®ºæ–‡æåˆ°äº†2ä¸ªä¸å˜æ€§ï¼Œè¿™2ä¸ªä¸å˜æ€§ï¼Œ<strong>ç”¨æ¥è¯æ˜PBFTå¦‚ä½•è®©éæ‹œå åº­èŠ‚ç‚¹è¾¾æˆä¸€è‡´æ€§</strong>ã€‚</p><p><strong>ç¬¬1ä¸ªä¸å˜æ€§</strong>ï¼Œå®ƒæ˜¯ç”±Pre-prepareå’ŒPrepareæ¶ˆæ¯æ‰€å…±åŒç¡®ä¿çš„ä¸å˜æ€§ï¼šéæ‹œå åº­èŠ‚ç‚¹åœ¨åŒä¸€ä¸ªviewå†…å¯¹è¯·æ±‚çš„åºå·è¾¾æˆå…±è¯†ã€‚å…³äºè¿™ä¸ªä¸å˜æ€§ï¼Œå·²ç»åœ¨<a href="#ä¸ºä»€ä¹ˆä¸èƒ½åªæœ‰å‰2ä¸ªé˜¶æ®µæ¶ˆæ¯">ä¸ºä»€ä¹ˆä¸èƒ½åªæœ‰å‰2ä¸ªé˜¶æ®µæ¶ˆæ¯</a>ä¸­è®ºè¿°è¿‡ã€‚</p><p>ä»‹ç»ç¬¬2ä¸ªä¸å˜æ€§ä¹‹å‰ï¼Œéœ€è¦ä»‹ç»2ä¸ªå®šä¹‰ã€‚</p><ul><li>committed-localï¼šå‰¯æœ¬iå·²ç»æ˜¯PreparedçŠ¶æ€ï¼Œå¹¶ä¸”æ”¶åˆ°äº†2f+1ä¸ªCommitæ¶ˆæ¯ã€‚</li><li>committedï¼šè‡³å°‘f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹å·²ç»æ˜¯PreparedçŠ¶æ€ã€‚</li></ul><p><img src="http://img.lessisbetter.site/2020-03-pbft-committed.png" alt=""></p><p><strong>ç¬¬2ä¸ªä¸å˜æ€§</strong>ï¼Œå¦‚æœå‰¯æœ¬iæ˜¯committed-localï¼Œé‚£ä¹ˆä¸€å®šå­˜åœ¨committedã€‚</p><p>2f+1ä¸ªCommitæ¶ˆæ¯ï¼Œå»æ‰æœ€å¤šfä¸ªæ‹œå åº­èŠ‚ç‚¹ä¼ªé€ çš„æ¶ˆæ¯ï¼Œå¾—å‡ºè‡³å°‘f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹å‘é€äº†Commitæ¶ˆæ¯ï¼Œå³è‡³å°‘f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹æ˜¯PreparedçŠ¶æ€ã€‚æ‰€ä»¥ç¬¬2ä¸ªä¸å˜æ€§æˆç«‹ã€‚</p><h2 id="ä¸ºä»€ä¹ˆ3ä¸ªé˜¶æ®µæ¶ˆæ¯å¯ä»¥è¾¾æˆä¸€è‡´æ€§"><a href="#ä¸ºä»€ä¹ˆ3ä¸ªé˜¶æ®µæ¶ˆæ¯å¯ä»¥è¾¾æˆä¸€è‡´æ€§" class="headerlink" title="ä¸ºä»€ä¹ˆ3ä¸ªé˜¶æ®µæ¶ˆæ¯å¯ä»¥è¾¾æˆä¸€è‡´æ€§"></a>ä¸ºä»€ä¹ˆ3ä¸ªé˜¶æ®µæ¶ˆæ¯å¯ä»¥è¾¾æˆä¸€è‡´æ€§</h2><p>committedæ„å‘³ç€æœ‰f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹å¯ä»¥æ‰§è¡Œè¯·æ±‚ï¼Œè€Œcommitted-localæ„å‘³ç€ï¼Œå‰¯æœ¬içœ‹åˆ°äº†æœ‰f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹å¯ä»¥æ‰§è¡Œè¯·æ±‚ï¼Œf+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹æ‰§è¡Œè¯·æ±‚ï¼Œä¹Ÿå°±è¾¾æˆäº†ï¼Œè®©éæ‹œå åº­èŠ‚ç‚¹ä¸€è‡´ã€‚</p><p>è™½ç„¶æˆ‘å‰é¢ä½¿ç”¨äº†2PCå’ŒPaxosåšç±»æ¯”ï¼Œä½†ä¸æ„å‘³ç€PBFTçš„Commité˜¶æ®µå°±ç›¸å½“äºï¼Œ2PCå’ŒPaxosçš„ç¬¬2æ­¥ã€‚å› ä¸º2PCå’ŒPaxoså¤„ç†çš„CFTåœºæ™¯ï¼Œä¸å­˜åœ¨æ‹œå åº­èŠ‚ç‚¹ï¼Œå®ƒä»¬çš„ä¸»èŠ‚ç‚¹å……å½“äº†ç»Ÿè®¡åŠŸèƒ½ï¼Œç»Ÿè®¡æœ‰å¤šå°‘èŠ‚ç‚¹å®Œæˆäº†ç¬¬ä¸€æ­¥ã€‚PBFTä¸­èŠ‚ç‚¹æ˜¯å­˜åœ¨æ‹œå åº­èŠ‚ç‚¹çš„ï¼Œä¸»èŠ‚ç‚¹å¹¶ä¸æ˜¯å¯é (ä¿¡)çš„ï¼Œä¸èƒ½ä¾èµ–ä¸»èŠ‚ç‚¹ç»Ÿè®¡æ˜¯å¦æœ‰f+1ä¸ªéæ‹œå åº­èŠ‚ç‚¹è¾¾æˆäº†Preparedï¼Œè€Œæ˜¯æ¯ä¸ªèŠ‚ç‚¹å„è‡ªç»Ÿè®¡ï¼Œcommitted-localè®©èŠ‚ç‚¹çœ‹åˆ°äº†ï¼Œç³»ç»Ÿä¸€å®šå¯ä»¥è¾¾æˆä¸€è‡´ï¼Œæ‰å»æ‰§è¡Œè¯·æ±‚ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä»‹ç»äº†2ä¸ªé˜¶æ®µæ¶ˆæ¯æ˜¯æ— æ³•è¾¾æˆä¸€è‡´çš„åŸå› ï¼Œè€Œä¸ºä»€ä¹ˆ3é˜¶æ®µæ¶ˆæ¯å¯ä»¥ã€‚æœ€æ ¸å¿ƒçš„è¿˜æ˜¯è¦ç†è§£å¥½ï¼ŒPBFTè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠå®ƒæ˜¯å¦‚ä½•è§£å†³çš„ã€‚</p><p><strong>PBFTè§£å†³çš„æ˜¯åœ¨æ‹œå åº­ç¯å¢ƒä¸‹ï¼Œå¦‚ä½•æä¾›ä¸€è‡´æ€§ï¼Œä»¥åŠå¦‚ä½•æŒç»­çš„æä¾›ä¸€è‡´æ€§çš„é—®é¢˜</strong>ã€‚æœ¬æ–‡åªä»‹ç»äº†å¦‚ä½•æä¾›ä¸€è‡´æ€§ï¼Œæ²¡æœ‰æå¦‚ä½•æŒç»­æä¾›ä¸€è‡´æ€§ï¼Œå³PBFTçš„å¯ç”¨æ€§ã€‚ç°åœ¨ï¼Œä¸å¦¨æ€è€ƒä¸€ä¸‹ï¼ŒView Changeæ˜¯å¦‚ä½•ä¿è¯åˆ‡æ¢æ—¶ä¸€è‡´æ€§çš„ï¼Œæ˜¯å¦ä¹Ÿéœ€è¦2ä¸ªä¸å˜æ€§çš„æ”¯æŒå‘¢ï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;åœ¨é¢è¯•çš„æ—¶å€™ï¼Œå¾ˆå¤šåŒå­¦çš„ç®€å†ç†Ÿæ‚‰PBFTå…±è¯†ç®—æ³•ï¼Œåœ¨ç°åœºé¢è¯•çš„æ—¶å€™ï¼Œå´åªèƒ½è¯´ä¸ªä¸»è¦é€»è¾‘ï¼Œç¦»å®Œæ•´çš„ç®—æ³•ï¼Œè¿˜å·®åä¸‡å…«åƒé‡Œï¼Œç›¸ä¼¼ä»ç½‘ç»œä¸Šçœ‹äº†ä¸€äº›æ–‡
      
    
    </summary>
    
    
    
      <category term="ä¸€è‡´æ€§" scheme="http://lessisbetter.site/tags/%E4%B8%80%E8%87%B4%E6%80%A7/"/>
    
      <category term="åŒºå—é“¾" scheme="http://lessisbetter.site/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="PBFT" scheme="http://lessisbetter.site/tags/PBFT/"/>
    
      <category term="å…±è¯†ç®—æ³•" scheme="http://lessisbetter.site/tags/%E5%85%B1%E8%AF%86%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€å¼ æ€ç»´å¯¼å›¾çœ‹æ‡‚PBFT</title>
    <link href="http://lessisbetter.site/2020/03/11/pbft-xmind/"/>
    <id>http://lessisbetter.site/2020/03/11/pbft-xmind/</id>
    <published>2020-03-11T13:08:05.000Z</published>
    <updated>2020-04-11T09:48:59.646Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å¤®è¡Œå‘å¸ƒçš„ã€Šé‡‘èåˆ†å¸ƒå¼è´¦æœ¬å®‰å…¨è§„èŒƒã€‹ä¸­æåˆ°äº†åŒºå—é“¾ç³»ç»Ÿè¦æä¾›BFTå…±è¯†ï¼ŒæŠŠä¹‹å‰æ•´ç†çš„PBFTçš„æ€ç»´å¯¼å›¾åˆ†äº«ç»™å¤§å®¶ã€‚</p><p><strong>æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ï¼ŒæŸ¥çœ‹é«˜æ¸…å¤§å›¾</strong>ã€‚</p><h2 id="1999å¹´ç‰ˆæœ¬"><a href="#1999å¹´ç‰ˆæœ¬" class="headerlink" title="1999å¹´ç‰ˆæœ¬"></a>1999å¹´ç‰ˆæœ¬</h2><p><img src="http://img.lessisbetter.site/PBFT.svg" alt=""></p><h2 id="2001å¹´ç‰ˆæœ¬"><a href="#2001å¹´ç‰ˆæœ¬" class="headerlink" title="2001å¹´ç‰ˆæœ¬"></a>2001å¹´ç‰ˆæœ¬</h2><p><img src="http://img.lessisbetter.site/PBFT-PR.svg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘å¤®è¡Œå‘å¸ƒçš„ã€Šé‡‘èåˆ†å¸ƒå¼è´¦æœ¬å®‰å…¨è§„èŒƒã€‹ä¸­æåˆ°äº†åŒºå—é“¾ç³»ç»Ÿè¦æä¾›BFTå…±è¯†ï¼ŒæŠŠä¹‹å‰æ•´ç†çš„PBFTçš„æ€ç»´å¯¼å›¾åˆ†äº«ç»™å¤§å®¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ï¼ŒæŸ¥çœ‹é«˜æ¸…å¤§å›¾&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&quot;1999å¹´ç‰ˆæœ¬&quot;&gt;&lt;a href=&quot;#1999å¹´ç‰ˆ
      
    
    </summary>
    
    
    
      <category term="åŒºå—é“¾" scheme="http://lessisbetter.site/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="PBFT" scheme="http://lessisbetter.site/tags/PBFT/"/>
    
  </entry>
  
  <entry>
    <title>å‘Fabricè´¡çŒ®ä»£ç </title>
    <link href="http://lessisbetter.site/2020/03/03/contribute-to-fabric/"/>
    <id>http://lessisbetter.site/2020/03/03/contribute-to-fabric/</id>
    <published>2020-03-03T12:33:19.000Z</published>
    <updated>2020-03-16T14:51:33.540Z</updated>
    
    <content type="html"><![CDATA[<p>PDFå¦‚ä¸‹ï¼š</p><div class="pdf" target="http://img.lessisbetter.site/contribute-to-fabric.pdf" height=""></div><blockquote><p>PDFä¸æ˜¾ç¤ºæ—¶ï¼Œhexoå®‰è£…æ’ä»¶ï¼š<code>npm install --save hexo-pdf</code>ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;PDFå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&quot;pdf&quot; target=&quot;http://img.lessisbetter.site/contribute-to-fabric.pdf&quot; height=&quot;&quot;&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;PDFä¸æ˜¾ç¤ºæ—¶ï¼Œhexoå®‰
      
    
    </summary>
    
    
    
      <category term="Fabric" scheme="http://lessisbetter.site/tags/Fabric/"/>
    
  </entry>
  
  <entry>
    <title>ä»å› æœå…³ç³»è°ˆä¸ªäººèƒ½åŠ›å»ºè®¾å’Œé¢è¯•</title>
    <link href="http://lessisbetter.site/2020/03/01/causal-relationship-and-personal-ability/"/>
    <id>http://lessisbetter.site/2020/03/01/causal-relationship-and-personal-ability/</id>
    <published>2020-03-01T03:13:38.000Z</published>
    <updated>2020-05-05T06:36:52.104Z</updated>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©ç¡å‰äº†çœ‹äº†ä¸€æœ¬æ”¶è—å·²ä¹…çš„ä¹¦ï¼Œæ˜¯å…³äºæŠ•èµ„çš„ï¼Œå«<a href="https://book.douban.com/subject/30450383/" target="_blank" rel="noopener">ã€Šä¼Ÿå¤§çš„æ—¶ä»£-æ·±åº¦è§£è¯»ä»·å€¼æŠ•èµ„ã€‹</a>ï¼Œè¿™æ˜¯ä¸€æœ¬é‡‡è®¿äº†å›½å†…ä»·å€¼æŠ•èµ„è€…çš„ä¹¦ç±ï¼Œä»è¿™äº›æŠ•èµ„è€…çš„è¯è¯­é‡Œï¼Œçœ‹åˆ°äº†ä¸€äº›å…±æ€§çš„ä¸œè¥¿ï¼Œå¯»æ‰¾å„æ–­ä¼ä¸šæŒç»­å‘å±•çš„æ ¹å› ï¼Œä¹Ÿå°±è·å¾—äº†æŠ•èµ„æ”¶ç›Šï¼Œè¿™ä¸ªæœã€‚</p><p>ä»Šå¤©èµ·åºŠåï¼Œå°±æƒ³åˆ°äº†å› æœå…³ç³»ã€é¢è¯•ã€ä¸ªäººèƒ½åŠ›ï¼Œåœ¨è¿™äº›è§’åº¦è¿›è¡Œäº†ä¸€äº›æ€è€ƒï¼Œåœ¨æ­¤è®°å½•ä¸‹æ€è€ƒçš„æˆæœï¼Œè¿™ç¯‡æ–‡ç« ä¼šä»‹ç»ï¼š</p><ul><li>å› æœå…³ç³»åº”è¯¥å…³æ³¨å› ï¼Œè¿˜æ˜¯å…³æ³¨æœï¼Ÿ</li><li>å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå»ºè®¾ä¸ªäººèƒ½åŠ›ï¼Ÿ</li><li>å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå‘ç°ä¼˜ç§€çš„é¢è¯•è€…ï¼Ÿ</li></ul><h3 id="ä»·å€¼æŠ•èµ„ä¸­çš„å› æœå…³ç³»"><a href="#ä»·å€¼æŠ•èµ„ä¸­çš„å› æœå…³ç³»" class="headerlink" title="ä»·å€¼æŠ•èµ„ä¸­çš„å› æœå…³ç³»"></a>ä»·å€¼æŠ•èµ„ä¸­çš„å› æœå…³ç³»</h3><p>è¿™äº›æŠ•èµ„è€…çš„å…±æ€§æ˜¯ï¼Œéƒ½æåˆ°äº†è¦å¯»æ‰¾å„æ–­ï¼Œå¹¶ä¸”èƒ½å¤ŸæŒç»­å„æ–­çš„ä¼ä¸šï¼Œå¹¶æŠ•èµ„è¿™äº›ä¼ä¸šã€‚</p><p><strong>å„æ–­æ˜¯â€œæœâ€ï¼ŒæŒç»­å„æ–­ä¹Ÿæ˜¯è¿‡ï¼Œå®ƒä»¬éœ€è¦â€œå› â€</strong>ã€‚</p><p>æ€ä¹ˆæ‰èƒ½æœ‰å„æ–­ï¼Œå¹¶ä¸”æŒç»­å„æ–­å‘¢ï¼Ÿ</p><p>éœ€è¦æ‰¾åˆ°ä¼ä¸šçš„æ–‡åŒ–ã€ä»·å€¼è§‚ã€åˆ¶åº¦ï¼Œè¿™äº›è½¯æ€§çš„ä¸œè¥¿ã€è™šçš„ä¸œè¥¿ï¼Œæ˜¯ä¼ä¸š<strong>ä¸æ–­å‘å±•å’Œè¿›åŒ–</strong>çš„æ ¹åŸºï¼Œè¿™äº›æ˜¯ä¼ä¸šä¿æŒå„æ–­ï¼Œæˆ–æˆé•¿ä¸ºå„æ–­çš„åŸºçŸ³ï¼Œå„æ–­åˆ›é€ æ”¶ç›Šï¼Œæ”¶ç›Šæ˜¯å®ã€‚åº”äº†é˜¿é‡Œä¸€å¥è¯ï¼šæŠŠè™šåšå®ï¼ŒæŠŠå®åšè™šã€‚</p><p>æ‰€ä»¥ï¼Œä¼ä¸šæ–‡åŒ–ã€ä»·å€¼è§‚å’Œåˆ¶åº¦æ˜¯â€œå› â€ï¼Œå„æ–­æ˜¯â€œæœâ€ã€‚</p><p>å¦‚æœå„æ–­æ˜¯â€œå› â€ï¼Œä¼ä¸šæ”¶ç›Šå°±æ˜¯â€œæœâ€ã€‚</p><p><img src="http://img.lessisbetter.site/2020-03-cr-monopoly.png" alt=""></p><p>æ”¶ç›Šçš„å› ä¸åªæœ‰å„æ–­ï¼Œä½†å„æ–­å¯ä»¥å¸¦æ¥å·¨å¤§æ”¶ç›Šã€‚</p><h3 id="å…³æ³¨å› ï¼Œè¿˜æ˜¯å…³æ³¨æœï¼Ÿ"><a href="#å…³æ³¨å› ï¼Œè¿˜æ˜¯å…³æ³¨æœï¼Ÿ" class="headerlink" title="å…³æ³¨å› ï¼Œè¿˜æ˜¯å…³æ³¨æœï¼Ÿ"></a>å…³æ³¨å› ï¼Œè¿˜æ˜¯å…³æ³¨æœï¼Ÿ</h3><p>ä»ä¼ä¸šæ–‡åŒ–ã€å„æ–­å’Œæ”¶ç›Šï¼Œè¿™3è€…çœ‹ï¼Œå› æœå…³ç³»å¯ä»¥å½¢æˆé“¾æ¡ï¼Œç»„æˆä¸€æ¡å› æœé“¾ï¼Œä¸€ä¸ªå…ƒç´ å³å¯ä»¥æ˜¯å› ï¼Œåˆå¯ä»¥æ˜¯æœã€‚</p><p>æ¯”å¦‚ï¼Œå„æ–­æ˜¯ä¼ä¸šæ–‡åŒ–çš„æœï¼Œæ˜¯æ”¶ç›Šçš„å› ã€‚</p><p>è¯´å…³æ³¨å› æ˜¯å¯¹çš„ï¼Œå…³æ³¨æœä¹Ÿæ˜¯å¯¹çš„ï¼Œå…³æ³¨å› æœé“¾ä¸­ï¼Œ<strong>å…³æ³¨æœ€æ ¹æœ¬çš„â€œå› â€ï¼Œæ‰æ˜¯æœ€å¯¹çš„</strong>ã€‚</p><p>è¯´ä¸€ä¸ªå¼€å‘è€…æœ€å®¹æ˜“ä½“ä¼šçš„ä¾‹å­ï¼šè§£å†³bugï¼Œéœ€è¦å®šä½é—®é¢˜çš„â€œæ ¹å› â€ï¼Œåªè§£å†³ä¸­é—´åŸå› ï¼Œå¹¶ä¸èƒ½çœŸæ­£è§£å†³bugã€‚</p><p><img src="http://img.lessisbetter.site/2020-03-cr-root-cause.png" alt=""></p><h3 id="å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå»ºè®¾ä¸ªäººèƒ½åŠ›ï¼Ÿ"><a href="#å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå»ºè®¾ä¸ªäººèƒ½åŠ›ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå»ºè®¾ä¸ªäººèƒ½åŠ›ï¼Ÿ"></a>å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå»ºè®¾ä¸ªäººèƒ½åŠ›ï¼Ÿ</h3><p>æˆ‘æŠŠ<strong>ä¸­çº§</strong>æŠ€æœ¯å¼€å‘è€…çš„èƒ½åŠ›ï¼Œåˆ†æˆ5ä¸ªç»´åº¦ï¼šæŠ€æœ¯æ·±åº¦ã€æŠ€æœ¯å¹¿åº¦ã€å•†ä¸šæ€ç»´èƒ½åŠ›ã€ç®¡ç†èƒ½åŠ›å’Œæ¼”è®²èƒ½åŠ›ã€‚</p><p>ä¸åŒå²—ä½ã€å±‚æ¬¡çœ‹åˆ°çš„èƒ½åŠ›ç»´åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚CTOåœ¨æ‰¾æŠ€æœ¯æ€»ç›‘æ—¶çš„å²—ä½æ—¶ï¼Œéœ€è¦æœ‰ä½“ç³»å»ºè®¾çš„èƒ½åŠ›ã€‚æ‰€ä»¥ä¸Šé¢å¼ºè°ƒçš„æ˜¯ä¸­çº§å¼€å‘è€…ã€‚</p><p><img src="http://img.lessisbetter.site/2020-03-cr-personal-ability.png" alt=""></p><p>è¿™5ä¸ªç»´åº¦çš„èƒ½åŠ›æ˜¯å› ï¼Œé¡¹ç›®ã€èŒä½ã€æ”¶å…¥è¿™äº›æ˜¯æœã€‚</p><p>æœæ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæ˜¯æˆ‘ä»¬è¦è¾¾åˆ°çš„åœ°æ–¹ã€‚è€Œå› æ‰æ˜¯æˆ‘ä»¬è¦å…³æ³¨çš„åœ°æ–¹ã€‚</p><p>å»ºè®¾èƒ½åŠ›ï¼Œèƒ½åŠ›å°±è½¬å˜æˆäº†â€œæœâ€ï¼Œé‚£å¯¹åº”çš„å› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å»ºè®¾èƒ½åŠ›çš„â€œå› â€æ˜¯<strong>æŒç»­å­¦ä¹ </strong>ã€‚</p><p><img src="http://img.lessisbetter.site/2020-03-cr-continuelearn.png" alt=""></p><p>è¿™å‡ å¹´çš„ä»˜è´¹å­¦ä¹ ï¼Œå¯æŠŠæŒç»­å­¦ä¹ ç»™ç©åäº†ï¼Œæ€»æ˜¯å¼¥æ¼«ç€ä¸€ç§è´©å–ç„¦è™‘çš„æ°”æ¯ï¼Œä½†ä¸å¯å¦è®¤çš„æ˜¯ï¼ŒæŒç»­å­¦ä¹ çš„äººï¼Œæ€»æœ‰æœºä¼šã€‚</p><p>æŒç»­å­¦ä¹ ï¼Œæœ‰å¾ˆå¤šç§é€šä¿—çš„è¯´æ³•:</p><ol><li>æ´»åˆ°è€ï¼Œå­¦åˆ°è€ã€‚</li><li>æ°¸ä¸æ­¢æ­¥ã€‚</li><li>ä¸ç»™è‡ªå·±è®¾é™ã€‚</li><li>Stay foolish, Stay hungryã€‚â€”â€”ä¹”å¸ƒæ–¯</li><li>â€¦</li></ol><p>å…³äºæŠ€æœ¯ä¸Šçš„æŒç»­å­¦ä¹ ï¼Œæ›¹å¤§ï¼ˆXarginï¼‰æœ€è¿‘è¿™ç¯‡æ–‡ç« å€¼å¾—ä¸€çœ‹<a href="https://xargin.com/how-to-learn/" target="_blank" rel="noopener">ã€Šå·¥ç¨‹å¸ˆåº”è¯¥æ€ä¹ˆå­¦ä¹ ã€‹</a>ã€‚</p><h3 id="å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå‘ç°ä¼˜ç§€çš„é¢è¯•è€…ï¼Ÿ"><a href="#å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå‘ç°ä¼˜ç§€çš„é¢è¯•è€…ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå‘ç°ä¼˜ç§€çš„é¢è¯•è€…ï¼Ÿ"></a>å¦‚ä½•ä»å› æœå…³ç³»è§’åº¦ï¼Œå‘ç°ä¼˜ç§€çš„é¢è¯•è€…ï¼Ÿ</h3><p>æˆ‘è€ƒå¯Ÿå€™é€‰äººçš„ç»å†ä¸æ˜¯ç‰¹åˆ«å¤šï¼Œ1å¹´ä¸‹æ¥ï¼Œç®€å†ç­›é€‰è¿‡å‡ ç™¾ä»½ï¼Œå€™é€‰äººä¹Ÿé¢è¿‡å‡ åä¸ªäº†ï¼Œæœ‰ä¸€äº›ä½“ä¼šï¼Œä»Šå¤©å°±å€Ÿç€å› æœå…³ç³»ï¼Œæµ…è°ˆä¸€ä¸‹ã€‚</p><p><strong>é¢è¯•çš„æœ¬è´¨ï¼Œæ˜¯æŒ–æ˜é¢è¯•è€…å½“å‰çš„èƒ½åŠ›å’ŒæŒç»­å­¦ä¹ çš„èƒ½åŠ›</strong>ã€‚</p><p>ä¸Šé¢è¿™å¥ä»£è¡¨2ä¸ªè§‚ç‚¹ï¼š</p><ol><li>ç®€å†æ˜¯â€œæœâ€ï¼Œèƒ½åŠ›æ˜¯â€œå› â€ã€‚</li><li>æ‹›è¿›æ¥èƒ½æŒç»­åˆ›å»ºä»·å€¼æ˜¯æœªæ¥çš„â€œæœâ€ï¼ŒæŒç»­å­¦ä¹ æ˜¯â€œå› â€ã€‚</li></ol><p>é˜¿é‡Œæœ‰å¥åœŸè¯ï¼Œç”¨æ¥æ‹›è˜å¾ˆé€‚åˆï¼šæ²¡æœ‰è¿‡ç¨‹çš„ç»“æœæ˜¯åƒåœ¾ï¼Œæ²¡æœ‰ç»“æœçš„è¿‡ç¨‹æ˜¯æ”¾å±ã€‚</p><p>ä¸ŠåŠå¥ç”¨æ¥ç­›é€‰ç®€å†ï¼Œå¦‚æœç®€å†åªå†™è‡ªå·±å‚ä¸ã€åšè¿‡äº†ä»€ä¹ˆï¼Œè€Œæ²¡æœ‰æˆæœï¼Œè¿™ä»½ç®€å†å°±æ˜¯åƒåœ¾ï¼Œè€Œå†™ä¸å‡ºå¥½ç®€å†çš„é¢è¯•è€…ï¼Œèƒ½åŠ›å¤§æ¦‚ç‡ä¹Ÿä¸ä¼˜ç§€ã€‚</p><p>ä¸‹åŠå¥ç”¨æ¥é¢è¯•ï¼Œé¢è¯•è€…æ˜¯æ€ä¹ˆå–å¾—è¿™äº›æˆæœçš„ï¼ŒTAå…·æœ‰å“ªäº›èƒ½åŠ›æ‰å–å¾—äº†è¿™äº›æˆæœï¼Ÿ</p><h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>å› æœå…³ç³»ï¼Œè¿˜è®©æˆ‘æ·±åˆ»çš„æƒ³åˆ°ä¸€å¥è¯ï¼š<strong>æŠ“ä½äº‹ç‰©çš„ä¸»è¦çŸ›ç›¾</strong>ã€‚</p><p>å’±ä»¬å›½å®¶çš„å‘å±•ï¼Œä¸ä¸€ç›´å°±æ˜¯å…šå’Œæ”¿åºœåœ¨æŠ“ä¸»è¦çŸ›ç›¾ï¼Œè§£å†³ä¸»è¦çŸ›ç›¾çš„è¿‡ç¨‹å—ã€‚</p><h3 id="è¿œè§"><a href="#è¿œè§" class="headerlink" title="è¿œè§"></a>è¿œè§</h3><p>åœ¨ä¸–ç•Œè¯»ä¹¦æ—¥é‚£å¤©ï¼Œç¾å›¢æŠ€æœ¯å›¢é˜Ÿæ¨èäº†è®¸å¤šä¹¦ï¼Œå…¶ä¸­æœ‰ä¸€æœ¬å…³äºèŒä¸šç”Ÿæ¶¯çš„ä¹¦ç±ï¼šã€Š<strong>è¿œè§ï¼šå¦‚ä½•è§„åˆ’èŒä¸šç”Ÿæ¶¯3å¤§é˜¶æ®µ</strong>ã€‹ï¼Œä¹¦å¾ˆè–„ï¼Œä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œè¯»å®Œä¹‹åå¯¹èŒä¸šç”Ÿæ¶¯çš„è®¤çŸ¥æå‡äº†å‡ ä¸ªLevelï¼Œå€¼å¾—æ·±åº¦é˜…è¯»å¹¶å®è·µï¼Œæ¨èç»™ä¸æ–­è®©è‡ªå·±æ›´ä¼˜ç§€çš„ä½ ã€‚</p><p>ä¸‹é¢æ˜¯<strong>ç¾å›¢ç‚¹è¯„é…’æ—…äº‹ä¸šç¾¤å‰ç«¯å›¢é˜Ÿè´Ÿè´£äººéƒ­å‡¯</strong>çš„æ¨èè¯­ï¼š</p><blockquote><p>æˆ‘ä»¬ä¸ä»…è¦æ‰¾åˆ°çƒ­çˆ±çš„å·¥ä½œï¼Œè€Œä¸”è¦å»ºç«‹çƒ­çˆ±çš„ç”Ÿæ´»ã€‚èŒä¸šç”Ÿæ¶¯å°±åƒæ˜¯ä¸€åœºè‡³å°‘é•¿è¾¾45å¹´çš„é©¬æ‹‰æ¾ï¼Œè¿™æœ¬ä¹¦ä»‹ç»äº†è¿œè§æ€ç»´å’Œä¸‰å¤§èŒä¸šç”Ÿæ¶¯é˜¶æ®µï¼Œå¹¶ä»‹ç»äº†å¦‚ä½•åº”å¯¹èŒåœºå’Œç”Ÿæ´»çš„å†²çªã€‚æˆ‘è¾ˆåº”è¯¥å¤šè¡ŒåŠ¨ã€å°‘å¿§è™‘ï¼Œå¹¶ä¸”æå‰åšå¥½ä¸­é•¿æœŸçš„èŒä¸šæ€è€ƒå’ŒèŒä¸šè§„åˆ’ã€‚å¦‚æœç”¨â€œè¿œè§â€çš„æ€ç»´çœ‹å¾…çœ¼å‰çš„å½±å“å’Œå›°éš¾ï¼Œå°±æ ¹æœ¬ä¸å€¼å¾—ä¸€æã€‚ç”¨â€œè¿œè§â€çš„æ€ç»´ï¼Œé•¿æœŸæœ‰è€å¿ƒï¼Œæ¯å¤©å‰è¿›30å…¬é‡Œã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æ˜¨å¤©ç¡å‰äº†çœ‹äº†ä¸€æœ¬æ”¶è—å·²ä¹…çš„ä¹¦ï¼Œæ˜¯å…³äºæŠ•èµ„çš„ï¼Œå«&lt;a href=&quot;https://book.douban.com/subject/30450383/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€Šä¼Ÿå¤§çš„æ—¶ä»£-æ·±åº¦è§£è¯»ä»·å€¼æŠ•èµ„ã€‹&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€æœ¬é‡‡è®¿äº†å›½å†…
      
    
    </summary>
    
    
    
      <category term="èŒä¸šå‘å±•" scheme="http://lessisbetter.site/tags/%E8%81%8C%E4%B8%9A%E5%8F%91%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>Fabric 1.4æºç è§£è¯» 9ï¼šä»è´¦æœ¬è§’åº¦çœ‹Peer</title>
    <link href="http://lessisbetter.site/2020/01/03/fabric-peer-ledger/"/>
    <id>http://lessisbetter.site/2020/01/03/fabric-peer-ledger/</id>
    <published>2020-01-03T12:58:03.000Z</published>
    <updated>2020-02-14T07:02:17.527Z</updated>
    
    <content type="html"><![CDATA[<p>åŒºå—é“¾æœ€æ ¸å¿ƒçš„æ˜¯<strong>å¯ä¿¡æ•°æ®</strong>ï¼Œæ‰€æœ‰çš„åŠŸèƒ½ä¸è®¾è®¡æ ¹æºéƒ½æ˜¯æ•°æ®ã€‚æœ¬æ¬¡ä»æ•°æ®å­˜å‚¨çš„è§’åº¦ï¼Œçœ‹ä¸€çœ‹Peerã€‚</p><h2 id="è´¦æœ¬"><a href="#è´¦æœ¬" class="headerlink" title="è´¦æœ¬"></a>è´¦æœ¬</h2><p>åŒºå—é“¾çš„æ•°æ®å­˜å‚¨åœ¨è´¦æœ¬ä¸­ï¼Œè´¦æœ¬åŒ…å«ï¼š</p><ul><li>åŒºå—å­˜å‚¨<ul><li>åŒºå—æ–‡ä»¶</li><li>åŒºå—ç´¢å¼•æ•°æ®åº“</li></ul></li><li>ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“</li><li>å†å²æ•°æ®åº“</li><li>ç§æœ‰æ•°æ®æ•°æ®åº“</li></ul><p>å…³äºè´¦æœ¬ä»¥ä¸Šå„æ•°æ®åº“çš„å·¥å…·ï¼Œ<a href="https://hyperledger-fabric-cn.readthedocs.io/zh/latest/ledger/ledger.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ä¸­å¯¹åŒºå—å­˜å‚¨å’Œä¸–ç•ŒçŠ¶æ€æ•°æ®åº“ä»‹ç»çš„æ¯”è¾ƒè¯¦ç»†äº†ï¼Œä½†æˆ‘ä»¬ä»‹ç»ä¸‹å®ƒæ²¡æœ‰æåˆ°çš„ã€‚</p><h3 id="åŒºå—æ–‡ä»¶å’ŒåŒºå—ç´¢å¼•æ•°æ®åº“"><a href="#åŒºå—æ–‡ä»¶å’ŒåŒºå—ç´¢å¼•æ•°æ®åº“" class="headerlink" title="åŒºå—æ–‡ä»¶å’ŒåŒºå—ç´¢å¼•æ•°æ®åº“"></a>åŒºå—æ–‡ä»¶å’ŒåŒºå—ç´¢å¼•æ•°æ®åº“</h3><p>åŒºå—æ˜¯ä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„ï¼Œ<strong>ä¸ºäº†å¿«é€ŸæŸ¥æ‰¾åŒºå—ã€äº¤æ˜“</strong>ï¼ŒFabricå»ºç«‹äº†ç´¢å¼•ï¼ŒæŒ‡æ˜æŸé€šé“æŸåŒºå—é«˜åº¦çš„ç¬¬xä¸ªäº¤æ˜“ï¼Œæ˜¯å­˜åœ¨å“ªä¸ªæ–‡ä»¶ï¼Œåç§»é‡æ˜¯å¤šå°‘ã€‚å½“ç„¶ï¼Œç´¢å¼•è¿˜åŒ…å«äº†åŒºå—é«˜åº¦ã€åŒºå—hashç­‰ï¼Œæ–¹ä¾¿æ ¹æ®é«˜åº¦ã€hashæŸ¥è¯¢åŒºå—ã€‚</p><p><img src="http://img.lessisbetter.site/2020-01-blockfile-index.png" alt=""></p><p>ä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªåŒºå—æ–‡ä»¶å­˜å‚¨åŒºå—çš„æƒ…å†µï¼Œæ¯ä¸ªåŒºå—åŒ…å«ï¼š</p><ul><li>åŒºå—é•¿åº¦</li><li>åŒºå—å¤´</li><li>æ¯æ¡äº¤æ˜“é•¿åº¦ã€äº¤æ˜“æ•°æ®</li></ul><p>æ¯ä¸ªåŒºå—çš„å¼€å§‹ä½ç½®ã€äº¤æ˜“çš„å¼€å§‹ä½ç½®ï¼Œåœ¨å†™åŒºå—çš„æ—¶å€™è®°å½•ä¸‹æ¥ï¼Œç„¶åå†™åˆ°ç´¢å¼•æ•°æ®åº“ï¼ˆIndex DBï¼‰ã€‚</p><p><strong>æ•´ä¸ªFabricç½‘ç»œåªæœ‰1ä¸ªåŒºå—ç´¢å¼•æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯å¤šé€šé“å…±ç”¨ä¸€ä¸ª</strong>ã€‚</p><h3 id="å†å²æ•°æ®åº“"><a href="#å†å²æ•°æ®åº“" class="headerlink" title="å†å²æ•°æ®åº“"></a>å†å²æ•°æ®åº“</h3><p><strong>ç”¨æ¥è®°å½•äº¤æ˜“ä¸­æ¯ä¸ªçŠ¶æ€æ•°æ®çš„å†å²ä¿¡æ¯ï¼Œç›´ç™½ç‚¹å¯ä»¥ç†è§£ä¸ºé“¾ç ä¸­æŸä¸ªkeyçš„å†å²æ•°å€¼</strong>ã€‚å®ƒçš„keyå®é™…æ˜¯<code>{é€šé“id+é“¾ç id, key, åŒºå—é«˜åº¦, äº¤æ˜“åœ¨åŒºå—ä¸­çš„åºå·}</code>ç»„æˆçš„<strong>å¤åˆkey</strong>ï¼Œå€¼ä¸ºç©ºï¼Œå¹¶ä¸”åªåŒ…å«æœ‰æ•ˆçš„äº¤æ˜“ã€‚</p><p>æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šå€¼ä¸ºç©ºï¼Œåˆ°åº•æ€ä¹ˆæŸ¥è¯¢åˆ°å†å²çŠ¶æ€å‘¢ï¼Ÿ</p><p>ç­”ï¼šé€šè¿‡å†å²æ•°æ®åº“åˆæˆå¤åˆkeyï¼Œä½†å¤åˆkeyä¸­æ²¡æœ‰äº¤æ˜“åœ¨åŒºå—ä¸­çš„åºå·ï¼Œåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨å¯ä»¥è·å–åŒ…å«keyçš„å¤åˆkeyï¼Œç„¶åä»å¤åˆkeyä¸­æå–åˆ°äº¤æ˜“åœ¨åŒºå—çš„åºå·ï¼Œç„¶åå»åŒºå—æ–‡ä»¶ä¸­æå–äº¤æ˜“ï¼Œå†æå–åˆ°å†™é›†çš„Valueï¼Œå°±å¯ä»¥åˆæˆæŸä¸ªkeyçš„æ‰€æœ‰å†å²å€¼ã€‚</p><p>å› æ­¤<strong>æŸ¥è¯¢å†å²çŠ¶æ€ï¼Œéœ€è¦ç»“åˆå†å²æ•°æ®åº“å’ŒåŒºå—æ–‡ä»¶</strong>ã€‚</p><h2 id="å„æ•°æ®åº“å®ç°"><a href="#å„æ•°æ®åº“å®ç°" class="headerlink" title="å„æ•°æ®åº“å®ç°"></a>å„æ•°æ®åº“å®ç°</h2><p><strong>åŒºå—æ–‡ä»¶ä½¿ç”¨æ–‡ä»¶ç›´æ¥å­˜å‚¨åŒºå—ï¼Œæ²¡æœ‰ä½¿ç”¨æ•°æ®åº“çš„åŸå› </strong>æ˜¯ï¼šåŒºå—æ˜¯ä¸€ç§è‡ªç„¶çš„è¿½åŠ æ“ä½œï¼Œå†™å…¥åä¸å†ä¿®æ”¹ï¼Œå³ä¸ä¼šè¦†ç›–å†å²åŒºå—ï¼Œä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿç›´æ¥å­˜å‚¨åŒºå—ï¼Œå¯ä»¥è¾¾åˆ°åŒºå—æœ€å¿«è½ç›˜çš„ç›®çš„ï¼Œå› ä¸ºå‘æ–‡ä»¶å†™åŒºå—æ˜¯é¡ºåºå†™ï¼Œè€Œå†™æ•°æ®åº“æ˜¯éšæœºå†™ï¼Œç£ç›˜ï¼ˆåŒ…å«HDã€SSDï¼‰çš„é¡ºåºå†™æ€§èƒ½è¦é«˜äºéšæœºå†™ã€‚</p><p>ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“å¯ä»¥ä½¿ç”¨leveldbæˆ–è€…CouchDBï¼ŒCouchDBæ”¯æŒå¯ŒæŸ¥è¯¢åŠŸèƒ½ï¼Œå½“é“¾ç æ•°æ®æŒ‰JSONå»ºæ¨¡æ—¶ï¼ŒCouchDBå¯ä»¥æä¾›æ›´å¥½çš„æ•°æ®æŸ¥è¯¢ï¼Œæ›´å¤šCouchDBçš„ä¿¡æ¯è§æ–‡æ¡£<a href="https://stone-fabric.readthedocs.io/zh/latest/couchdb_tutorial.html" target="_blank" rel="noopener">ä½¿ç”¨ CouchDB</a>ã€‚</p><p>å…¶ä»–æ•°æ®åº“éƒ½ä½¿ç”¨leveldbä½œä¸ºåº•å±‚å­˜å‚¨ã€‚</p><p><img src="http://img.lessisbetter.site/2020-01-peer-ledger-storage.png" alt=""></p><p><strong>æé†’</strong>ï¼šFabricæ”¯æŒå¤šé€šé“ï¼Œé€»è¾‘ä¸Šæ¯ä¸ªé€šé“æ‹¥æœ‰ä¸€ä¸ªè´¦æœ¬ã€‚å®ç°ä¸ŠåŒºå—æ–‡ä»¶æ˜¯æŒ‰é€šé“åéš”ç¦»å¼€äº†ï¼Œä½¿ç”¨leveldbçš„å„æ•°æ®åº“ï¼Œè¢«å„é€šé“å…±ç”¨ã€‚</p><h2 id="ä»æ•°æ®çœ‹PeeråŠŸèƒ½"><a href="#ä»æ•°æ®çœ‹PeeråŠŸèƒ½" class="headerlink" title="ä»æ•°æ®çœ‹PeeråŠŸèƒ½"></a>ä»æ•°æ®çœ‹PeeråŠŸèƒ½</h2><p>å’Œè´¦æœ¬ç›¸å…³çš„æ¦‚å¿µè¿˜æœ‰<strong>åŒºå—ã€äº¤æ˜“å’ŒçŠ¶æ€</strong>ï¼Œä»è´¦æœ¬çš„è§’åº¦çœ‹ï¼Œè´¦æœ¬å‘ä¸Šæ”¯æ’‘äº†2ç±»åŠŸèƒ½ï¼š</p><ol><li>æ•°æ®åŒæ­¥ï¼šå¹¿æ’­ä¸åŒæ­¥åŒºå—</li><li>äº¤æ˜“èƒŒä¹¦ï¼šæ¨¡æ‹Ÿæ‰§è¡Œäº¤æ˜“</li></ol><p>åœ¨ä¸‹å›¾ä¸­ï¼Œæ•°æ®åŒæ­¥å’Œäº¤æ˜“èƒŒä¹¦åˆ†åˆ«ä½¿ç”¨è“è‰²å’Œæ©™è‰²çš„çº¿åœˆå‡ºï¼Œåº•éƒ¨å‰©ä¸‹çš„2å±‚ä¸ºè´¦æœ¬ã€‚</p><p><img src="http://img.lessisbetter.site/2020-01-03-usage-of-peer-ledger.png" alt=""></p><h3 id="è´¦æœ¬-1"><a href="#è´¦æœ¬-1" class="headerlink" title="è´¦æœ¬"></a>è´¦æœ¬</h3><p><code>core/ledger</code>å®ç°äº†Peerçš„è´¦æœ¬åŠŸèƒ½ï¼ŒåŒ…å«äº†è´¦æœ¬ä¸­çš„å„é¡¹æ•°æ®åº“ï¼Œå®ƒä¾èµ–<code>common/ledger</code>å®ç°åŒºå—æ–‡ä»¶å­˜å‚¨ï¼ŒåŒºå—æ–‡ä»¶å­˜å‚¨åŒ…å«3ç±»ï¼š</p><ul><li><code>File</code>ï¼šæŠŠåŒºå—ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œordererå’Œpeerçš†å¯ä½¿ç”¨</li><li><code>Json</code>ï¼šæŠŠæ–‡ä»¶ä¿è¯JSONæ ¼å¼çš„æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨åœ¨éç”Ÿäº§ç¯å¢ƒï¼Œä»…ä¾›ordererä½¿ç”¨</li><li><code>Ram</code> ï¼šæŠŠåŒºå—ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä½¿ç”¨åœ¨éç”Ÿäº§ç¯å¢ƒï¼Œä»…ä¾›ordererä½¿ç”¨</li></ul><p><code>core/ledger</code>ä¸­çš„ï¼š</p><ul><li><code>PeerLedger</code>æ¥å£ï¼Œä»£è¡¨<strong>Peerè´¦æœ¬</strong>ï¼Œä¸»è¦ç”¨æ¥å‘è´¦æœ¬å†™åŒºå—å’Œç§æœ‰æ•°æ®ï¼ŒæŸ¥è¯¢åŒºå—ã€äº¤æ˜“å’Œç§æœ‰æ•°æ®</li><li><code>Txsimulator</code>æ¥å£ï¼Œä»£è¡¨<strong>äº¤æ˜“æ¨¡æ‹Ÿå™¨</strong>ï¼Œç”¨æ¥æ¨¡æ‹Ÿæ‰§è¡Œ1æ¡äº¤æ˜“</li><li><code>QueryExecutor</code>æ¥å£ç”¨æ¥æŸ¥è¯¢<strong>æœ€æ–°çš„</strong>æ•°æ®</li><li><code>HistoryQueryExecutor</code>æ¥å£ç”¨æ¥æŸ¥è¯¢<strong>å†å²</strong>çŠ¶æ€</li></ul><h3 id="åŒæ­¥æ•°æ®"><a href="#åŒæ­¥æ•°æ®" class="headerlink" title="åŒæ­¥æ•°æ®"></a>åŒæ­¥æ•°æ®</h3><p>åŒæ­¥æ•°æ®æœ‰2ç§æ–¹å¼ï¼š</p><ul><li>DeliveræœåŠ¡ï¼ŒPeerä½¿ç”¨äº‹ä»¶ä»Ordererè·å–åŒºå—</li><li>Peerå‘å…¶ä»–èŠ‚ç‚¹è¯·æ±‚è·å–æŸä¸ªåŒºé—´çš„åŒºå—</li></ul><p>è™½ç„¶Peerè·å–åŒºå—çš„æ–¹å¼æœ‰2ç§ï¼Œä½†æ”¶åˆ°åŒºå—ï¼Œå¤„ç†åŒºå—çš„æ–¹å¼åªæœ‰1ç§ï¼Œæ‰€ä»¥ä¸‹é¢åˆ†3å°èŠ‚ä»‹ç»ã€‚</p><h4 id="ä½¿ç”¨DeliveråŒæ­¥åŒºå—"><a href="#ä½¿ç”¨DeliveråŒæ­¥åŒºå—" class="headerlink" title="ä½¿ç”¨DeliveråŒæ­¥åŒºå—"></a>ä½¿ç”¨DeliveråŒæ­¥åŒºå—</h4><p>Deliverç”¨æ¥ä»¥äº‹ä»¶çš„æ–¹å¼è·å–åŒºå—ï¼Œåœºæ™¯æœ‰2ç‚¹ï¼š</p><ul><li>Peerä»Odererè·å–åŒºå—</li><li>å®¢æˆ·ç«¯/SDKä»Peerè·å–åŒºå—</li></ul><p>åœ¨<a href="http://lessisbetter.site/2019/12/17/fabric-blocks-from-orderer-to-peer/">Fabric 1.4æºç è§£è¯» 8ï¼šOrdererå’ŒPeerçš„äº¤äº’</a>ä¸­å·²ç»ä»‹ç»äº†Peerä»Ordererè·å–åŒºå—ï¼Œè¿™é‡Œå†åšä¸€ç‚¹è¡¥å……ã€‚</p><p>DeliveræœåŠ¡æ˜¯Ordererå’ŒPeeréƒ½ä½¿ç”¨çš„åŠŸèƒ½ï¼Œä½†Ordererå¹¶æ²¡æœ‰<code>core/ledger</code>ï¼Œæ‰€ä»¥ä»è®¾è®¡å’Œå®ç°ä¸Šï¼Œ<code>common/deliver</code>æ˜¯ä»<code>common/ledger</code>ä¸­ç›´æ¥è¯»åŒºå—ï¼Œè€Œä¸æ˜¯<code>core/ledger</code>è¯»åŒºå—ã€‚</p><h4 id="Peerè¯·æ±‚åŒºå—"><a href="#Peerè¯·æ±‚åŒºå—" class="headerlink" title="Peerè¯·æ±‚åŒºå—"></a>Peerè¯·æ±‚åŒºå—</h4><p>æ¯ä¸ªPeerå¯ä»¥é€šè¿‡Gossipå¾—çŸ¥åŒé€šé“çš„ã€æ‰€è¿æ¥çš„Peerä¿¡æ¯ï¼Œå…¶ä¸­ä¸€é¡¹å°±æ˜¯å¯¹æ–¹Peerè´¦æœ¬çš„é«˜åº¦ã€‚è´¦æœ¬é«˜åº¦ä½çš„Peerå¯ä»¥å‘é«˜åº¦é«˜çš„Peerå‘é€<strong>StateRequest</strong>ï¼Œè¯·æ±‚è·å–æŸä¸ªè¿ç»­åŒºé—´çš„åŒºå—ã€‚</p><p>Peerä¸Šè´Ÿè´£StateRequestçš„æ˜¯<code>gossip/state</code>æ¨¡å—ï¼Œå®ƒè´Ÿè´£ï¼š</p><ul><li>åˆ›å»ºStateRequestè¯·æ±‚</li><li>å¤„ç†StateRequestè¯·æ±‚ï¼Œç”ŸæˆStateRequestå“åº”</li><li>å¤„ç†StateRequestå“åº”</li></ul><p>åˆ›å»ºè¯·æ±‚ï¼šå‡è®¾Peer1æ¯”Peer2å°‘50ä¸ªåŒºå—ï¼Œå¹¶ä¸”é…ç½®äº†Peeræ¯æ¬¡æœ€å¤šå–10ä¸ªåŒºå—ï¼ŒPeer1ä¼šåˆ›å»º5ä¸ªStateRequestè¯·æ±‚ï¼Œé¡ºåºçš„å‘Peer2è¿›è¡Œè¯·æ±‚ï¼ŒPeer1æ”¶åˆ°å‰ä¸€ä¸ªè¯·æ±‚çš„å“åº”åï¼Œæ‰å‘å‡ºä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚</p><p>å¤„ç†è¯·æ±‚ï¼šå®é™…æ˜¯ä»è´¦æœ¬è¯»å–æ‰€è¯·æ±‚åŒºå—çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸»è¦æ˜¯è¯»å–åŒºå—æ–‡ä»¶ï¼Œå¦‚æœåŒºå—æ¶‰åŠç§å¯†æ•°æ®ï¼Œä¹Ÿæ¶‰åŠè¯»å–ç§å¯†æ•°æ®åº“ï¼Œè¿™éƒ¨åˆ†åŠŸèƒ½ä¸»è¦ç”±<code>gossip/privdata</code>å®Œæˆï¼Œ<code>gossip/state</code>æŠŠè¯»åˆ°çš„åŒºå—å’Œç§å¯†æ•°æ®ç”Ÿæˆè¯·æ±‚å“åº”ã€‚</p><h4 id="Peerå¤„ç†æ”¶åˆ°çš„åŒºå—"><a href="#Peerå¤„ç†æ”¶åˆ°çš„åŒºå—" class="headerlink" title="Peerå¤„ç†æ”¶åˆ°çš„åŒºå—"></a>Peerå¤„ç†æ”¶åˆ°çš„åŒºå—</h4><p>Peerä»Ordererå’Œå…¶ä»–Peerå“ªè·å–çš„åŒºå—ï¼Œæœ€ç»ˆéƒ½ä¼šè¿›å…¥åˆ°<code>gossip/state</code>ï¼ŒåŒºå—ä¼šè¢«æ”¾å…¥åˆ°ä¸€ä¸ªåŒºå—ç¼“å†²åŒºï¼š<strong>PayloadsBuffer</strong>ï¼Œé»˜è®¤å¤§å°ä¸ºå­˜å‚¨200ä¸ªåŒºå—ã€‚</p><p>æ¯ä¸ªé€šé“è´¦æœ¬éƒ½æœ‰ä¸€ä¸ªgoroutineï¼Œä»å„è‡ªçš„PayloadsBufferæ‹¿ä¸‹ä¸€ä¸ªé«˜åº¦çš„åŒºå—ï¼Œäº¤ç»™<code>gossip/privdata</code>è¿›è¡ŒåŒºå—çš„éªŒè¯å’Œå†™å…¥ã€‚</p><h5 id="éªŒè¯åŒºå—"><a href="#éªŒè¯åŒºå—" class="headerlink" title="éªŒè¯åŒºå—"></a>éªŒè¯åŒºå—</h5><p>è¿™éƒ¨åˆ†åŠŸèƒ½ç”±<code>core/handler/validation</code>å®Œæˆã€‚åœ¨Fabric 1.4ä¸­ï¼ŒStateImplä¼šè°ƒç”¨QueryExecutoræŸ¥è¯¢çŠ¶æ€ï¼Œä½†å®é™…StateImplæ²¡æœ‰è¢«è°ƒç”¨ã€‚</p><p>éªŒè¯åŒºå—ä¸»è¦æ˜¯å¹¶å‘éªŒè¯åŒºå—ä¸­çš„äº¤æ˜“ï¼š</p><ul><li>éªŒè¯äº¤æ˜“ä¸­çš„å­—æ®µ</li><li>éªŒè¯æ˜¯å¦æ»¡è¶³èƒŒä¹¦ç­–ç•¥</li><li>éªŒè¯äº¤æ˜“æ˜¯å¦è°ƒç”¨æœ€æ–°ç‰ˆæœ¬çš„é“¾ç </li><li>éªŒè¯äº¤æ˜“æ˜¯å¦é‡å¤</li></ul><p>äº¤æ˜“éªŒè¯çš„ç»“æœï¼Œå³äº¤æ˜“æ˜¯å¦æœ‰æ•ˆï¼Œå¹¶ä¸ä¼šä¿å­˜åœ¨äº¤æ˜“ä¸­ï¼Œè¿™æ ·åŒºå—ä¸­è®°å½•æ‰€æœ‰äº¤æ˜“çš„DataHashå°±å˜åŒ–äº†ã€‚åŒºå—ä¸­æ‰€æœ‰äº¤æ˜“çš„æœ‰æ•ˆæ€§å­˜å‚¨åœ¨åŒºå—çš„å…ƒæ•°æ®ä¸­ï¼ŒåŒºå—å…ƒæ•°æ®ä¸­æœ‰ä¸€ä¸ªæœ‰æ•ˆæ€§æ•°ç»„ï¼Œä¾æ¬¡å­˜æ”¾äº†æ¯ä¸ªäº¤æ˜“çš„æœ‰æ•ˆæ€§ï¼Œä½¿ç”¨æ•°ç»„çš„ä¸‹æ ‡ï¼Œä¸äº¤æ˜“åœ¨æ•°ç»„ä¸­çš„é¡ºåºï¼Œä¸€ä¸€å¯¹åº”ã€‚</p><p>äº¤æ˜“éªŒè¯åï¼Œä¼šä¿®æ”¹åŒºå—çš„å…ƒæ•°æ®ï¼ŒæŠŠæ— æ•ˆçš„äº¤æ˜“è®¾ç½®ä¸ºå“åº”çš„æ— æ•ˆåºå·ã€‚</p><p>å¦‚æœç¼ºå¤±åŒºå—çš„ç§æœ‰æ•°æ®ï¼Œ<code>gossip/privdata</code>ä¼šåˆ›å»ºè·å–ç§æœ‰æ•°æ®çš„è¯·æ±‚ï¼Œå¹¶è·å–ç§æœ‰æ•°æ®ï¼Œå½“åŒºå—å’Œç§æœ‰æ•°æ®éƒ½å‡†å¤‡é½å…¨åï¼Œå¼€å§‹<strong>commit</strong>åŒºå—å’Œç§æœ‰æ•°æ®ã€‚</p><h5 id="åŒºå—å†™å…¥è´¦æœ¬"><a href="#åŒºå—å†™å…¥è´¦æœ¬" class="headerlink" title="åŒºå—å†™å…¥è´¦æœ¬"></a>åŒºå—å†™å…¥è´¦æœ¬</h5><p>åŒ…å«2å¤§å—ï¼š</p><ul><li>äº¤æ˜“MVCCéªŒè¯<ul><li>Fabricè¦æ±‚ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“æ”¯æŒMVCCï¼Œå³å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼Œä»¥ä¾¿äº¤æ˜“èƒ½å¤Ÿå¹¶å‘æ‰§è¡Œï¼ˆèƒŒä¹¦ï¼‰ï¼Œåœ¨çœŸæ­£ä¿®æ”¹çŠ¶æ€çš„æ—¶å€™ï¼Œæ‰åˆ¤æ–­è¯»å†™çš„æ•°æ®æ˜¯å¦å†²çªï¼Œå†²çªçš„äº¤æ˜“ä¼šè¢«æ ‡è®°ä¸ºæ— æ•ˆã€‚å…³äºMVCCæˆ‘ä»¬åœ¨ä¸‹æ–‡çš„èƒŒä¹¦éƒ¨åˆ†å†è¯¦ç»†ä»‹ç»ã€‚</li></ul></li><li>æŠŠåŒºå—å†™å…¥æ•°æ®åº“ï¼Œä»¥åŠä¿®æ”¹å„æ•°æ®åº“ï¼š<ul><li>æŠŠåŒºå—å†™å…¥åˆ°åŒºå—æ–‡ä»¶</li><li>æŠŠåŒºå—ã€äº¤æ˜“çš„ç´¢å¼•å†™å…¥åˆ°ç´¢å¼•æ•°æ®åº“</li><li>æŠŠ<strong>æœ‰æ•ˆäº¤æ˜“</strong>çš„å†™é›†æ›´æ–°åˆ°ä¸–ç•ŒçŠ¶æ€</li><li>æäº¤å†å²æ•°æ®åº“</li><li>æäº¤ç§å¯†æ•°æ®åº“</li></ul></li></ul><h5 id="å†™åŒºå—å®Œæˆå"><a href="#å†™åŒºå—å®Œæˆå" class="headerlink" title="å†™åŒºå—å®Œæˆå"></a>å†™åŒºå—å®Œæˆå</h5><p>å†™åŒºå—å®Œæˆåï¼Œè¿˜éœ€è¦åšä¸€äº›<strong>ä¿®å‰ª</strong>æ“ä½œï¼šç§å¯†æ•°æ®æ˜¯æœ‰æœ‰æ•ˆæœŸçš„ï¼Œæ¯”å¦‚å­˜æ´»100ä¸ªåŒºå—æ—¶é—´ï¼Œå‡å¦‚åœ¨1000é«˜åº¦å†™å…¥äº†æŸç§æœ‰æ•°æ®ï¼Œç¬¬1100å†™å…¥è´¦æœ¬åï¼Œç§å¯†æ•°æ®å°±è¦ä»ç§å¯†æ•°æ®åº“è¢«æŠ¹é™¤ã€‚</p><h3 id="èƒŒä¹¦"><a href="#èƒŒä¹¦" class="headerlink" title="èƒŒä¹¦"></a>èƒŒä¹¦</h3><p>Peeré™¤äº†è®°è´¦çš„å¦å¤–ä¸€ä¸ªè§’è‰²å°±æ˜¯èƒŒä¹¦ï¼ŒèƒŒä¹¦å¾ˆé‡è¦çš„ä¸€ä¸ªç¯èŠ‚å°±æ˜¯æ¨¡æ‹Ÿæ‰§è¡Œäº¤æ˜“ã€‚</p><h4 id="MVCC"><a href="#MVCC" class="headerlink" title="MVCC"></a>MVCC</h4><p>Fabricä¸ºäº†æä¾›æ›´é«˜çš„ç³»ç»Ÿæ€§èƒ½ï¼Œæ”¯æŒå¹¶å‘çš„æ‰§è¡Œäº¤æ˜“ï¼Œäº¤æ˜“åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šè¯»å†™ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“ï¼Œä¹Ÿå°±å­˜åœ¨å¹¶å‘è®¿é—®æ•°æ®åº“çš„åœºæ™¯ï¼Œä¸ºäº†å®‰å…¨çš„è®¿é—®æ•°æ®åº“æ•°æ®ï¼Œå°±éœ€è¦å¯¹æ•°æ®åº“çš„å¹¶å‘è¿›è¡Œé™åˆ¶ã€‚</p><p>Dravenessåœ¨<a href="https://draveness.me/database-concurrency-control" target="_blank" rel="noopener">æµ…è°ˆæ•°æ®åº“å¹¶å‘æ§åˆ¶ - é”å’Œ MVCC</a>ç§ä»‹ç»äº†å¹¶å‘æ§åˆ¶3ç§æ‰‹æ®µï¼šæ‚²è§‚é”ã€ä¹è§‚é”å’ŒMVCCã€‚</p><p>Fabricé€‰æ‹©äº†MVCCï¼Œå®ƒè¦æ±‚ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“æ”¯æŒMVCCï¼Œæœ¬è´¨ä¸Šè®²ä»»ä½•æ”¯æŒMVCCçš„æ•°æ®åº“ï¼Œéƒ½å¯ä»¥ç”¨æ¥å®ç°çŠ¶æ€æ•°æ®åº“ã€‚</p><p>MVCCæ˜¯å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§æ€æƒ³ï¼Œè€Œä¸æ˜¯ä¸€ç§å…·ä½“çš„ç®—æ³•ï¼Œæ‰€ä»¥ä¸åŒçš„æ•°æ®åº“å®ç°çš„MVCCä¸åŒã€‚</p><p>åœ¨MVCCçš„æ•°æ®å­˜å‚¨ä¸­ï¼Œæ•°æ®æœ‰ç‰ˆæœ¬çš„æ¦‚å¿µï¼Œå†™ä¸€ä¸ªæ•°æ®çš„å€¼ï¼Œå®é™…ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬æ¥ä¿å­˜æ•°æ®ã€‚</p><p>MVCCå¯ä»¥å®ç°å¹¶å‘è¯»å†™çš„èƒ½åŠ›ï¼Œå½“è¯»æ•°æ®æ—¶ï¼Œå…ˆç¡®å®šå¾…è¯»æ•°æ®çš„ç‰ˆæœ¬ï¼Œç„¶åä»è¯¥ç‰ˆæœ¬è¯»å–æ•°æ®ï¼Œå†™æ•°æ®æ—¶ï¼Œåˆ›å»ºæ–°çš„ç‰ˆæœ¬ä¿å­˜æ•°æ®ã€‚è¯»æ•°æ®å¿…ç„¶æ˜¯å·²ç»å­˜åœ¨çš„ç‰ˆæœ¬ï¼Œè€Œå†™æ•°æ®æ˜¯æ–°çš„ç‰ˆæœ¬ï¼Œå› æ­¤è¯»å†™å¯ä»¥å¹¶è¡Œã€‚</p><p><img src="http://img.lessisbetter.site/2020-01-mvcc-read-write.png" alt=""></p><h4 id="Fabricå¯¹MVCCçš„ä½¿ç”¨"><a href="#Fabricå¯¹MVCCçš„ä½¿ç”¨" class="headerlink" title="Fabricå¯¹MVCCçš„ä½¿ç”¨"></a>Fabricå¯¹MVCCçš„ä½¿ç”¨</h4><p>èƒŒä¹¦èŠ‚ç‚¹åœ¨æ¨¡æ‹Ÿæ‰§è¡Œäº¤æ˜“çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç”Ÿæˆè¯»å†™é›†ï¼Œ<strong>è¯»é›†å’Œå†™é›†åˆ†åˆ«æ˜¯æ‰€æœ‰å¾…å†™keyè¯»å‡ºæ¥æ—¶çš„ç‰ˆæœ¬å’Œå¾…å†™å…¥çš„æ–°å€¼</strong>ã€‚</p><p>äº¤æ˜“å¹¶å‘æ‰§è¡Œåˆ°å†™å…¥åŒºå—çš„è¿‡ç¨‹ä¸­å­˜åœ¨2ç§<strong>è¯»å†™å†²çª</strong>çš„æƒ…å†µï¼š</p><ol><li>åŒä¸€ä¸ªåŒºå—ä¸­çš„å‰åä¸¤ç¬”äº¤æ˜“ï¼Œåé¢çš„äº¤æ˜“è¯»é›†åŒ…å«æŸä¸ªkeyï¼Œä½†keyåœ¨å‰é¢äº¤æ˜“çš„å†™é›†ï¼šä¹Ÿå°±è¯´åé¢äº¤æ˜“è¯»çš„æ˜¯è€ç‰ˆæœ¬çš„æ•°æ®ï¼Œæ˜¯ä¸€ç§è„è¯»çš„æƒ…å†µ</li><li>åŒºå—ä¸­äº¤æ˜“çš„è¯»é›†çš„æŸä¸ªkeyï¼ŒæŸä¹‹å‰åŒºå—çš„äº¤æ˜“å†™é›†ä¿®æ”¹ï¼šèƒŒä¹¦è·Ÿå†™åŒºå—æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼ŒèƒŒä¹¦æ—¶äº§ç”Ÿçš„å†™é›†ï¼Œç›´åˆ°å†™åŒºå—æ‰ä¼šæ›´æ–°åˆ°ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“ï¼Œè¿™é‡Œå­˜åœ¨ä¸€æ®µæ—¶é—´ï¼Œå³keyå·²ç»æœ‰äº†æ–°ç‰ˆæœ¬çš„æ•°æ®ï¼Œåªæ˜¯è¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“ã€‚å¦‚æœè¿™æœŸé—´æœ‰æ–°çš„äº¤æ˜“æ¨¡æ‹Ÿæ‰§è¡Œï¼Œå°±ä¼šè¯»åˆ°è€ç‰ˆæœ¬æ•°æ®ï¼Œä¹Ÿæ˜¯ä¸€ç§è„è¯»çš„æƒ…å†µ</li></ol><p>æœ‰æ•ˆäº¤æ˜“çš„å†™é›†ä¼šè¢«åº”ç”¨åˆ°ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“ï¼Œè¢«ä¿®æ”¹æ•°æ®éƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬æ˜¯é€»è¾‘ç‰ˆæœ¬ï¼Œæˆä¸ºHightï¼Œç”±<code>{åŒºå—é«˜åº¦,äº¤æ˜“åœ¨åŒºå—å†…çš„é¡ºåº}</code>ç»„æˆã€‚</p><blockquote><p>æ³¨ï¼šéªŒè¯å‡½æ•°ä¸º <code>validateTx</code>ï¼Œè¯»å†™é›†å†²çªé”™è¯¯ä¸º <code>TxValidationCode_MVCC_READ_CONFLICT</code> ï¼Œå¦ä¸€ä¸ªè¯»å†™å†²çªé”™è¯¯ä¸º <code>TxValidationCode_PHANTOM_READ_CONFLICT</code>ï¼Œ å› ä¸ºæ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰RangeQueryï¼ŒæŸ¥è¯¢æŸä¸ªåŒºé—´çš„Keyï¼Œä¹Ÿéœ€è¦éªŒè¯è¿™äº›Keyæ˜¯å¦å†²çªï¼Œåº•å±‚æœ¬è´¨è¿˜æ˜¯è¯»å†™é›†çš„éªŒè¯ã€‚</p></blockquote><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä»è´¦æœ¬çš„è§†è§’ï¼Œä»‹ç»äº†Peerçš„è´¦æœ¬ï¼Œä»¥åŠå’Œè´¦æœ¬æ‰“äº¤é“çš„åŠŸèƒ½ã€‚</p><p>çœŸæ­£ä¼ä¸šçº§çš„åŒºå—é“¾ã€å¤§ç”¨æˆ·è§„æ¨¡çš„åŒºå—é“¾ï¼Œå¿…ç„¶èƒ½å¤Ÿæ”¯æ’‘å¤§é‡çš„å¹¶å‘äº¤æ˜“ï¼Œè¿™å¯¹è´¦æœ¬ä»¥åŠåº•å±‚å­˜å‚¨ï¼Œéƒ½ä¼šæå‡ºæ›´é«˜çš„æ€§èƒ½è¦æ±‚ã€ç£ç›˜åˆ©ç”¨ç‡è¦æ±‚ï¼Œæ‰€ä»¥ç†è§£å’ŒæŒæ¡è´¦æœ¬å’Œå­˜å‚¨æœºåˆ¶æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://draveness.me/database-concurrency-control" target="_blank" rel="noopener">æµ…è°ˆæ•°æ®åº“å¹¶å‘æ§åˆ¶ - é”å’Œ MVCC</a></li><li><a href="https://en.wikipedia.org/wiki/Multiversion_concurrency_control" target="_blank" rel="noopener">WIKI: MVCC</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŒºå—é“¾æœ€æ ¸å¿ƒçš„æ˜¯&lt;strong&gt;å¯ä¿¡æ•°æ®&lt;/strong&gt;ï¼Œæ‰€æœ‰çš„åŠŸèƒ½ä¸è®¾è®¡æ ¹æºéƒ½æ˜¯æ•°æ®ã€‚æœ¬æ¬¡ä»æ•°æ®å­˜å‚¨çš„è§’åº¦ï¼Œçœ‹ä¸€çœ‹Peerã€‚&lt;/p&gt;
&lt;h2 id=&quot;è´¦æœ¬&quot;&gt;&lt;a href=&quot;#è´¦æœ¬&quot; class=&quot;headerlink&quot; title=&quot;è´¦æœ¬&quot;&gt;&lt;/a&gt;è´¦æœ¬&lt;/h2&gt;&lt;
      
    
    </summary>
    
    
    
      <category term="åŒºå—é“¾" scheme="http://lessisbetter.site/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="Fabric" scheme="http://lessisbetter.site/tags/Fabric/"/>
    
  </entry>
  
  <entry>
    <title>WAL(é¢„å†™å¼æ—¥å¿—)ç®€ä»‹</title>
    <link href="http://lessisbetter.site/2020/01/02/wal-introduction/"/>
    <id>http://lessisbetter.site/2020/01/02/wal-introduction/</id>
    <published>2020-01-02T12:56:32.000Z</published>
    <updated>2020-08-22T03:30:48.933Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>Write Ahead Loggingï¼Œç®€ç§°WALï¼Œä¹Ÿè¢«ç¿»è¯‘æˆ<strong>é¢„å†™å¼æ—¥å¿—</strong>ï¼Œæ˜¯æ•°æ®åº“æŠ€æœ¯ä¸­å®ç°äº‹åŠ¡æ—¥å¿—(Transaction Journal)çš„ä¸€ç§æ ‡å‡†æ–¹æ³•ï¼Œå¯ä»¥å®ç°<strong>å•æœº</strong>äº‹åŠ¡çš„åŸå­æ€§ï¼ŒåŒæ—¶å¯ä»¥æé«˜æ•°æ®åº“çš„å†™å…¥æ•ˆç‡ã€‚</p><p>æ€è€ƒå¦‚ä¸‹åœºæ™¯ï¼Œå¦‚ä½•ç¡®ä¿åŸå­æ€§ï¼šå†™æ“ä½œä¿®æ”¹æ•°æ®åº“ä¸­aå’Œbçš„å€¼ï¼ŒäºŒè€…æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œéœ€è¦æŠŠaå’Œbçš„æœ€æ–°å€¼æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå‡å¦‚ä¿å­˜å®Œaçš„å€¼ï¼Œç³»ç»Ÿå®•æœºäº†ï¼Œé‡æ–°å¯åŠ¨åï¼Œaçš„å€¼å·²ç»å†™å…¥ï¼Œä½†bå¾…å†™å…¥çš„å€¼å·²ç»ä¸¢å¤±ï¼Œå¦‚ä½•å‘ç°äº‹åŠ¡æ²¡æœ‰å®Œæˆå‘¢ï¼Ÿå¦‚ä½•ä¿è¯äº‹åŠ¡çš„åŸå­æ€§å‘¢ï¼Ÿ</p><p>å¯ä»¥ä¸ºäº‹åŠ¡åŠ é”ï¼Œä¹Ÿä¸ºäº‹åŠ¡å¢åŠ æ ‡å¿—ä½ï¼Œä¿®æ”¹å®Œç£ç›˜æ•°æ®åï¼Œæ ‡å¿—ä½è®¾ç½®äº‹åŠ¡ä¸ºå®Œæˆï¼Œäº‹åŠ¡çŠ¶æ€ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œå‡ä½¿ä¿å­˜äº‹åŠ¡çŠ¶æ€çš„è¿‡ç¨‹ä¸­å®•æœºäº†ï¼Œå°±æŠŠäº‹åŠ¡å›æ»šæ‰ã€‚å®ç°REDOå’ŒUNDOï¼Œå°±èƒ½å®ç°åŸå­æ€§ã€‚</p><p>æ•°æ®åº“ä¸­é’ˆå¯¹<strong>Crash</strong>å’Œ<strong>Recovery</strong>çš„è§£å†³æ–¹æ¡ˆæ˜¯WALã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>WALçš„æ ¸å¿ƒæ€æƒ³æ˜¯<strong>å…ˆå†™æ—¥å¿—å†å†™æ•°æ®æ–‡ä»¶</strong>ï¼Œä¿®æ”¹æ•°æ®æ–‡ä»¶å¿…é¡»å‘ç”Ÿåœ¨ä¿®æ”¹æ“ä½œè®°å½•åœ¨æ—¥å¿—æ–‡ä»¶ä¹‹åã€‚</p><blockquote><p>æœ¬æ–‡çš„æ—¥å¿—æŒ‡äº‹åŠ¡çš„æ“ä½œæ—¥å¿—ï¼Œæœ¬æ–‡æåˆ°çš„æ—¥å¿—éƒ½æ˜¯æŒ‡äº‹åŠ¡æ—¥å¿—ï¼Œä¸å†ç‰¹æ®Šå£°æ˜ã€‚</p></blockquote><p><img src="http://img.lessisbetter.site/2019-12-wal.png" alt="WAL"></p><p>æˆ‘ä»¬çœ‹WALæ€ä¹ˆ<strong>è§£å†³å®•æœºå’Œæ¢å¤çš„é—®é¢˜</strong>ï¼š</p><ul><li>å†™WALå‰å®•æœºäº†ï¼Œé‡å¯åï¼Œæ•°æ®å¤„äºäº‹åŠ¡æœªæ‰§è¡Œçš„çŠ¶æ€ã€‚</li><li>å†™WALæ—¶å®•æœºäº†ï¼Œé‡å¯åï¼Œå¯ä»¥æ£€æŸ¥åˆ°WALæ•°æ®ä¸æ­£ç¡®ï¼Œå›æ»šå½“äº‹åŠ¡å‰çš„çŠ¶æ€ã€‚</li><li>å†™WALåå®•æœºäº†ï¼Œé‡å¯åï¼ŒæŠŠWALä¸­è®°å½•çš„æ“ä½œï¼Œåº”ç”¨åˆ°æ•°æ®åº“æ–‡ä»¶ä¸­ï¼Œå¾—åˆ°äº‹åŠ¡æ‰§è¡Œåçš„çŠ¶æ€ã€‚</li></ul><p>å¦‚æ­¤ï¼Œä¿è¯äº†æ•°æ®çš„æ¢å¤å’Œäº‹åŠ¡çš„åŸå­æ€§ã€‚</p><p>ä¸Šé¢æåˆ°çš„éƒ½æ˜¯å†™æ“ä½œï¼Œçœ‹ä¸€ä¸‹ä½¿ç”¨WALæ—¶çš„<strong>è¯»æ“ä½œ</strong>ã€‚WALä¸­å¯èƒ½åŒ…å«äº†æœªå†™å…¥åˆ°æ•°æ®åº“æ–‡ä»¶ä¸­çš„æœ€æ–°å€¼ï¼Œå¦‚æœè¯»æœ€æ–°å€¼å°±éœ€è¦ä»WALä¸­è¯»å–ï¼Œå¦‚æœWALä¸­æœªè¯»åˆ°ï¼Œä»æ•°æ®åº“è¯»åˆ°çš„å°±æ˜¯æœ€æ–°çš„æ•°æ®ã€‚</p><p><strong>æ£€æŸ¥ç‚¹</strong>ï¼šå†™å…¥åˆ°WALæ–‡ä»¶ä¸­çš„æ“ä½œè®°å½•å¹¶ä¸ä¸€å®šä¼šç«‹åˆ»åº”ç”¨åˆ°æ•°æ®åº“æ–‡ä»¶ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œè®¾è®¡æ£€æŸ¥ç‚¹æ¥è®°å½•å·²ç»è¢«åº”ç”¨åˆ°æ•°æ®åº“æ–‡ä»¶ä¸Šçš„æ“ä½œåºå·ï¼Œæ£€æŸ¥ç‚¹åé¢çš„æ“ä½œè®°å½•ç­‰å¾…è¢«åº”ç”¨åˆ°æ•°æ®åº“æ–‡ä»¶ä¸Šã€‚</p><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><p>WALçš„ä½œç”¨æ˜¯è§£å†³å®•æœºå’Œæ¢å¤çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæœ‰å…¶ä»–ä¼˜ç‚¹ï¼š</p><ol><li><strong>æé«˜å†™æ•°æ®çš„æ€§èƒ½</strong><ol><li>WALæ˜¯é¡ºåºå†™ï¼Œæ•°æ®åº“æ–‡ä»¶æ˜¯éšæœºå†™ï¼Œé¡ºåºå†™æ€§èƒ½é«˜äºéšæœºå†™</li><li>å‡å°‘å†™ç£ç›˜æ¬¡æ•°<ol><li>ä¸ç›´æ¥ä¿®æ”¹æ•°æ®åº“çœŸå®æ•°æ®</li><li>åˆå¹¶è‹¥å¹²å°çš„äº‹åŠ¡ï¼Œä¸€æ¬¡æ€§commitåˆ°æ•°æ®åº“</li></ol></li></ol></li><li>ä¿è¯äº‹åŠ¡<strong>åŸå­æ€§</strong></li><li>ä¿è¯äº‹åŠ¡<strong>ä¸€è‡´æ€§</strong></li><li><strong>å¹¶å‘è¯»å†™</strong>ï¼Œæ¯”å¦‚SQLiteä¸­ï¼Œè¯»å†™ã€è¯»è¯»éƒ½æ˜¯å¯ä»¥å¹¶è¡Œçš„ï¼Œæ¯”å¦‚è¯»æ—¶éœ€è¦æ‰¾åˆ°WALæŸä¸ªå€¼æœ€åå†™å…¥çš„ä½ç½®ï¼Œå°±å¯ä»¥ä»è¯¥ä½ç½®è¯»æ•°æ®ï¼Œè€Œå†™æ“ä½œæ˜¯åœ¨WALæ–‡ä»¶åAppendï¼ŒäºŒè€…å¹¶è¡Œã€‚ä½†å†™å†™ä¸èƒ½å¹¶è¡Œï¼Œå› ä¸º2æ¬¡å†™æ“ä½œéƒ½è¦å‘WALæ–‡ä»¶Appendæ•°æ®ï¼Œæ— æ³•åŒæ—¶è¿›è¡Œã€‚</li><li>WALæ–‡ä»¶ä¸­è®°å½•äº†æ•°æ®çš„å†å²ç‰ˆæœ¬ï¼Œå› æ­¤å¯ä»¥è¯»å–å†å²ç‰ˆæœ¬çš„å€¼ï¼Œç”šè‡³æŠŠçŠ¶æ€å›æ»šåˆ°æŸä¸ªå†å²ç‰ˆæœ¬ã€‚</li></ol><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><p>SQLiteæåˆ°äº†WALçš„å‡ é¡¹ç¼ºç‚¹ï¼š</p><ol><li>WALéœ€è¦VFSçš„æ”¯æŒã€‚</li><li>æ‰€æœ‰ä½¿ç”¨æ•°æ®åº“çš„è¿›ç¨‹å¿…é¡»åœ¨åŒä¸€ä¸ªæœºå™¨ä¸Šï¼Œä»¥ä¸ºWALæ˜¯å•æœºçš„ã€‚</li><li>å¤šè¯»å°‘å†™çš„åœºæ™¯WALæ¯”rollback-journalç±»å‹è¦æ…¢1%~2%ã€‚</li></ol><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>WALå‡ ä¹æ˜¯<strong>æ•°æ®å­˜å‚¨</strong>(æ•°æ®åº“åªæ˜¯æ•°æ®å­˜å‚¨çš„ä¸€ä¸ªç±»åˆ«ï¼Œåªä¸è¿‡è¿™ä¸ªç±»åˆ«å¾ˆå¤§)çš„æ ‡é…ï¼š</p><ul><li>Raftå¯ä»¥ä½¿ç”¨WALä¿å­˜log Entryä»¥åŠçŠ¶æ€</li><li>æ•°æ®åº“<ul><li>PgSQLä½¿ç”¨WALå®ç°äº‹åŠ¡æ—¥å¿—å®ç°äº‹åŠ¡åŸå­æ€§ã€ä¸€è‡´æ€§ï¼Œæå‡æ€§èƒ½</li><li>SQLiteä½¿ç”¨WALå®ç°åŸå­æ€§</li><li>MySQLä½¿ç”¨WALå®ç°æŒä¹…æ€§ï¼Œä¿è¯æ•°æ®ä¸ä¸¢å¤±çš„æƒ…å†µä¸‹æå‡æ€§èƒ½</li><li>leveldbä¹Ÿä½¿ç”¨WALæå‡æ€§èƒ½ï¼Œä¿è¯æ“ä½œåŸå­æ€§</li></ul></li></ul><h2 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h2><ul><li><a href="https://juejin.im/post/5b04a93151882542672666e8" target="_blank" rel="noopener">èœé¸Ÿå­¦æ•°æ®åº“â€”â€”WALæ¨¡å¼åŠå…¶åŸç†</a></li><li><a href="http://mysql.taobao.org/monthly/2017/03/02/" target="_blank" rel="noopener">PgSQL Â· ç‰¹æ€§åˆ†æ Â· Write-Ahead Loggingæœºåˆ¶æµ…æ</a></li><li><a href="https://www.postgresql.org/docs/9.1/wal-intro.html" target="_blank" rel="noopener">PostgreSQL 9.1.24 Documentation: Chapter 29. Reliability and the Write-Ahead Log</a></li><li><a href="https://www.sqlite.org/wal.html" target="_blank" rel="noopener">SQLite: Write-Ahead Logging</a></li><li><a href="https://mysqlserverteam.com/mysql-8-0-new-lock-free-scalable-wal-design/" target="_blank" rel="noopener">MySQL 8.0: New Lock free, scalable WAL design</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h2&gt;&lt;p&gt;Write Ahead Loggingï¼Œç®€ç§°WALï¼Œä¹Ÿè¢«ç¿»è¯‘æˆ&lt;strong&gt;é¢„å†™å¼æ—¥å¿—&lt;/strong&gt;ï¼Œæ˜¯æ•°æ®åº“æŠ€æœ¯ä¸­å®ç°äº‹åŠ¡æ—¥å¿—(Tr
      
    
    </summary>
    
    
    
      <category term="åˆ†å¸ƒå¼" scheme="http://lessisbetter.site/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
      <category term="å­˜å‚¨" scheme="http://lessisbetter.site/tags/%E5%AD%98%E5%82%A8/"/>
    
  </entry>
  
  <entry>
    <title>Fabric 1.4æºç è§£è¯» 8ï¼šOrdererå’ŒPeerçš„äº¤äº’</title>
    <link href="http://lessisbetter.site/2019/12/17/fabric-blocks-from-orderer-to-peer/"/>
    <id>http://lessisbetter.site/2019/12/17/fabric-blocks-from-orderer-to-peer/</id>
    <published>2019-12-17T12:14:34.000Z</published>
    <updated>2019-12-17T06:19:58.910Z</updated>
    
    <content type="html"><![CDATA[<p>Peerä¸Ordererçš„äº¤äº’ä¸»è¦æ˜¯ç»„ç»‡çš„Peerä¸»èŠ‚ç‚¹ä»Ordererè·å–åŒºå—ï¼Œæœ¬æ–‡å°±æ¥ä»‹ç»ï¼ŒPeeræ˜¯å¦‚ä½•ä»Ordererè·å–åŒºå—çš„ï¼Œé¡ºå¸¦ä»‹ç»ä¸ºä½•Peerä»Ordererè·å–çš„åŒºå—â€œå¥½æ…¢â€ã€‚</p><h2 id="ç½‘ç»œæ‹“æ‰‘"><a href="#ç½‘ç»œæ‹“æ‰‘" class="headerlink" title="ç½‘ç»œæ‹“æ‰‘"></a>ç½‘ç»œæ‹“æ‰‘</h2><p>å‡è®¾å­˜åœ¨å¦‚ä¸‹çš„Fabricç½‘ç»œæ‹“æ‰‘æƒ…å†µï¼Œæœ¬æ–‡ä½¿ç”¨æ­¤æ‹“æ‰‘è¿›è¡Œä»‹ç»Ordereråˆ°Peerçš„åŒºå—ä¼ æ’­æƒ…å†µï¼š</p><p>ç½‘ç»œä¸­å­˜åœ¨ä¸¤å®¶ç»„ç»‡ï¼šOrg1å’ŒOrg2ï¼Œå®ƒä»¬åˆ†åˆ«æ‹¥æœ‰Peer1ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œè¿å‘äº†æ’åºæœåŠ¡çš„Orderer1èŠ‚ç‚¹ã€‚</p><p>ç½‘ç»œä¸­å­˜åœ¨2ä¸ªåº”ç”¨channelï¼šchannel1å’Œchannel2ï¼Œå®ƒä»¬çš„è´¦æœ¬åˆ†åˆ«æ˜¯channel1 ledgerå’Œchannel2 ledgerï¼ŒOrg1å’ŒOrg2éƒ½åŠ å…¥äº†è¿™2ä¸ªchannelã€‚</p><p><strong>channelé—´æ˜¯éš”ç¦»çš„ï¼Œæ‰€ä»¥Peerå’ŒOrdererå¯¹ä¸åŒçš„channeléƒ½ä¼šåˆ†åˆ«å¤„ç†</strong>ã€‚</p><h2 id="å®è§‚è§†è§’"><a href="#å®è§‚è§†è§’" class="headerlink" title="å®è§‚è§†è§’"></a>å®è§‚è§†è§’</h2><p>ä¸‹å›¾å±•ç¤ºäº†Ordererå‘Peerä¼ é€’åŒºå—çš„å®è§‚è§†è§’ï¼Œèƒ½å¤Ÿå±•ç¤º<strong>å¤šä¸ªé€šé“åœ¨Ordererå’ŒPeeré—´ä¼ é€’åŒºå—çš„æƒ…å†µ</strong>ï¼š</p><ol><li>Ordererä¸Šæœ‰2ä¸ªé€šé“çš„è´¦æœ¬ï¼Œæ¯ä¸ªPeeråˆ†åˆ«æœ‰2ä¸ªDeliver Serverå¯¹åº”2ä¸ªé€šé“çš„è´¦æœ¬ï¼Œä»è´¦æœ¬è¯»å–åŒºå—ï¼Œå‘é€ç»™Peerã€‚</li><li>æ¯ä¸ªPeeræœ‰2ä¸ªDeliver Clientï¼Œä¹Ÿå¯¹åº”2ä¸ªé€šé“ï¼Œæ¥æ”¶Ordererå‘æ¥çš„åŒºå—ï¼ŒåŠ å…¥åˆ°ç¼“å†²åŒºPayloads Bufferï¼Œç„¶åå†ä»Payloads Bufferä¸­æå–åŒºå—ï¼ŒéªŒè¯åå†™å…¥å¯¹åº”çš„é€šé“è´¦æœ¬ã€‚</li></ol><p><img src="http://img.lessisbetter.site/2019-12-spread-of-blocks-new.png" alt=""></p><p>åé¢ï¼Œä»‹ç»åŒºå—åŒæ­¥æŸä¸ªé€šé“åŒºå—çš„æƒ…å†µã€‚</p><h2 id="å•é€šé“åŒºå—åŒæ­¥"><a href="#å•é€šé“åŒºå—åŒæ­¥" class="headerlink" title="å•é€šé“åŒºå—åŒæ­¥"></a>å•é€šé“åŒºå—åŒæ­¥</h2><p><strong>Peeråˆ©ç”¨Deliverä»Ordererè·å–åŒºå—</strong>ï¼Œå°±åƒSDKåˆ©ç”¨Deliverä»Peerè·å–åŒºå—ä¸€æ ·ï¼ŒDeliveræœåŠ¡ç«¯çš„å¤„ç†æ˜¯ä¸€æ ·çš„ï¼ŒDeliverå®¢æˆ·ç«¯çš„å¤„ç†å°±ç”±SDKã€Peerè‡ªè¡Œå¤„ç†äº†ã€‚</p><p>Deliveræœ¬è´¨æ˜¯ä¸€ä¸ªäº‹ä»¶è®¢é˜…æ¥å£ï¼ŒLeading Peerå¯åŠ¨åï¼Œä¼šä¸ºæ¯ä¸ªé€šé“ï¼Œåˆ†åˆ«å‘OrdererèŠ‚ç‚¹æ³¨å†Œ<strong>åŒºå—äº‹ä»¶</strong>ï¼Œå¹¶ä¸”æŒ‡å®šç»“æŸçš„åŒºå—é«˜åº¦ä¸º<code>uint</code>ç±»å‹çš„æœ€å¤§å€¼ï¼Œè¿™æ˜¯ä¸ºäº†ä¸åœçš„ä»ordererè·å–åŒºå—ã€‚</p><p>é€šè¿‡å»ºç«‹çš„gRPCè¿æ¥ï¼ŒOrdereræºæºä¸æ–­çš„å‘Peerå‘é€åŒºå—ï¼Œå…·ä½“æµç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><ol><li>Ordererè°ƒç”¨<code>deliverBlock</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯å¾ªç¯å‡½æ•°ï¼Œè·å–åŒºå—ç›´åˆ°æŒ‡å®šé«˜åº¦ã€‚</li><li>æ¯å½“æœ‰æ–°åŒºå—äº§ç”Ÿï¼Œ<code>deliverBlock</code>èƒ½åˆ©ç”¨<code>NextBlock</code>ä»é€šé“è´¦æœ¬ä¸­è¯»åˆ°æœ€æ–°çš„åŒºå—ï¼Œå¦‚æœæ²¡æœ‰æœ€æ–°åŒºå—ï¼Œ<code>NextBlock</code>ä¼šé˜»å¡ã€‚</li><li><code>deliverBlock</code>æŠŠè·å–çš„åŒºå—å°è£…æˆåŒºå—äº‹ä»¶ï¼Œå‘é€ç»™Peerï¼ˆå†™å…¥åˆ°gRPCç¼“å†²åŒºï¼‰ã€‚</li><li>Peerä»gRPCè¯»åˆ°åŒºå—äº‹ä»¶ï¼ŒæŠŠåŒºå—æå–å‡ºæ¥åï¼ŒåŠ å…¥åˆ°<strong>Payloads Buffer</strong>ï¼ŒPayloads Bufferé»˜è®¤å¤§å°ä¸º200ï¼ˆé€šè¿‡æºç å’Œæ—¥å¿—å‘ç°ï¼ŒPayloads Bufferå®é™…å­˜å‚¨202ä¸ªåŒºå—ï¼‰ï¼Œå¦‚æœOrdereræƒ³å‘Peerå‘é€æ›´å¤šçš„åŒºå—ï¼Œå¿…é¡»ç­‰Payloads Bufferè¢«æ¶ˆè´¹ï¼Œæœ‰ç©ºé—²çš„ä½ç½®æ‰å¯ä»¥ã€‚</li><li><code>deliverPayloads</code>ä¸ºå¾ªç¯å‡½æ•°ï¼Œä¸æ–­<strong>æ¶ˆè´¹</strong>Payloads Bufferä¸­çš„åŒºå—ï¼Œæ‰§è¡ŒåŒºå—éªŒè¯ï¼Œæ·»åŠ åŒºå—å‰©ä½™å…ƒæ•°æ®ï¼Œæœ€åå†™å…¥é€šé“è´¦æœ¬ã€‚</li><li>å†™é€šé“è´¦æœ¬åŒ…å«åŒºå—å†™å…¥åŒºå—è´¦æœ¬ï¼Œä¿®æ”¹ä¸–ç•ŒçŠ¶æ€æ•°æ®åº“ï¼Œå†å²ç´¢å¼•ç­‰ã€‚</li></ol><p><img src="http://img.lessisbetter.site/2019-12-orderer-to-peer.png" alt=""></p><h2 id="ä¸ºä½•Peerä»Ordererè·å–åŒºå—æ…¢ï¼Ÿ"><a href="#ä¸ºä½•Peerä»Ordererè·å–åŒºå—æ…¢ï¼Ÿ" class="headerlink" title="ä¸ºä½•Peerä»Ordererè·å–åŒºå—æ…¢ï¼Ÿ"></a>ä¸ºä½•Peerä»Ordererè·å–åŒºå—æ…¢ï¼Ÿ</h2><p>åœ¨æ€§èƒ½æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°Ordereræ’åºå®Œæˆåï¼ŒPeerè¿˜åœ¨ä¸æ–­çš„ä»Ordererè·å–åŒºå—ï¼Œè€Œä¸æ˜¯æ‰€æœ‰æ’åºåçš„åŒºå—éƒ½å…ˆå‘é€ç»™Peerï¼ŒPeerç¼“å­˜èµ·æ¥ï¼Œæ…¢æ…¢å»éªŒè¯ï¼Ÿ</p><p>ä¸Šé¢æåˆ°Ordererå‘Peerå‘é€çš„åŒºå—ï¼ŒPeeræ”¶åˆ°åå…ˆå­˜åˆ°Payloads Bufferä¸­ï¼ŒBufferæœ‰ç©ºé—²ä½ç½®çš„æ—¶å€™ï¼ŒOrdererå‘é€çš„åŒºå—æ‰èƒ½å†™å…¥Bufferï¼ŒdeliverBlock 1æ¬¡å¾ªç¯æ‰èƒ½å®Œæˆï¼Œæ‰å¯ä»¥å‘é€ä¸‹ä¸€ä¸ªåŒºå—ã€‚</p><p>ä½†Payloads Bufferå¤§å°æ˜¯æœ‰é™çš„ï¼Œå½“Bufferæ»¡åï¼ŒOrdererå‘é€åŒºå—çš„æ“ä½œä¹Ÿä¼šæ”¶åˆ°é˜»å¡ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠOrdererå’ŒPeeré—´å‘é€åŒºå—å¯ä»¥æŠ½è±¡ä¸€ä¸‹ï¼Œå®ƒä»¬å°±æ˜¯<strong>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹</strong>ï¼Œå®ƒä»¬ä¸­é—´æ˜¯ç¼“å†²åŒºï¼ŒOrdereræ˜¯ç”Ÿäº§è€…ï¼Œå‘ç¼“å†²åŒºå†™æ•°æ®ï¼ŒPeeræ˜¯æ¶ˆè´¹è€…ï¼Œä»ç¼“å†²åŒºè¯»æ•°æ®ï¼Œç¼“å†²åŒºæ»¡äº†ä¼šé˜»å¡ç”Ÿäº§è€…å†™æ•°æ®ã€‚</p><p>æ‰€ä»¥<strong>Ordererå‘Peerå‘é€æ•°æ®çš„å¿«æ…¢ï¼Œå–å†³æ¶ˆè´¹è€…çš„é€Ÿåº¦ï¼Œå³å–å†³äºdeliverPayloadså¤„ç†ä¸€ä¸ªåŒºå—çš„å¿«æ…¢</strong>ã€‚</p><p>deliverPayloadsæ…¢åœ¨æŠŠåŒºå—å†™å…¥åŒºå—è´¦æœ¬ï¼Œä¹Ÿå°±æ˜¯å†™è´¦æœ¬ï¼Œæˆäº†æ•´ä¸ªç½‘ç»œçš„ç“¶é¢ˆã€‚</p><h2 id="ä¸ºä½•ä¸è®©Peerç¼“å­˜æ‰€æœ‰æœªå¤„ç†çš„åŒºå—ï¼Ÿ"><a href="#ä¸ºä½•ä¸è®©Peerç¼“å­˜æ‰€æœ‰æœªå¤„ç†çš„åŒºå—ï¼Ÿ" class="headerlink" title="ä¸ºä½•ä¸è®©Peerç¼“å­˜æ‰€æœ‰æœªå¤„ç†çš„åŒºå—ï¼Ÿ"></a>ä¸ºä½•ä¸è®©Peerç¼“å­˜æ‰€æœ‰æœªå¤„ç†çš„åŒºå—ï¼Ÿ</h2><p>ä»æˆ‘ä»¬æµ‹è¯•çš„æƒ…å†µçœ‹ï¼ŒOrdereræ’åºçš„é€Ÿåº¦è¿œå¿«äºPeerï¼ŒPeerå’ŒOrdererçš„é«˜åº¦å·®å¯ä»¥è¾¾åˆ°10ä¸‡+ï¼Œå¦‚æœè®©Peeræ¥ç¼“å­˜è¿™äº›åŒºå—ï¼Œç„¶åå†åšå¤„ç†æ˜¯éœ€è¦è€—è´¹å¤§é‡çš„ç©ºé—´ã€‚</p><p>åœ¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ä¸­ï¼Œåªéœ€è¦è¦æ¶ˆè´¹è€…æ—¶åˆ»éƒ½æœ‰æ•°æ®å¤„ç†å³å¯ã€‚è™½ç„¶Ordererå’ŒPeerä¹‹é—´æ˜¯ç½‘ç»œä¼ è¾“ï¼Œæµ‹è¯•ç½‘ç»œæ¯”è¾ƒå¯é ï¼Œä¼ è¾“é€Ÿåº¦è¿œæ¯”Peerå¤„ç†åŒºå—è¦å¿«ã€‚</p><p>Payloads Bufferå¯ä»¥è®©ç½‘ç»œä¼ è¾“åŒºå—å’ŒPeerå¤„ç†åŒºå—å¹¶è¡Œï¼Œè¿™æ ·ç¼©çŸ­äº†ä¸€ä¸ªåŒºå—ä»Ordererä¸­å‘å‡ºï¼Œåˆ°Peerå†™å…¥åŒºå—åˆ°è´¦æœ¬çš„æ€»æ—¶é—´ï¼Œæå‡Fabricç½‘ç»œæ•´ä½“æ€§èƒ½ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Peerä¸Ordererçš„äº¤äº’ä¸»è¦æ˜¯ç»„ç»‡çš„Peerä¸»èŠ‚ç‚¹ä»Ordererè·å–åŒºå—ï¼Œæœ¬æ–‡å°±æ¥ä»‹ç»ï¼ŒPeeræ˜¯å¦‚ä½•ä»Ordererè·å–åŒºå—çš„ï¼Œé¡ºå¸¦ä»‹ç»ä¸ºä½•Peerä»Ordererè·å–çš„åŒºå—â€œå¥½æ…¢â€ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ç½‘ç»œæ‹“æ‰‘&quot;&gt;&lt;a href=&quot;#ç½‘ç»œæ‹“æ‰‘&quot; class
      
    
    </summary>
    
    
    
      <category term="åŒºå—é“¾" scheme="http://lessisbetter.site/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="Fabric" scheme="http://lessisbetter.site/tags/Fabric/"/>
    
  </entry>
  
  <entry>
    <title>Fabric 2.0 ç‰¹æ€§ä¸€è§ˆ</title>
    <link href="http://lessisbetter.site/2019/12/16/fabric-2-0/"/>
    <id>http://lessisbetter.site/2019/12/16/fabric-2-0/</id>
    <published>2019-12-16T12:30:11.000Z</published>
    <updated>2019-12-16T09:35:14.045Z</updated>
    
    <content type="html"><![CDATA[<p>Fabric 2.0 Betaç‰ˆå‰å‡ æ—¥å·²ç»å‘å¸ƒäº†ï¼Œæµè§ˆäº†å®˜æ–¹æ–‡æ¡£å’ŒRelease Notesï¼Œå¯¹ç‰¹æ€§è¿›è¡Œäº†è®°å½•ï¼Œ</p><ul><li><a href="https://hyperledger-fabric.readthedocs.io/en/master/whatsnew.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://github.com/hyperledger/fabric/releases/tag/v2.0.0-beta" target="_blank" rel="noopener">Relase Notes</a></li></ul><p><img src="http://img.lessisbetter.site/2019-12-fabric-2.0.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Fabric 2.0 Betaç‰ˆå‰å‡ æ—¥å·²ç»å‘å¸ƒäº†ï¼Œæµè§ˆäº†å®˜æ–¹æ–‡æ¡£å’ŒRelease Notesï¼Œå¯¹ç‰¹æ€§è¿›è¡Œäº†è®°å½•ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://hyperledger-fabric.readthedocs.io/en/master/whatsn
      
    
    </summary>
    
    
    
      <category term="åŒºå—é“¾" scheme="http://lessisbetter.site/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="Fabric" scheme="http://lessisbetter.site/tags/Fabric/"/>
    
  </entry>
  
</feed>
